2025-12-10 04:39:48,012 DeMo INFO: Saving model in the path :..
2025-12-10 04:39:48,012 DeMo INFO: Namespace(config_file='configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml', exp_name=None, fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'False', 'MODEL.USE_DGAF', 'True', 'MODEL.DGAF_VERSION', 'v3', 'MODEL.GLOBAL_LOCAL', 'False'])
2025-12-10 04:39:48,012 DeMo INFO: Loaded configuration file configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml
2025-12-10 04:39:48,013 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention（推荐）
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用（原 MLP predictor 权重）
  SDTPS_AGGR_RATIO: 0.5    # 已不使用（原 TokenAggregation）
  SDTPS_LOSS_WEIGHT: 2.0   # SDTPS 分支的损失权重
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 8
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# SDTPS + DGAF Ablation Config
# ============================================================================
# - SACR: disabled
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10
# - TF32: enabled in train_net.py
# ============================================================================

2025-12-10 04:39:48,013 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 8
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT201
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ADAPTER: False
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: True
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: False
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGBNT201 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   171 |     3951 |         4
  query    |    30 |      836 |         2
  gallery  |    30 |      836 |         2
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:16 width: 8
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 4
===========Building DeMo===========
2025-12-10 04:39:59,754 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (dgaf): DualGatedAdaptiveFusionV3(
    (attn_pool): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (attn_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (entropy_proj): Linear(in_features=512, out_features=512, bias=True)
    (gate_net): Sequential(
      (0): Linear(in_features=1536, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (2): ReLU(inplace=True)
      (3): Linear(in_features=512, out_features=3, bias=True)
      (4): Sigmoid()
    )
    (modal_enhance): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classifier_dgaf): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck_dgaf): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-10 04:39:59,755 DeMo INFO: number of parameters:90.621444
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
Unsupported operator aten::log encountered 3 time(s)
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, bottleneck_dgaf, classifier, classifier_dgaf, dgaf.attn_pool.out_proj, nir_reduce, nir_reduce.0, nir_reduce.1, nir_reduce.2, pool, rgb_reduce, rgb_reduce.0, rgb_reduce.1, rgb_reduce.2, tir_reduce, tir_reduce.0, tir_reduce.1, tir_reduce.2
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The out_proj here is called by the nn.MultiheadAttention, which has been calculated in th .forward(), so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For the bottleneck or classifier, it is not calculated during inference, so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:02,713 DeMo INFO: number of GFLOPs: 34.48054893099999
using soft triplet loss for training
label smooth on, numclasses: 171
2025-12-10 04:40:02,725 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 04:40:07,515 DeMo.train INFO: Epoch[1] Iteration[10/54] Loss: 8.999, Acc: 0.005, Base Lr: 5.00e-06
2025-12-10 04:40:10,424 DeMo.train INFO: Epoch[1] Iteration[20/54] Loss: 6.908, Acc: 0.003, Base Lr: 5.00e-06
2025-12-10 04:40:12,911 DeMo.train INFO: Epoch[1] Iteration[30/54] Loss: 6.089, Acc: 0.003, Base Lr: 5.00e-06
2025-12-10 04:40:15,411 DeMo.train INFO: Epoch[1] Iteration[40/54] Loss: 5.545, Acc: 0.004, Base Lr: 5.00e-06
2025-12-10 04:40:17,912 DeMo.train INFO: Epoch[1] Iteration[50/54] Loss: 5.231, Acc: 0.005, Base Lr: 5.00e-06
2025-12-10 04:40:18,790 DeMo.train INFO: Epoch 1 done. Time per batch: 0.303[s] Speed: 211.3[samples/s]
2025-12-10 04:40:18,791 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:18,791 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:40:18,791 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:25,080 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 04:40:25,081 DeMo.train INFO: mAP: 29.1%
2025-12-10 04:40:25,081 DeMo.train INFO: CMC curve, Rank-1  :29.2%
2025-12-10 04:40:25,081 DeMo.train INFO: CMC curve, Rank-5  :45.7%
2025-12-10 04:40:25,081 DeMo.train INFO: CMC curve, Rank-10 :53.9%
2025-12-10 04:40:25,081 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:25,542 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:25,542 DeMo.train INFO: Best mAP: 29.1%
2025-12-10 04:40:25,542 DeMo.train INFO: Best Rank-1: 29.2%
2025-12-10 04:40:25,542 DeMo.train INFO: Best Rank-5: 45.7%
2025-12-10 04:40:25,542 DeMo.train INFO: Best Rank-10: 53.9%
2025-12-10 04:40:25,542 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:29,231 DeMo.train INFO: Epoch[2] Iteration[10/54] Loss: 3.676, Acc: 0.031, Base Lr: 5.00e-06
2025-12-10 04:40:31,749 DeMo.train INFO: Epoch[2] Iteration[20/54] Loss: 3.607, Acc: 0.039, Base Lr: 5.00e-06
2025-12-10 04:40:34,255 DeMo.train INFO: Epoch[2] Iteration[30/54] Loss: 3.549, Acc: 0.046, Base Lr: 5.00e-06
2025-12-10 04:40:36,772 DeMo.train INFO: Epoch[2] Iteration[40/54] Loss: 3.495, Acc: 0.059, Base Lr: 5.00e-06
2025-12-10 04:40:39,282 DeMo.train INFO: Epoch[2] Iteration[50/54] Loss: 3.452, Acc: 0.067, Base Lr: 5.00e-06
2025-12-10 04:40:40,134 DeMo.train INFO: Epoch 2 done. Time per batch: 0.275[s] Speed: 232.5[samples/s]
2025-12-10 04:40:40,135 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:40,135 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:40:40,135 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:45,426 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 04:40:45,426 DeMo.train INFO: mAP: 53.7%
2025-12-10 04:40:45,426 DeMo.train INFO: CMC curve, Rank-1  :54.5%
2025-12-10 04:40:45,426 DeMo.train INFO: CMC curve, Rank-5  :65.8%
2025-12-10 04:40:45,426 DeMo.train INFO: CMC curve, Rank-10 :72.7%
2025-12-10 04:40:45,426 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:46,535 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:46,535 DeMo.train INFO: Best mAP: 53.7%
2025-12-10 04:40:46,535 DeMo.train INFO: Best Rank-1: 54.5%
2025-12-10 04:40:46,536 DeMo.train INFO: Best Rank-5: 65.8%
2025-12-10 04:40:46,536 DeMo.train INFO: Best Rank-10: 72.7%
2025-12-10 04:40:46,536 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:51,021 DeMo.train INFO: Epoch[3] Iteration[10/54] Loss: 3.158, Acc: 0.156, Base Lr: 5.00e-06
2025-12-10 04:40:53,525 DeMo.train INFO: Epoch[3] Iteration[20/54] Loss: 3.162, Acc: 0.188, Base Lr: 5.00e-06
2025-12-10 04:40:56,053 DeMo.train INFO: Epoch[3] Iteration[30/54] Loss: 3.128, Acc: 0.209, Base Lr: 5.00e-06
2025-12-10 04:40:58,612 DeMo.train INFO: Epoch[3] Iteration[40/54] Loss: 3.117, Acc: 0.207, Base Lr: 5.00e-06
2025-12-10 04:41:01,151 DeMo.train INFO: Epoch[3] Iteration[50/54] Loss: 3.132, Acc: 0.219, Base Lr: 5.00e-06
2025-12-10 04:41:02,041 DeMo.train INFO: Epoch 3 done. Time per batch: 0.293[s] Speed: 218.8[samples/s]
2025-12-10 04:41:02,042 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:02,042 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:02,042 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:06,860 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 04:41:06,860 DeMo.train INFO: mAP: 62.6%
2025-12-10 04:41:06,860 DeMo.train INFO: CMC curve, Rank-1  :62.9%
2025-12-10 04:41:06,861 DeMo.train INFO: CMC curve, Rank-5  :74.9%
2025-12-10 04:41:06,861 DeMo.train INFO: CMC curve, Rank-10 :81.5%
2025-12-10 04:41:06,861 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:08,251 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:08,251 DeMo.train INFO: Best mAP: 62.6%
2025-12-10 04:41:08,251 DeMo.train INFO: Best Rank-1: 62.9%
2025-12-10 04:41:08,251 DeMo.train INFO: Best Rank-5: 74.9%
2025-12-10 04:41:08,251 DeMo.train INFO: Best Rank-10: 81.5%
2025-12-10 04:41:08,251 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:12,521 DeMo.train INFO: Epoch[4] Iteration[10/54] Loss: 2.917, Acc: 0.383, Base Lr: 5.00e-06
2025-12-10 04:41:15,039 DeMo.train INFO: Epoch[4] Iteration[20/54] Loss: 2.864, Acc: 0.377, Base Lr: 5.00e-06
2025-12-10 04:41:17,532 DeMo.train INFO: Epoch[4] Iteration[30/54] Loss: 2.877, Acc: 0.404, Base Lr: 5.00e-06
2025-12-10 04:41:20,051 DeMo.train INFO: Epoch[4] Iteration[40/54] Loss: 2.855, Acc: 0.430, Base Lr: 5.00e-06
2025-12-10 04:41:22,580 DeMo.train INFO: Epoch[4] Iteration[50/54] Loss: 2.855, Acc: 0.456, Base Lr: 5.00e-06
2025-12-10 04:41:23,430 DeMo.train INFO: Epoch 4 done. Time per batch: 0.286[s] Speed: 223.5[samples/s]
2025-12-10 04:41:23,432 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:23,432 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:23,432 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:28,621 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 04:41:28,622 DeMo.train INFO: mAP: 63.7%
2025-12-10 04:41:28,622 DeMo.train INFO: CMC curve, Rank-1  :65.6%
2025-12-10 04:41:28,622 DeMo.train INFO: CMC curve, Rank-5  :75.2%
2025-12-10 04:41:28,622 DeMo.train INFO: CMC curve, Rank-10 :80.3%
2025-12-10 04:41:28,622 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:30,436 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:30,436 DeMo.train INFO: Best mAP: 63.7%
2025-12-10 04:41:30,436 DeMo.train INFO: Best Rank-1: 65.6%
2025-12-10 04:41:30,436 DeMo.train INFO: Best Rank-5: 75.2%
2025-12-10 04:41:30,436 DeMo.train INFO: Best Rank-10: 80.3%
2025-12-10 04:41:30,437 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:34,708 DeMo.train INFO: Epoch[5] Iteration[10/54] Loss: 2.716, Acc: 0.611, Base Lr: 5.00e-06
2025-12-10 04:41:37,243 DeMo.train INFO: Epoch[5] Iteration[20/54] Loss: 2.725, Acc: 0.595, Base Lr: 5.00e-06
2025-12-10 04:41:39,730 DeMo.train INFO: Epoch[5] Iteration[30/54] Loss: 2.707, Acc: 0.590, Base Lr: 5.00e-06
2025-12-10 04:41:42,288 DeMo.train INFO: Epoch[5] Iteration[40/54] Loss: 2.689, Acc: 0.598, Base Lr: 5.00e-06
2025-12-10 04:41:44,792 DeMo.train INFO: Epoch[5] Iteration[50/54] Loss: 2.699, Acc: 0.602, Base Lr: 5.00e-06
2025-12-10 04:41:45,677 DeMo.train INFO: Epoch 5 done. Time per batch: 0.288[s] Speed: 222.6[samples/s]
2025-12-10 04:41:45,678 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:45,678 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:45,678 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:50,825 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 04:41:50,825 DeMo.train INFO: mAP: 65.6%
2025-12-10 04:41:50,825 DeMo.train INFO: CMC curve, Rank-1  :67.5%
2025-12-10 04:41:50,825 DeMo.train INFO: CMC curve, Rank-5  :77.6%
2025-12-10 04:41:50,825 DeMo.train INFO: CMC curve, Rank-10 :83.0%
2025-12-10 04:41:50,825 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:52,353 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:52,353 DeMo.train INFO: Best mAP: 65.6%
2025-12-10 04:41:52,353 DeMo.train INFO: Best Rank-1: 67.5%
2025-12-10 04:41:52,354 DeMo.train INFO: Best Rank-5: 77.6%
2025-12-10 04:41:52,354 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:41:52,354 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:56,818 DeMo.train INFO: Epoch[6] Iteration[10/54] Loss: 2.628, Acc: 0.713, Base Lr: 5.00e-06
2025-12-10 04:41:59,345 DeMo.train INFO: Epoch[6] Iteration[20/54] Loss: 2.657, Acc: 0.670, Base Lr: 5.00e-06
2025-12-10 04:42:01,885 DeMo.train INFO: Epoch[6] Iteration[30/54] Loss: 2.649, Acc: 0.700, Base Lr: 5.00e-06
2025-12-10 04:42:04,414 DeMo.train INFO: Epoch[6] Iteration[40/54] Loss: 2.658, Acc: 0.693, Base Lr: 5.00e-06
2025-12-10 04:42:06,956 DeMo.train INFO: Epoch[6] Iteration[50/54] Loss: 2.659, Acc: 0.692, Base Lr: 5.00e-06
2025-12-10 04:42:07,810 DeMo.train INFO: Epoch 6 done. Time per batch: 0.292[s] Speed: 219.5[samples/s]
2025-12-10 04:42:07,811 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:07,811 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:07,811 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:12,787 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 04:42:12,787 DeMo.train INFO: mAP: 64.9%
2025-12-10 04:42:12,787 DeMo.train INFO: CMC curve, Rank-1  :66.9%
2025-12-10 04:42:12,787 DeMo.train INFO: CMC curve, Rank-5  :75.0%
2025-12-10 04:42:12,787 DeMo.train INFO: CMC curve, Rank-10 :79.3%
2025-12-10 04:42:12,787 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:13,851 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:13,851 DeMo.train INFO: Best mAP: 65.6%
2025-12-10 04:42:13,851 DeMo.train INFO: Best Rank-1: 67.5%
2025-12-10 04:42:13,852 DeMo.train INFO: Best Rank-5: 77.6%
2025-12-10 04:42:13,852 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:42:13,852 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:18,664 DeMo.train INFO: Epoch[7] Iteration[10/54] Loss: 2.556, Acc: 0.805, Base Lr: 5.00e-06
2025-12-10 04:42:21,274 DeMo.train INFO: Epoch[7] Iteration[20/54] Loss: 2.557, Acc: 0.790, Base Lr: 5.00e-06
2025-12-10 04:42:23,774 DeMo.train INFO: Epoch[7] Iteration[30/54] Loss: 2.556, Acc: 0.776, Base Lr: 5.00e-06
2025-12-10 04:42:26,306 DeMo.train INFO: Epoch[7] Iteration[40/54] Loss: 2.557, Acc: 0.768, Base Lr: 5.00e-06
2025-12-10 04:42:28,823 DeMo.train INFO: Epoch[7] Iteration[50/54] Loss: 2.568, Acc: 0.764, Base Lr: 5.00e-06
2025-12-10 04:42:29,707 DeMo.train INFO: Epoch 7 done. Time per batch: 0.299[s] Speed: 213.9[samples/s]
2025-12-10 04:42:29,708 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:29,708 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:29,708 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:34,626 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 04:42:34,626 DeMo.train INFO: mAP: 67.0%
2025-12-10 04:42:34,626 DeMo.train INFO: CMC curve, Rank-1  :67.7%
2025-12-10 04:42:34,626 DeMo.train INFO: CMC curve, Rank-5  :78.3%
2025-12-10 04:42:34,626 DeMo.train INFO: CMC curve, Rank-10 :83.0%
2025-12-10 04:42:34,626 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:35,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:35,167 DeMo.train INFO: Best mAP: 67.0%
2025-12-10 04:42:35,167 DeMo.train INFO: Best Rank-1: 67.7%
2025-12-10 04:42:35,168 DeMo.train INFO: Best Rank-5: 78.3%
2025-12-10 04:42:35,168 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:42:35,168 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:38,930 DeMo.train INFO: Epoch[8] Iteration[10/54] Loss: 2.518, Acc: 0.777, Base Lr: 5.00e-06
2025-12-10 04:42:41,490 DeMo.train INFO: Epoch[8] Iteration[20/54] Loss: 2.524, Acc: 0.788, Base Lr: 5.00e-06
2025-12-10 04:42:43,999 DeMo.train INFO: Epoch[8] Iteration[30/54] Loss: 2.515, Acc: 0.799, Base Lr: 5.00e-06
2025-12-10 04:42:46,514 DeMo.train INFO: Epoch[8] Iteration[40/54] Loss: 2.527, Acc: 0.802, Base Lr: 5.00e-06
2025-12-10 04:42:49,027 DeMo.train INFO: Epoch[8] Iteration[50/54] Loss: 2.523, Acc: 0.809, Base Lr: 5.00e-06
2025-12-10 04:42:49,883 DeMo.train INFO: Epoch 8 done. Time per batch: 0.278[s] Speed: 230.5[samples/s]
2025-12-10 04:42:49,884 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:49,884 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:49,884 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:54,448 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 04:42:54,449 DeMo.train INFO: mAP: 66.0%
2025-12-10 04:42:54,449 DeMo.train INFO: CMC curve, Rank-1  :68.3%
2025-12-10 04:42:54,449 DeMo.train INFO: CMC curve, Rank-5  :76.9%
2025-12-10 04:42:54,449 DeMo.train INFO: CMC curve, Rank-10 :81.7%
2025-12-10 04:42:54,449 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:55,595 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:55,595 DeMo.train INFO: Best mAP: 67.0%
2025-12-10 04:42:55,596 DeMo.train INFO: Best Rank-1: 67.7%
2025-12-10 04:42:55,596 DeMo.train INFO: Best Rank-5: 78.3%
2025-12-10 04:42:55,596 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:42:55,596 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:00,632 DeMo.train INFO: Epoch[9] Iteration[10/54] Loss: 2.519, Acc: 0.805, Base Lr: 5.00e-06
2025-12-10 04:43:03,147 DeMo.train INFO: Epoch[9] Iteration[20/54] Loss: 2.532, Acc: 0.810, Base Lr: 5.00e-06
2025-12-10 04:43:05,669 DeMo.train INFO: Epoch[9] Iteration[30/54] Loss: 2.518, Acc: 0.828, Base Lr: 5.00e-06
2025-12-10 04:43:08,311 DeMo.train INFO: Epoch[9] Iteration[40/54] Loss: 2.505, Acc: 0.838, Base Lr: 5.00e-06
2025-12-10 04:43:10,823 DeMo.train INFO: Epoch[9] Iteration[50/54] Loss: 2.508, Acc: 0.843, Base Lr: 5.00e-06
2025-12-10 04:43:11,720 DeMo.train INFO: Epoch 9 done. Time per batch: 0.304[s] Speed: 210.4[samples/s]
2025-12-10 04:43:11,721 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:11,721 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:11,721 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:16,739 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 04:43:16,739 DeMo.train INFO: mAP: 64.4%
2025-12-10 04:43:16,739 DeMo.train INFO: CMC curve, Rank-1  :65.2%
2025-12-10 04:43:16,740 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 04:43:16,740 DeMo.train INFO: CMC curve, Rank-10 :83.5%
2025-12-10 04:43:16,740 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:17,874 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:17,874 DeMo.train INFO: Best mAP: 67.0%
2025-12-10 04:43:17,874 DeMo.train INFO: Best Rank-1: 67.7%
2025-12-10 04:43:17,875 DeMo.train INFO: Best Rank-5: 78.3%
2025-12-10 04:43:17,875 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:43:17,875 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:22,629 DeMo.train INFO: Epoch[10] Iteration[10/54] Loss: 2.478, Acc: 0.839, Base Lr: 5.00e-06
2025-12-10 04:43:25,182 DeMo.train INFO: Epoch[10] Iteration[20/54] Loss: 2.464, Acc: 0.834, Base Lr: 5.00e-06
2025-12-10 04:43:27,690 DeMo.train INFO: Epoch[10] Iteration[30/54] Loss: 2.458, Acc: 0.841, Base Lr: 5.00e-06
2025-12-10 04:43:30,311 DeMo.train INFO: Epoch[10] Iteration[40/54] Loss: 2.445, Acc: 0.860, Base Lr: 5.00e-06
2025-12-10 04:43:32,952 DeMo.train INFO: Epoch[10] Iteration[50/54] Loss: 2.448, Acc: 0.876, Base Lr: 5.00e-06
2025-12-10 04:43:33,826 DeMo.train INFO: Epoch 10 done. Time per batch: 0.301[s] Speed: 212.6[samples/s]
2025-12-10 04:43:33,827 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:33,828 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:33,828 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:39,138 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 04:43:39,138 DeMo.train INFO: mAP: 65.7%
2025-12-10 04:43:39,138 DeMo.train INFO: CMC curve, Rank-1  :66.5%
2025-12-10 04:43:39,138 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 04:43:39,139 DeMo.train INFO: CMC curve, Rank-10 :82.4%
2025-12-10 04:43:39,139 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:40,489 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:40,489 DeMo.train INFO: Best mAP: 67.0%
2025-12-10 04:43:40,490 DeMo.train INFO: Best Rank-1: 67.7%
2025-12-10 04:43:40,490 DeMo.train INFO: Best Rank-5: 78.3%
2025-12-10 04:43:40,490 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:43:40,490 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:45,685 DeMo.train INFO: Epoch[11] Iteration[10/54] Loss: 2.428, Acc: 0.833, Base Lr: 5.00e-06
2025-12-10 04:43:48,194 DeMo.train INFO: Epoch[11] Iteration[20/54] Loss: 2.441, Acc: 0.863, Base Lr: 5.00e-06
2025-12-10 04:43:50,712 DeMo.train INFO: Epoch[11] Iteration[30/54] Loss: 2.433, Acc: 0.867, Base Lr: 5.00e-06
2025-12-10 04:43:53,242 DeMo.train INFO: Epoch[11] Iteration[40/54] Loss: 2.457, Acc: 0.866, Base Lr: 5.00e-06
2025-12-10 04:43:55,743 DeMo.train INFO: Epoch[11] Iteration[50/54] Loss: 2.456, Acc: 0.879, Base Lr: 5.00e-06
2025-12-10 04:43:56,660 DeMo.train INFO: Epoch 11 done. Time per batch: 0.305[s] Speed: 209.8[samples/s]
2025-12-10 04:43:56,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:56,661 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:56,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:01,400 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 04:44:01,400 DeMo.train INFO: mAP: 65.5%
2025-12-10 04:44:01,400 DeMo.train INFO: CMC curve, Rank-1  :67.6%
2025-12-10 04:44:01,401 DeMo.train INFO: CMC curve, Rank-5  :78.5%
2025-12-10 04:44:01,401 DeMo.train INFO: CMC curve, Rank-10 :82.9%
2025-12-10 04:44:01,401 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:02,646 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:02,646 DeMo.train INFO: Best mAP: 67.0%
2025-12-10 04:44:02,646 DeMo.train INFO: Best Rank-1: 67.7%
2025-12-10 04:44:02,646 DeMo.train INFO: Best Rank-5: 78.3%
2025-12-10 04:44:02,646 DeMo.train INFO: Best Rank-10: 83.0%
2025-12-10 04:44:02,646 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:07,550 DeMo.train INFO: Epoch[12] Iteration[10/54] Loss: 2.389, Acc: 0.834, Base Lr: 5.00e-06
2025-12-10 04:44:10,083 DeMo.train INFO: Epoch[12] Iteration[20/54] Loss: 2.384, Acc: 0.864, Base Lr: 5.00e-06
2025-12-10 04:44:12,609 DeMo.train INFO: Epoch[12] Iteration[30/54] Loss: 2.398, Acc: 0.892, Base Lr: 5.00e-06
2025-12-10 04:44:15,103 DeMo.train INFO: Epoch[12] Iteration[40/54] Loss: 2.403, Acc: 0.895, Base Lr: 5.00e-06
2025-12-10 04:44:17,626 DeMo.train INFO: Epoch[12] Iteration[50/54] Loss: 2.397, Acc: 0.888, Base Lr: 5.00e-06
2025-12-10 04:44:18,512 DeMo.train INFO: Epoch 12 done. Time per batch: 0.299[s] Speed: 213.8[samples/s]
2025-12-10 04:44:18,513 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:18,513 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:44:18,513 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:23,787 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 04:44:23,788 DeMo.train INFO: mAP: 69.6%
2025-12-10 04:44:23,788 DeMo.train INFO: CMC curve, Rank-1  :71.5%
2025-12-10 04:44:23,788 DeMo.train INFO: CMC curve, Rank-5  :81.6%
2025-12-10 04:44:23,788 DeMo.train INFO: CMC curve, Rank-10 :85.8%
2025-12-10 04:44:23,788 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:25,141 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:25,141 DeMo.train INFO: Best mAP: 69.6%
2025-12-10 04:44:25,142 DeMo.train INFO: Best Rank-1: 71.5%
2025-12-10 04:44:25,142 DeMo.train INFO: Best Rank-5: 81.6%
2025-12-10 04:44:25,142 DeMo.train INFO: Best Rank-10: 85.8%
2025-12-10 04:44:25,142 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:29,631 DeMo.train INFO: Epoch[13] Iteration[10/54] Loss: 2.365, Acc: 0.836, Base Lr: 5.00e-06
2025-12-10 04:44:32,460 DeMo.train INFO: Epoch[13] Iteration[20/54] Loss: 2.359, Acc: 0.867, Base Lr: 5.00e-06
2025-12-10 04:44:34,968 DeMo.train INFO: Epoch[13] Iteration[30/54] Loss: 2.349, Acc: 0.894, Base Lr: 5.00e-06
2025-12-10 04:44:37,511 DeMo.train INFO: Epoch[13] Iteration[40/54] Loss: 2.341, Acc: 0.896, Base Lr: 5.00e-06
2025-12-10 04:44:40,044 DeMo.train INFO: Epoch[13] Iteration[50/54] Loss: 2.339, Acc: 0.907, Base Lr: 5.00e-06
2025-12-10 04:44:40,924 DeMo.train INFO: Epoch 13 done. Time per batch: 0.298[s] Speed: 214.9[samples/s]
2025-12-10 04:44:40,925 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:40,925 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:44:40,925 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:45,794 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 04:44:45,794 DeMo.train INFO: mAP: 68.1%
2025-12-10 04:44:45,794 DeMo.train INFO: CMC curve, Rank-1  :69.0%
2025-12-10 04:44:45,795 DeMo.train INFO: CMC curve, Rank-5  :78.8%
2025-12-10 04:44:45,795 DeMo.train INFO: CMC curve, Rank-10 :83.5%
2025-12-10 04:44:45,795 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:47,062 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:47,062 DeMo.train INFO: Best mAP: 69.6%
2025-12-10 04:44:47,063 DeMo.train INFO: Best Rank-1: 71.5%
2025-12-10 04:44:47,063 DeMo.train INFO: Best Rank-5: 81.6%
2025-12-10 04:44:47,063 DeMo.train INFO: Best Rank-10: 85.8%
2025-12-10 04:44:47,063 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:52,033 DeMo.train INFO: Epoch[14] Iteration[10/54] Loss: 2.317, Acc: 0.880, Base Lr: 5.00e-06
2025-12-10 04:44:54,941 DeMo.train INFO: Epoch[14] Iteration[20/54] Loss: 2.321, Acc: 0.906, Base Lr: 5.00e-06
2025-12-10 04:44:57,459 DeMo.train INFO: Epoch[14] Iteration[30/54] Loss: 2.325, Acc: 0.901, Base Lr: 5.00e-06
2025-12-10 04:44:59,983 DeMo.train INFO: Epoch[14] Iteration[40/54] Loss: 2.326, Acc: 0.899, Base Lr: 5.00e-06
2025-12-10 04:45:02,508 DeMo.train INFO: Epoch[14] Iteration[50/54] Loss: 2.318, Acc: 0.910, Base Lr: 5.00e-06
2025-12-10 04:45:03,384 DeMo.train INFO: Epoch 14 done. Time per batch: 0.308[s] Speed: 207.8[samples/s]
2025-12-10 04:45:03,385 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:03,385 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:03,385 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:08,355 DeMo.train INFO: Validation Results - Epoch: 14
2025-12-10 04:45:08,355 DeMo.train INFO: mAP: 71.2%
2025-12-10 04:45:08,355 DeMo.train INFO: CMC curve, Rank-1  :73.9%
2025-12-10 04:45:08,355 DeMo.train INFO: CMC curve, Rank-5  :81.2%
2025-12-10 04:45:08,355 DeMo.train INFO: CMC curve, Rank-10 :85.6%
2025-12-10 04:45:08,355 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:09,809 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:09,809 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:45:09,809 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:45:09,809 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:45:09,809 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:45:09,810 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:14,140 DeMo.train INFO: Epoch[15] Iteration[10/54] Loss: 2.341, Acc: 0.841, Base Lr: 5.00e-06
2025-12-10 04:45:16,666 DeMo.train INFO: Epoch[15] Iteration[20/54] Loss: 2.314, Acc: 0.873, Base Lr: 5.00e-06
2025-12-10 04:45:19,186 DeMo.train INFO: Epoch[15] Iteration[30/54] Loss: 2.307, Acc: 0.898, Base Lr: 5.00e-06
2025-12-10 04:45:21,725 DeMo.train INFO: Epoch[15] Iteration[40/54] Loss: 2.312, Acc: 0.904, Base Lr: 5.00e-06
2025-12-10 04:45:24,266 DeMo.train INFO: Epoch[15] Iteration[50/54] Loss: 2.303, Acc: 0.911, Base Lr: 5.00e-06
2025-12-10 04:45:25,151 DeMo.train INFO: Epoch 15 done. Time per batch: 0.289[s] Speed: 221.1[samples/s]
2025-12-10 04:45:25,152 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:25,152 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:25,152 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:30,042 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 04:45:30,042 DeMo.train INFO: mAP: 70.8%
2025-12-10 04:45:30,042 DeMo.train INFO: CMC curve, Rank-1  :74.3%
2025-12-10 04:45:30,042 DeMo.train INFO: CMC curve, Rank-5  :82.3%
2025-12-10 04:45:30,042 DeMo.train INFO: CMC curve, Rank-10 :85.8%
2025-12-10 04:45:30,042 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:30,094 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:30,094 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:45:30,094 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:45:30,094 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:45:30,095 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:45:30,095 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:34,178 DeMo.train INFO: Epoch[16] Iteration[10/54] Loss: 2.307, Acc: 0.908, Base Lr: 5.00e-06
2025-12-10 04:45:36,802 DeMo.train INFO: Epoch[16] Iteration[20/54] Loss: 2.309, Acc: 0.900, Base Lr: 5.00e-06
2025-12-10 04:45:39,351 DeMo.train INFO: Epoch[16] Iteration[30/54] Loss: 2.304, Acc: 0.897, Base Lr: 5.00e-06
2025-12-10 04:45:41,890 DeMo.train INFO: Epoch[16] Iteration[40/54] Loss: 2.293, Acc: 0.906, Base Lr: 5.00e-06
2025-12-10 04:45:44,545 DeMo.train INFO: Epoch[16] Iteration[50/54] Loss: 2.279, Acc: 0.916, Base Lr: 5.00e-06
2025-12-10 04:45:45,421 DeMo.train INFO: Epoch 16 done. Time per batch: 0.289[s] Speed: 221.3[samples/s]
2025-12-10 04:45:45,422 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:45,422 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:45,422 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:50,588 DeMo.train INFO: Validation Results - Epoch: 16
2025-12-10 04:45:50,588 DeMo.train INFO: mAP: 69.2%
2025-12-10 04:45:50,589 DeMo.train INFO: CMC curve, Rank-1  :68.9%
2025-12-10 04:45:50,589 DeMo.train INFO: CMC curve, Rank-5  :80.4%
2025-12-10 04:45:50,589 DeMo.train INFO: CMC curve, Rank-10 :85.0%
2025-12-10 04:45:50,589 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:51,630 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:51,630 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:45:51,630 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:45:51,630 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:45:51,630 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:45:51,630 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:56,553 DeMo.train INFO: Epoch[17] Iteration[10/54] Loss: 2.293, Acc: 0.845, Base Lr: 5.00e-06
2025-12-10 04:45:59,087 DeMo.train INFO: Epoch[17] Iteration[20/54] Loss: 2.272, Acc: 0.858, Base Lr: 5.00e-06
2025-12-10 04:46:01,638 DeMo.train INFO: Epoch[17] Iteration[30/54] Loss: 2.261, Acc: 0.883, Base Lr: 5.00e-06
2025-12-10 04:46:04,183 DeMo.train INFO: Epoch[17] Iteration[40/54] Loss: 2.248, Acc: 0.898, Base Lr: 5.00e-06
2025-12-10 04:46:06,727 DeMo.train INFO: Epoch[17] Iteration[50/54] Loss: 2.241, Acc: 0.911, Base Lr: 5.00e-06
2025-12-10 04:46:07,605 DeMo.train INFO: Epoch 17 done. Time per batch: 0.301[s] Speed: 212.3[samples/s]
2025-12-10 04:46:07,606 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:07,607 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:07,607 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:12,740 DeMo.train INFO: Validation Results - Epoch: 17
2025-12-10 04:46:12,740 DeMo.train INFO: mAP: 69.3%
2025-12-10 04:46:12,740 DeMo.train INFO: CMC curve, Rank-1  :70.3%
2025-12-10 04:46:12,740 DeMo.train INFO: CMC curve, Rank-5  :79.5%
2025-12-10 04:46:12,740 DeMo.train INFO: CMC curve, Rank-10 :84.4%
2025-12-10 04:46:12,741 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:13,470 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:13,470 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:46:13,470 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:46:13,470 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:46:13,471 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:46:13,471 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:18,394 DeMo.train INFO: Epoch[18] Iteration[10/54] Loss: 2.220, Acc: 0.916, Base Lr: 5.00e-06
2025-12-10 04:46:20,948 DeMo.train INFO: Epoch[18] Iteration[20/54] Loss: 2.239, Acc: 0.920, Base Lr: 5.00e-06
2025-12-10 04:46:23,446 DeMo.train INFO: Epoch[18] Iteration[30/54] Loss: 2.227, Acc: 0.925, Base Lr: 5.00e-06
2025-12-10 04:46:26,041 DeMo.train INFO: Epoch[18] Iteration[40/54] Loss: 2.219, Acc: 0.926, Base Lr: 5.00e-06
2025-12-10 04:46:28,576 DeMo.train INFO: Epoch[18] Iteration[50/54] Loss: 2.214, Acc: 0.925, Base Lr: 5.00e-06
2025-12-10 04:46:29,476 DeMo.train INFO: Epoch 18 done. Time per batch: 0.302[s] Speed: 211.9[samples/s]
2025-12-10 04:46:29,477 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:29,477 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:29,477 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:34,177 DeMo.train INFO: Validation Results - Epoch: 18
2025-12-10 04:46:34,177 DeMo.train INFO: mAP: 69.6%
2025-12-10 04:46:34,177 DeMo.train INFO: CMC curve, Rank-1  :70.2%
2025-12-10 04:46:34,178 DeMo.train INFO: CMC curve, Rank-5  :81.8%
2025-12-10 04:46:34,178 DeMo.train INFO: CMC curve, Rank-10 :85.9%
2025-12-10 04:46:34,178 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:34,253 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:34,254 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:46:34,254 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:46:34,254 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:46:34,254 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:46:34,254 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:38,373 DeMo.train INFO: Epoch[19] Iteration[10/54] Loss: 2.225, Acc: 0.895, Base Lr: 5.00e-06
2025-12-10 04:46:40,909 DeMo.train INFO: Epoch[19] Iteration[20/54] Loss: 2.213, Acc: 0.894, Base Lr: 5.00e-06
2025-12-10 04:46:43,421 DeMo.train INFO: Epoch[19] Iteration[30/54] Loss: 2.204, Acc: 0.891, Base Lr: 5.00e-06
2025-12-10 04:46:45,968 DeMo.train INFO: Epoch[19] Iteration[40/54] Loss: 2.202, Acc: 0.901, Base Lr: 5.00e-06
2025-12-10 04:46:48,486 DeMo.train INFO: Epoch[19] Iteration[50/54] Loss: 2.194, Acc: 0.912, Base Lr: 5.00e-06
2025-12-10 04:46:49,393 DeMo.train INFO: Epoch 19 done. Time per batch: 0.286[s] Speed: 224.1[samples/s]
2025-12-10 04:46:49,394 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:49,394 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:49,394 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:54,492 DeMo.train INFO: Validation Results - Epoch: 19
2025-12-10 04:46:54,492 DeMo.train INFO: mAP: 70.4%
2025-12-10 04:46:54,492 DeMo.train INFO: CMC curve, Rank-1  :73.0%
2025-12-10 04:46:54,492 DeMo.train INFO: CMC curve, Rank-5  :83.7%
2025-12-10 04:46:54,492 DeMo.train INFO: CMC curve, Rank-10 :87.6%
2025-12-10 04:46:54,492 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:55,280 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:55,280 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:46:55,280 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:46:55,280 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:46:55,280 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:46:55,280 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:00,250 DeMo.train INFO: Epoch[20] Iteration[10/54] Loss: 2.188, Acc: 0.870, Base Lr: 5.00e-06
2025-12-10 04:47:02,763 DeMo.train INFO: Epoch[20] Iteration[20/54] Loss: 2.174, Acc: 0.884, Base Lr: 5.00e-06
2025-12-10 04:47:05,361 DeMo.train INFO: Epoch[20] Iteration[30/54] Loss: 2.168, Acc: 0.901, Base Lr: 5.00e-06
2025-12-10 04:47:07,885 DeMo.train INFO: Epoch[20] Iteration[40/54] Loss: 2.160, Acc: 0.907, Base Lr: 5.00e-06
2025-12-10 04:47:10,412 DeMo.train INFO: Epoch[20] Iteration[50/54] Loss: 2.161, Acc: 0.910, Base Lr: 5.00e-06
2025-12-10 04:47:11,304 DeMo.train INFO: Epoch 20 done. Time per batch: 0.302[s] Speed: 211.7[samples/s]
2025-12-10 04:47:11,305 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:11,305 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:47:11,306 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:47:16,299 DeMo.train INFO: Validation Results - Epoch: 20
2025-12-10 04:47:16,299 DeMo.train INFO: mAP: 70.3%
2025-12-10 04:47:16,299 DeMo.train INFO: CMC curve, Rank-1  :73.3%
2025-12-10 04:47:16,300 DeMo.train INFO: CMC curve, Rank-5  :82.2%
2025-12-10 04:47:16,300 DeMo.train INFO: CMC curve, Rank-10 :86.0%
2025-12-10 04:47:16,300 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:17,296 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:17,297 DeMo.train INFO: Best mAP: 71.2%
2025-12-10 04:47:17,297 DeMo.train INFO: Best Rank-1: 73.9%
2025-12-10 04:47:17,297 DeMo.train INFO: Best Rank-5: 81.2%
2025-12-10 04:47:17,297 DeMo.train INFO: Best Rank-10: 85.6%
2025-12-10 04:47:17,297 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

2025-12-10 04:39:48,012 DeMo INFO: Saving model in the path :..
2025-12-10 04:39:48,012 DeMo INFO: Namespace(config_file='configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml', exp_name=None, fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'True', 'MODEL.USE_DGAF', 'True', 'MODEL.DGAF_VERSION', 'v1', 'MODEL.GLOBAL_LOCAL', 'True', 'MODEL.SDTPS_CROSS_ATTN_TYPE', 'attention', 'MODEL.SDTPS_CROSS_ATTN_HEADS', '4'])
2025-12-10 04:39:48,012 DeMo INFO: Loaded configuration file configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml
2025-12-10 04:39:48,013 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention（推荐）
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用（原 MLP predictor 权重）
  SDTPS_AGGR_RATIO: 0.5    # 已不使用（原 TokenAggregation）
  SDTPS_LOSS_WEIGHT: 2.0   # SDTPS 分支的损失权重
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 8
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# SDTPS + DGAF Ablation Config
# ============================================================================
# - SACR: disabled
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10
# - TF32: enabled in train_net.py
# ============================================================================

2025-12-10 04:39:48,013 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 8
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT201
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ADAPTER: False
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v1
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  GLOBAL_LOCAL: True
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: True
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: True
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGBNT201 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   171 |     3951 |         4
  query    |    30 |      836 |         2
  gallery  |    30 |      836 |         2
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:16 width: 8
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 4
===========Building DeMo===========
2025-12-10 04:40:00,067 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (dgaf): DualGatedPostFusion(
    (entropy_proj): Linear(in_features=512, out_features=512, bias=True)
    (gate_net): Sequential(
      (0): Linear(in_features=1536, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (2): ReLU(inplace=True)
      (3): Linear(in_features=512, out_features=3, bias=True)
      (4): Sigmoid()
    )
    (modal_enhance): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (sdtps): MultiModalSDTPS(
    (rgb_sparse): TokenSparse(
      (modal_weight_mlp): Sequential(
        (0): Linear(in_features=1536, out_features=64, bias=True)
        (1): ReLU()
        (2): Linear(in_features=64, out_features=3, bias=True)
      )
    )
    (nir_sparse): TokenSparse(
      (modal_weight_mlp): Sequential(
        (0): Linear(in_features=1536, out_features=64, bias=True)
        (1): ReLU()
        (2): Linear(in_features=64, out_features=3, bias=True)
      )
    )
    (tir_sparse): TokenSparse(
      (modal_weight_mlp): Sequential(
        (0): Linear(in_features=1536, out_features=64, bias=True)
        (1): ReLU()
        (2): Linear(in_features=64, out_features=3, bias=True)
      )
    )
    (rgb_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (rgb_cross_nir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (rgb_cross_tir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_cross_rgb): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_cross_tir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_cross_rgb): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_cross_nir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
  )
  (classifier_sdtps): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck_sdtps): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_dgaf): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck_dgaf): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-10 04:40:00,069 DeMo INFO: number of parameters:94.855949
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
Unsupported operator aten::log encountered 3 time(s)
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, bottleneck_dgaf, bottleneck_sdtps, classifier, classifier_dgaf, classifier_sdtps
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The out_proj here is called by the nn.MultiheadAttention, which has been calculated in th .forward(), so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For the bottleneck or classifier, it is not calculated during inference, so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:05,292 DeMo INFO: number of GFLOPs: 34.58627388999999
using soft triplet loss for training
label smooth on, numclasses: 171
2025-12-10 04:40:05,307 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 04:40:09,951 DeMo.train INFO: Epoch[1] Iteration[10/54] Loss: 11.786, Acc: 0.005, Base Lr: 5.00e-06
2025-12-10 04:40:12,934 DeMo.train INFO: Epoch[1] Iteration[20/54] Loss: 9.556, Acc: 0.007, Base Lr: 5.00e-06
2025-12-10 04:40:15,447 DeMo.train INFO: Epoch[1] Iteration[30/54] Loss: 8.548, Acc: 0.007, Base Lr: 5.00e-06
2025-12-10 04:40:17,973 DeMo.train INFO: Epoch[1] Iteration[40/54] Loss: 7.930, Acc: 0.009, Base Lr: 5.00e-06
2025-12-10 04:40:20,516 DeMo.train INFO: Epoch[1] Iteration[50/54] Loss: 7.566, Acc: 0.009, Base Lr: 5.00e-06
2025-12-10 04:40:21,414 DeMo.train INFO: Epoch 1 done. Time per batch: 0.303[s] Speed: 211.1[samples/s]
2025-12-10 04:40:21,415 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:21,415 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:40:21,415 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:27,712 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 04:40:27,713 DeMo.train INFO: mAP: 13.7%
2025-12-10 04:40:27,713 DeMo.train INFO: CMC curve, Rank-1  :10.9%
2025-12-10 04:40:27,713 DeMo.train INFO: CMC curve, Rank-5  :24.5%
2025-12-10 04:40:27,713 DeMo.train INFO: CMC curve, Rank-10 :31.6%
2025-12-10 04:40:27,713 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:28,453 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:28,453 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:40:28,454 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:34,512 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 04:40:34,512 DeMo.train INFO: mAP: 13.7%
2025-12-10 04:40:34,513 DeMo.train INFO: CMC curve, Rank-1  :10.9%
2025-12-10 04:40:34,513 DeMo.train INFO: CMC curve, Rank-5  :24.5%
2025-12-10 04:40:34,513 DeMo.train INFO: CMC curve, Rank-10 :31.6%
2025-12-10 04:40:34,513 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:34,518 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:34,518 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:40:34,518 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:39,728 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 04:40:39,728 DeMo.train INFO: mAP: 13.7%
2025-12-10 04:40:39,728 DeMo.train INFO: CMC curve, Rank-1  :10.9%
2025-12-10 04:40:39,728 DeMo.train INFO: CMC curve, Rank-5  :24.5%
2025-12-10 04:40:39,728 DeMo.train INFO: CMC curve, Rank-10 :31.6%
2025-12-10 04:40:39,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:40,251 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:40,252 DeMo.train INFO: Best mAP: 13.7%
2025-12-10 04:40:40,252 DeMo.train INFO: Best Rank-1: 10.9%
2025-12-10 04:40:40,252 DeMo.train INFO: Best Rank-5: 24.5%
2025-12-10 04:40:40,252 DeMo.train INFO: Best Rank-10: 31.6%
2025-12-10 04:40:40,252 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:44,134 DeMo.train INFO: Epoch[2] Iteration[10/54] Loss: 5.775, Acc: 0.016, Base Lr: 5.00e-06
2025-12-10 04:40:46,766 DeMo.train INFO: Epoch[2] Iteration[20/54] Loss: 5.732, Acc: 0.026, Base Lr: 5.00e-06
2025-12-10 04:40:49,329 DeMo.train INFO: Epoch[2] Iteration[30/54] Loss: 5.690, Acc: 0.038, Base Lr: 5.00e-06
2025-12-10 04:40:51,877 DeMo.train INFO: Epoch[2] Iteration[40/54] Loss: 5.634, Acc: 0.047, Base Lr: 5.00e-06
2025-12-10 04:40:54,422 DeMo.train INFO: Epoch[2] Iteration[50/54] Loss: 5.568, Acc: 0.056, Base Lr: 5.00e-06
2025-12-10 04:40:55,311 DeMo.train INFO: Epoch 2 done. Time per batch: 0.284[s] Speed: 225.3[samples/s]
2025-12-10 04:40:55,313 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:55,313 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:40:55,313 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:00,399 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 04:41:00,399 DeMo.train INFO: mAP: 34.9%
2025-12-10 04:41:00,399 DeMo.train INFO: CMC curve, Rank-1  :34.3%
2025-12-10 04:41:00,399 DeMo.train INFO: CMC curve, Rank-5  :51.6%
2025-12-10 04:41:00,400 DeMo.train INFO: CMC curve, Rank-10 :60.6%
2025-12-10 04:41:00,400 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:01,001 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:01,001 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:41:01,002 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:06,735 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 04:41:06,735 DeMo.train INFO: mAP: 34.9%
2025-12-10 04:41:06,735 DeMo.train INFO: CMC curve, Rank-1  :34.3%
2025-12-10 04:41:06,735 DeMo.train INFO: CMC curve, Rank-5  :51.6%
2025-12-10 04:41:06,735 DeMo.train INFO: CMC curve, Rank-10 :60.6%
2025-12-10 04:41:06,735 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:07,729 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:07,729 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:07,729 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:13,444 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 04:41:13,444 DeMo.train INFO: mAP: 34.9%
2025-12-10 04:41:13,444 DeMo.train INFO: CMC curve, Rank-1  :34.3%
2025-12-10 04:41:13,444 DeMo.train INFO: CMC curve, Rank-5  :51.6%
2025-12-10 04:41:13,444 DeMo.train INFO: CMC curve, Rank-10 :60.6%
2025-12-10 04:41:13,444 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:13,953 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:13,954 DeMo.train INFO: Best mAP: 34.9%
2025-12-10 04:41:13,954 DeMo.train INFO: Best Rank-1: 34.3%
2025-12-10 04:41:13,954 DeMo.train INFO: Best Rank-5: 51.6%
2025-12-10 04:41:13,954 DeMo.train INFO: Best Rank-10: 60.6%
2025-12-10 04:41:13,954 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:17,945 DeMo.train INFO: Epoch[3] Iteration[10/54] Loss: 5.157, Acc: 0.142, Base Lr: 5.00e-06
2025-12-10 04:41:21,008 DeMo.train INFO: Epoch[3] Iteration[20/54] Loss: 5.166, Acc: 0.134, Base Lr: 5.00e-06
2025-12-10 04:41:23,558 DeMo.train INFO: Epoch[3] Iteration[30/54] Loss: 5.084, Acc: 0.143, Base Lr: 5.00e-06
2025-12-10 04:41:26,109 DeMo.train INFO: Epoch[3] Iteration[40/54] Loss: 5.033, Acc: 0.139, Base Lr: 5.00e-06
2025-12-10 04:41:28,746 DeMo.train INFO: Epoch[3] Iteration[50/54] Loss: 5.011, Acc: 0.142, Base Lr: 5.00e-06
2025-12-10 04:41:29,658 DeMo.train INFO: Epoch 3 done. Time per batch: 0.296[s] Speed: 216.0[samples/s]
2025-12-10 04:41:29,660 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:29,660 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:41:29,660 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:35,625 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 04:41:35,625 DeMo.train INFO: mAP: 52.2%
2025-12-10 04:41:35,625 DeMo.train INFO: CMC curve, Rank-1  :55.0%
2025-12-10 04:41:35,625 DeMo.train INFO: CMC curve, Rank-5  :69.3%
2025-12-10 04:41:35,625 DeMo.train INFO: CMC curve, Rank-10 :76.8%
2025-12-10 04:41:35,625 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:35,687 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:35,687 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:41:35,687 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:40,678 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 04:41:40,679 DeMo.train INFO: mAP: 52.2%
2025-12-10 04:41:40,679 DeMo.train INFO: CMC curve, Rank-1  :55.0%
2025-12-10 04:41:40,679 DeMo.train INFO: CMC curve, Rank-5  :69.3%
2025-12-10 04:41:40,679 DeMo.train INFO: CMC curve, Rank-10 :76.8%
2025-12-10 04:41:40,679 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:40,682 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:40,682 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:40,682 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:45,676 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 04:41:45,677 DeMo.train INFO: mAP: 52.2%
2025-12-10 04:41:45,677 DeMo.train INFO: CMC curve, Rank-1  :55.0%
2025-12-10 04:41:45,677 DeMo.train INFO: CMC curve, Rank-5  :69.3%
2025-12-10 04:41:45,677 DeMo.train INFO: CMC curve, Rank-10 :76.8%
2025-12-10 04:41:45,677 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:46,134 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:46,134 DeMo.train INFO: Best mAP: 52.2%
2025-12-10 04:41:46,134 DeMo.train INFO: Best Rank-1: 55.0%
2025-12-10 04:41:46,134 DeMo.train INFO: Best Rank-5: 69.3%
2025-12-10 04:41:46,135 DeMo.train INFO: Best Rank-10: 76.8%
2025-12-10 04:41:46,135 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:50,131 DeMo.train INFO: Epoch[4] Iteration[10/54] Loss: 4.527, Acc: 0.297, Base Lr: 5.00e-06
2025-12-10 04:41:52,678 DeMo.train INFO: Epoch[4] Iteration[20/54] Loss: 4.431, Acc: 0.305, Base Lr: 5.00e-06
2025-12-10 04:41:55,218 DeMo.train INFO: Epoch[4] Iteration[30/54] Loss: 4.484, Acc: 0.307, Base Lr: 5.00e-06
2025-12-10 04:41:57,754 DeMo.train INFO: Epoch[4] Iteration[40/54] Loss: 4.478, Acc: 0.299, Base Lr: 5.00e-06
2025-12-10 04:42:00,326 DeMo.train INFO: Epoch[4] Iteration[50/54] Loss: 4.436, Acc: 0.316, Base Lr: 5.00e-06
2025-12-10 04:42:01,227 DeMo.train INFO: Epoch 4 done. Time per batch: 0.285[s] Speed: 224.8[samples/s]
2025-12-10 04:42:01,228 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:01,228 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:42:01,228 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:06,325 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 04:42:06,325 DeMo.train INFO: mAP: 60.0%
2025-12-10 04:42:06,325 DeMo.train INFO: CMC curve, Rank-1  :62.7%
2025-12-10 04:42:06,325 DeMo.train INFO: CMC curve, Rank-5  :74.4%
2025-12-10 04:42:06,325 DeMo.train INFO: CMC curve, Rank-10 :83.3%
2025-12-10 04:42:06,325 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:06,603 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:06,604 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:42:06,604 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:12,382 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 04:42:12,382 DeMo.train INFO: mAP: 60.0%
2025-12-10 04:42:12,382 DeMo.train INFO: CMC curve, Rank-1  :62.7%
2025-12-10 04:42:12,382 DeMo.train INFO: CMC curve, Rank-5  :74.4%
2025-12-10 04:42:12,382 DeMo.train INFO: CMC curve, Rank-10 :83.3%
2025-12-10 04:42:12,382 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:12,386 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:12,386 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:12,386 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:17,519 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 04:42:17,519 DeMo.train INFO: mAP: 60.0%
2025-12-10 04:42:17,519 DeMo.train INFO: CMC curve, Rank-1  :62.7%
2025-12-10 04:42:17,519 DeMo.train INFO: CMC curve, Rank-5  :74.4%
2025-12-10 04:42:17,520 DeMo.train INFO: CMC curve, Rank-10 :83.3%
2025-12-10 04:42:17,520 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:19,161 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:19,162 DeMo.train INFO: Best mAP: 60.0%
2025-12-10 04:42:19,162 DeMo.train INFO: Best Rank-1: 62.7%
2025-12-10 04:42:19,162 DeMo.train INFO: Best Rank-5: 74.4%
2025-12-10 04:42:19,162 DeMo.train INFO: Best Rank-10: 83.3%
2025-12-10 04:42:19,162 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:23,681 DeMo.train INFO: Epoch[5] Iteration[10/54] Loss: 4.055, Acc: 0.481, Base Lr: 5.00e-06
2025-12-10 04:42:26,289 DeMo.train INFO: Epoch[5] Iteration[20/54] Loss: 4.116, Acc: 0.521, Base Lr: 5.00e-06
2025-12-10 04:42:28,841 DeMo.train INFO: Epoch[5] Iteration[30/54] Loss: 4.100, Acc: 0.486, Base Lr: 5.00e-06
2025-12-10 04:42:31,413 DeMo.train INFO: Epoch[5] Iteration[40/54] Loss: 4.101, Acc: 0.477, Base Lr: 5.00e-06
2025-12-10 04:42:33,971 DeMo.train INFO: Epoch[5] Iteration[50/54] Loss: 4.143, Acc: 0.484, Base Lr: 5.00e-06
2025-12-10 04:42:34,875 DeMo.train INFO: Epoch 5 done. Time per batch: 0.296[s] Speed: 215.9[samples/s]
2025-12-10 04:42:34,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:34,877 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:42:34,877 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:40,145 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 04:42:40,146 DeMo.train INFO: mAP: 61.4%
2025-12-10 04:42:40,146 DeMo.train INFO: CMC curve, Rank-1  :63.9%
2025-12-10 04:42:40,146 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 04:42:40,146 DeMo.train INFO: CMC curve, Rank-10 :84.0%
2025-12-10 04:42:40,146 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:41,039 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:41,039 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:42:41,039 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:47,930 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 04:42:47,930 DeMo.train INFO: mAP: 61.4%
2025-12-10 04:42:47,930 DeMo.train INFO: CMC curve, Rank-1  :63.9%
2025-12-10 04:42:47,930 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 04:42:47,931 DeMo.train INFO: CMC curve, Rank-10 :84.0%
2025-12-10 04:42:47,931 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:48,376 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:48,376 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:48,376 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:54,034 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 04:42:54,035 DeMo.train INFO: mAP: 61.4%
2025-12-10 04:42:54,035 DeMo.train INFO: CMC curve, Rank-1  :63.9%
2025-12-10 04:42:54,035 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 04:42:54,035 DeMo.train INFO: CMC curve, Rank-10 :84.0%
2025-12-10 04:42:54,035 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:54,550 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:54,550 DeMo.train INFO: Best mAP: 61.4%
2025-12-10 04:42:54,550 DeMo.train INFO: Best Rank-1: 63.9%
2025-12-10 04:42:54,551 DeMo.train INFO: Best Rank-5: 76.8%
2025-12-10 04:42:54,551 DeMo.train INFO: Best Rank-10: 84.0%
2025-12-10 04:42:54,551 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:58,371 DeMo.train INFO: Epoch[6] Iteration[10/54] Loss: 4.006, Acc: 0.648, Base Lr: 5.00e-06
2025-12-10 04:43:00,957 DeMo.train INFO: Epoch[6] Iteration[20/54] Loss: 4.052, Acc: 0.657, Base Lr: 5.00e-06
2025-12-10 04:43:03,495 DeMo.train INFO: Epoch[6] Iteration[30/54] Loss: 4.034, Acc: 0.653, Base Lr: 5.00e-06
2025-12-10 04:43:06,076 DeMo.train INFO: Epoch[6] Iteration[40/54] Loss: 4.016, Acc: 0.640, Base Lr: 5.00e-06
2025-12-10 04:43:08,659 DeMo.train INFO: Epoch[6] Iteration[50/54] Loss: 4.020, Acc: 0.640, Base Lr: 5.00e-06
2025-12-10 04:43:09,559 DeMo.train INFO: Epoch 6 done. Time per batch: 0.283[s] Speed: 226.0[samples/s]
2025-12-10 04:43:09,561 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:09,561 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:43:09,561 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:14,456 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 04:43:14,456 DeMo.train INFO: mAP: 64.2%
2025-12-10 04:43:14,456 DeMo.train INFO: CMC curve, Rank-1  :64.5%
2025-12-10 04:43:14,457 DeMo.train INFO: CMC curve, Rank-5  :76.0%
2025-12-10 04:43:14,457 DeMo.train INFO: CMC curve, Rank-10 :83.9%
2025-12-10 04:43:14,457 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:15,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:15,728 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:43:15,729 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:21,309 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 04:43:21,309 DeMo.train INFO: mAP: 64.2%
2025-12-10 04:43:21,309 DeMo.train INFO: CMC curve, Rank-1  :64.5%
2025-12-10 04:43:21,309 DeMo.train INFO: CMC curve, Rank-5  :76.0%
2025-12-10 04:43:21,310 DeMo.train INFO: CMC curve, Rank-10 :83.9%
2025-12-10 04:43:21,310 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:22,637 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:22,637 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:22,637 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:28,522 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 04:43:28,522 DeMo.train INFO: mAP: 64.2%
2025-12-10 04:43:28,522 DeMo.train INFO: CMC curve, Rank-1  :64.5%
2025-12-10 04:43:28,522 DeMo.train INFO: CMC curve, Rank-5  :76.0%
2025-12-10 04:43:28,522 DeMo.train INFO: CMC curve, Rank-10 :83.9%
2025-12-10 04:43:28,522 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:29,022 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:29,022 DeMo.train INFO: Best mAP: 64.2%
2025-12-10 04:43:29,022 DeMo.train INFO: Best Rank-1: 64.5%
2025-12-10 04:43:29,022 DeMo.train INFO: Best Rank-5: 76.0%
2025-12-10 04:43:29,023 DeMo.train INFO: Best Rank-10: 83.9%
2025-12-10 04:43:29,023 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:33,000 DeMo.train INFO: Epoch[7] Iteration[10/54] Loss: 3.916, Acc: 0.736, Base Lr: 5.00e-06
2025-12-10 04:43:35,576 DeMo.train INFO: Epoch[7] Iteration[20/54] Loss: 3.882, Acc: 0.720, Base Lr: 5.00e-06
2025-12-10 04:43:38,097 DeMo.train INFO: Epoch[7] Iteration[30/54] Loss: 3.889, Acc: 0.736, Base Lr: 5.00e-06
2025-12-10 04:43:40,680 DeMo.train INFO: Epoch[7] Iteration[40/54] Loss: 3.886, Acc: 0.743, Base Lr: 5.00e-06
2025-12-10 04:43:43,262 DeMo.train INFO: Epoch[7] Iteration[50/54] Loss: 3.906, Acc: 0.740, Base Lr: 5.00e-06
2025-12-10 04:43:44,199 DeMo.train INFO: Epoch 7 done. Time per batch: 0.286[s] Speed: 223.5[samples/s]
2025-12-10 04:43:44,201 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:44,201 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:43:44,201 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:49,143 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 04:43:49,143 DeMo.train INFO: mAP: 63.9%
2025-12-10 04:43:49,143 DeMo.train INFO: CMC curve, Rank-1  :63.5%
2025-12-10 04:43:49,143 DeMo.train INFO: CMC curve, Rank-5  :77.2%
2025-12-10 04:43:49,143 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:43:49,143 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:50,382 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:50,382 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:43:50,383 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:56,137 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 04:43:56,137 DeMo.train INFO: mAP: 63.9%
2025-12-10 04:43:56,137 DeMo.train INFO: CMC curve, Rank-1  :63.5%
2025-12-10 04:43:56,138 DeMo.train INFO: CMC curve, Rank-5  :77.2%
2025-12-10 04:43:56,138 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:43:56,138 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:56,141 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:56,141 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:56,141 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:01,158 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 04:44:01,158 DeMo.train INFO: mAP: 63.9%
2025-12-10 04:44:01,159 DeMo.train INFO: CMC curve, Rank-1  :63.5%
2025-12-10 04:44:01,159 DeMo.train INFO: CMC curve, Rank-5  :77.2%
2025-12-10 04:44:01,159 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:44:01,159 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:01,161 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:01,161 DeMo.train INFO: Best mAP: 64.2%
2025-12-10 04:44:01,161 DeMo.train INFO: Best Rank-1: 64.5%
2025-12-10 04:44:01,161 DeMo.train INFO: Best Rank-5: 76.0%
2025-12-10 04:44:01,161 DeMo.train INFO: Best Rank-10: 83.9%
2025-12-10 04:44:01,161 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:05,327 DeMo.train INFO: Epoch[8] Iteration[10/54] Loss: 3.868, Acc: 0.767, Base Lr: 5.00e-06
2025-12-10 04:44:07,899 DeMo.train INFO: Epoch[8] Iteration[20/54] Loss: 3.834, Acc: 0.777, Base Lr: 5.00e-06
2025-12-10 04:44:10,453 DeMo.train INFO: Epoch[8] Iteration[30/54] Loss: 3.821, Acc: 0.803, Base Lr: 5.00e-06
2025-12-10 04:44:13,029 DeMo.train INFO: Epoch[8] Iteration[40/54] Loss: 3.836, Acc: 0.808, Base Lr: 5.00e-06
2025-12-10 04:44:15,567 DeMo.train INFO: Epoch[8] Iteration[50/54] Loss: 3.835, Acc: 0.814, Base Lr: 5.00e-06
2025-12-10 04:44:16,470 DeMo.train INFO: Epoch 8 done. Time per batch: 0.289[s] Speed: 221.6[samples/s]
2025-12-10 04:44:16,472 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:16,472 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:44:16,472 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:21,655 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 04:44:21,655 DeMo.train INFO: mAP: 65.7%
2025-12-10 04:44:21,655 DeMo.train INFO: CMC curve, Rank-1  :64.6%
2025-12-10 04:44:21,655 DeMo.train INFO: CMC curve, Rank-5  :80.3%
2025-12-10 04:44:21,655 DeMo.train INFO: CMC curve, Rank-10 :87.0%
2025-12-10 04:44:21,655 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:22,485 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:22,486 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:44:22,486 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:28,044 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 04:44:28,044 DeMo.train INFO: mAP: 65.7%
2025-12-10 04:44:28,044 DeMo.train INFO: CMC curve, Rank-1  :64.6%
2025-12-10 04:44:28,044 DeMo.train INFO: CMC curve, Rank-5  :80.3%
2025-12-10 04:44:28,044 DeMo.train INFO: CMC curve, Rank-10 :87.0%
2025-12-10 04:44:28,044 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:28,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:28,050 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:44:28,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:33,092 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 04:44:33,092 DeMo.train INFO: mAP: 65.7%
2025-12-10 04:44:33,092 DeMo.train INFO: CMC curve, Rank-1  :64.6%
2025-12-10 04:44:33,092 DeMo.train INFO: CMC curve, Rank-5  :80.3%
2025-12-10 04:44:33,092 DeMo.train INFO: CMC curve, Rank-10 :87.0%
2025-12-10 04:44:33,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:33,607 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:33,607 DeMo.train INFO: Best mAP: 65.7%
2025-12-10 04:44:33,607 DeMo.train INFO: Best Rank-1: 64.6%
2025-12-10 04:44:33,607 DeMo.train INFO: Best Rank-5: 80.3%
2025-12-10 04:44:33,607 DeMo.train INFO: Best Rank-10: 87.0%
2025-12-10 04:44:33,607 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:37,456 DeMo.train INFO: Epoch[9] Iteration[10/54] Loss: 3.806, Acc: 0.800, Base Lr: 5.00e-06
2025-12-10 04:44:40,992 DeMo.train INFO: Epoch[9] Iteration[20/54] Loss: 3.839, Acc: 0.818, Base Lr: 5.00e-06
2025-12-10 04:44:43,592 DeMo.train INFO: Epoch[9] Iteration[30/54] Loss: 3.807, Acc: 0.825, Base Lr: 5.00e-06
2025-12-10 04:44:46,163 DeMo.train INFO: Epoch[9] Iteration[40/54] Loss: 3.788, Acc: 0.845, Base Lr: 5.00e-06
2025-12-10 04:44:48,732 DeMo.train INFO: Epoch[9] Iteration[50/54] Loss: 3.787, Acc: 0.850, Base Lr: 5.00e-06
2025-12-10 04:44:49,607 DeMo.train INFO: Epoch 9 done. Time per batch: 0.302[s] Speed: 212.0[samples/s]
2025-12-10 04:44:49,608 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:49,608 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:44:49,609 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:55,364 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 04:44:55,364 DeMo.train INFO: mAP: 66.9%
2025-12-10 04:44:55,364 DeMo.train INFO: CMC curve, Rank-1  :68.1%
2025-12-10 04:44:55,364 DeMo.train INFO: CMC curve, Rank-5  :79.1%
2025-12-10 04:44:55,364 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:44:55,364 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:55,416 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:55,416 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:44:55,416 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:00,615 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 04:45:00,615 DeMo.train INFO: mAP: 66.9%
2025-12-10 04:45:00,615 DeMo.train INFO: CMC curve, Rank-1  :68.1%
2025-12-10 04:45:00,615 DeMo.train INFO: CMC curve, Rank-5  :79.1%
2025-12-10 04:45:00,615 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:45:00,615 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:00,618 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:00,619 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:00,619 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:05,851 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 04:45:05,851 DeMo.train INFO: mAP: 66.9%
2025-12-10 04:45:05,851 DeMo.train INFO: CMC curve, Rank-1  :68.1%
2025-12-10 04:45:05,852 DeMo.train INFO: CMC curve, Rank-5  :79.1%
2025-12-10 04:45:05,852 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:45:05,852 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:06,501 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:06,501 DeMo.train INFO: Best mAP: 66.9%
2025-12-10 04:45:06,501 DeMo.train INFO: Best Rank-1: 68.1%
2025-12-10 04:45:06,501 DeMo.train INFO: Best Rank-5: 79.1%
2025-12-10 04:45:06,501 DeMo.train INFO: Best Rank-10: 84.2%
2025-12-10 04:45:06,502 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:11,836 DeMo.train INFO: Epoch[10] Iteration[10/54] Loss: 3.714, Acc: 0.844, Base Lr: 5.00e-06
2025-12-10 04:45:15,444 DeMo.train INFO: Epoch[10] Iteration[20/54] Loss: 3.702, Acc: 0.821, Base Lr: 5.00e-06
2025-12-10 04:45:17,993 DeMo.train INFO: Epoch[10] Iteration[30/54] Loss: 3.713, Acc: 0.845, Base Lr: 5.00e-06
2025-12-10 04:45:20,560 DeMo.train INFO: Epoch[10] Iteration[40/54] Loss: 3.691, Acc: 0.864, Base Lr: 5.00e-06
2025-12-10 04:45:23,127 DeMo.train INFO: Epoch[10] Iteration[50/54] Loss: 3.696, Acc: 0.872, Base Lr: 5.00e-06
2025-12-10 04:45:24,036 DeMo.train INFO: Epoch 10 done. Time per batch: 0.331[s] Speed: 193.5[samples/s]
2025-12-10 04:45:24,037 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:24,037 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:45:24,037 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:30,108 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 04:45:30,109 DeMo.train INFO: mAP: 68.7%
2025-12-10 04:45:30,109 DeMo.train INFO: CMC curve, Rank-1  :71.2%
2025-12-10 04:45:30,109 DeMo.train INFO: CMC curve, Rank-5  :80.6%
2025-12-10 04:45:30,109 DeMo.train INFO: CMC curve, Rank-10 :86.0%
2025-12-10 04:45:30,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:30,161 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:30,161 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:45:30,161 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:35,276 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 04:45:35,277 DeMo.train INFO: mAP: 68.7%
2025-12-10 04:45:35,277 DeMo.train INFO: CMC curve, Rank-1  :71.2%
2025-12-10 04:45:35,277 DeMo.train INFO: CMC curve, Rank-5  :80.6%
2025-12-10 04:45:35,277 DeMo.train INFO: CMC curve, Rank-10 :86.0%
2025-12-10 04:45:35,277 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:35,280 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:35,280 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:35,280 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:40,323 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 04:45:40,323 DeMo.train INFO: mAP: 68.7%
2025-12-10 04:45:40,324 DeMo.train INFO: CMC curve, Rank-1  :71.2%
2025-12-10 04:45:40,324 DeMo.train INFO: CMC curve, Rank-5  :80.6%
2025-12-10 04:45:40,324 DeMo.train INFO: CMC curve, Rank-10 :86.0%
2025-12-10 04:45:40,324 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:40,840 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:40,840 DeMo.train INFO: Best mAP: 68.7%
2025-12-10 04:45:40,840 DeMo.train INFO: Best Rank-1: 71.2%
2025-12-10 04:45:40,840 DeMo.train INFO: Best Rank-5: 80.6%
2025-12-10 04:45:40,840 DeMo.train INFO: Best Rank-10: 86.0%
2025-12-10 04:45:40,841 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:44,730 DeMo.train INFO: Epoch[11] Iteration[10/54] Loss: 3.685, Acc: 0.866, Base Lr: 5.00e-06
2025-12-10 04:45:47,303 DeMo.train INFO: Epoch[11] Iteration[20/54] Loss: 3.702, Acc: 0.871, Base Lr: 5.00e-06
2025-12-10 04:45:49,842 DeMo.train INFO: Epoch[11] Iteration[30/54] Loss: 3.700, Acc: 0.876, Base Lr: 5.00e-06
2025-12-10 04:45:52,432 DeMo.train INFO: Epoch[11] Iteration[40/54] Loss: 3.714, Acc: 0.870, Base Lr: 5.00e-06
2025-12-10 04:45:55,001 DeMo.train INFO: Epoch[11] Iteration[50/54] Loss: 3.707, Acc: 0.883, Base Lr: 5.00e-06
2025-12-10 04:45:55,921 DeMo.train INFO: Epoch 11 done. Time per batch: 0.285[s] Speed: 224.9[samples/s]
2025-12-10 04:45:55,922 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:55,923 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:45:55,923 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:00,897 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 04:46:00,898 DeMo.train INFO: mAP: 57.6%
2025-12-10 04:46:00,898 DeMo.train INFO: CMC curve, Rank-1  :54.7%
2025-12-10 04:46:00,898 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-12-10 04:46:00,898 DeMo.train INFO: CMC curve, Rank-10 :73.4%
2025-12-10 04:46:00,898 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:01,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:01,744 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:46:01,744 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:07,459 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 04:46:07,459 DeMo.train INFO: mAP: 57.6%
2025-12-10 04:46:07,459 DeMo.train INFO: CMC curve, Rank-1  :54.7%
2025-12-10 04:46:07,459 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-12-10 04:46:07,459 DeMo.train INFO: CMC curve, Rank-10 :73.4%
2025-12-10 04:46:07,459 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:07,477 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:07,477 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:07,477 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:12,708 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 04:46:12,708 DeMo.train INFO: mAP: 57.6%
2025-12-10 04:46:12,709 DeMo.train INFO: CMC curve, Rank-1  :54.7%
2025-12-10 04:46:12,709 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-12-10 04:46:12,709 DeMo.train INFO: CMC curve, Rank-10 :73.4%
2025-12-10 04:46:12,709 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:13,425 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:13,425 DeMo.train INFO: Best mAP: 68.7%
2025-12-10 04:46:13,425 DeMo.train INFO: Best Rank-1: 71.2%
2025-12-10 04:46:13,425 DeMo.train INFO: Best Rank-5: 80.6%
2025-12-10 04:46:13,425 DeMo.train INFO: Best Rank-10: 86.0%
2025-12-10 04:46:13,425 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:18,440 DeMo.train INFO: Epoch[12] Iteration[10/54] Loss: 3.592, Acc: 0.855, Base Lr: 5.00e-06
2025-12-10 04:46:21,073 DeMo.train INFO: Epoch[12] Iteration[20/54] Loss: 3.590, Acc: 0.881, Base Lr: 5.00e-06
2025-12-10 04:46:23,628 DeMo.train INFO: Epoch[12] Iteration[30/54] Loss: 3.625, Acc: 0.902, Base Lr: 5.00e-06
2025-12-10 04:46:26,187 DeMo.train INFO: Epoch[12] Iteration[40/54] Loss: 3.642, Acc: 0.898, Base Lr: 5.00e-06
2025-12-10 04:46:28,725 DeMo.train INFO: Epoch[12] Iteration[50/54] Loss: 3.630, Acc: 0.899, Base Lr: 5.00e-06
2025-12-10 04:46:29,624 DeMo.train INFO: Epoch 12 done. Time per batch: 0.306[s] Speed: 209.4[samples/s]
2025-12-10 04:46:29,626 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:29,626 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:46:29,626 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:35,142 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 04:46:35,143 DeMo.train INFO: mAP: 70.6%
2025-12-10 04:46:35,143 DeMo.train INFO: CMC curve, Rank-1  :71.2%
2025-12-10 04:46:35,143 DeMo.train INFO: CMC curve, Rank-5  :82.7%
2025-12-10 04:46:35,143 DeMo.train INFO: CMC curve, Rank-10 :88.5%
2025-12-10 04:46:35,143 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:35,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:35,877 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:46:35,877 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:41,686 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 04:46:41,687 DeMo.train INFO: mAP: 70.6%
2025-12-10 04:46:41,687 DeMo.train INFO: CMC curve, Rank-1  :71.2%
2025-12-10 04:46:41,687 DeMo.train INFO: CMC curve, Rank-5  :82.7%
2025-12-10 04:46:41,687 DeMo.train INFO: CMC curve, Rank-10 :88.5%
2025-12-10 04:46:41,687 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:41,690 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:41,690 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:41,690 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:46,552 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 04:46:46,552 DeMo.train INFO: mAP: 70.6%
2025-12-10 04:46:46,552 DeMo.train INFO: CMC curve, Rank-1  :71.2%
2025-12-10 04:46:46,552 DeMo.train INFO: CMC curve, Rank-5  :82.7%
2025-12-10 04:46:46,552 DeMo.train INFO: CMC curve, Rank-10 :88.5%
2025-12-10 04:46:46,552 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:48,407 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:48,407 DeMo.train INFO: Best mAP: 70.6%
2025-12-10 04:46:48,407 DeMo.train INFO: Best Rank-1: 71.2%
2025-12-10 04:46:48,407 DeMo.train INFO: Best Rank-5: 82.7%
2025-12-10 04:46:48,407 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:46:48,407 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:52,751 DeMo.train INFO: Epoch[13] Iteration[10/54] Loss: 3.605, Acc: 0.844, Base Lr: 5.00e-06
2025-12-10 04:46:55,309 DeMo.train INFO: Epoch[13] Iteration[20/54] Loss: 3.577, Acc: 0.871, Base Lr: 5.00e-06
2025-12-10 04:46:57,843 DeMo.train INFO: Epoch[13] Iteration[30/54] Loss: 3.549, Acc: 0.891, Base Lr: 5.00e-06
2025-12-10 04:47:00,418 DeMo.train INFO: Epoch[13] Iteration[40/54] Loss: 3.545, Acc: 0.900, Base Lr: 5.00e-06
2025-12-10 04:47:02,958 DeMo.train INFO: Epoch[13] Iteration[50/54] Loss: 3.555, Acc: 0.916, Base Lr: 5.00e-06
2025-12-10 04:47:03,870 DeMo.train INFO: Epoch 13 done. Time per batch: 0.292[s] Speed: 219.4[samples/s]
2025-12-10 04:47:03,874 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:03,874 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 04:47:03,874 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:47:08,978 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 04:47:08,978 DeMo.train INFO: mAP: 66.8%
2025-12-10 04:47:08,978 DeMo.train INFO: CMC curve, Rank-1  :67.1%
2025-12-10 04:47:08,978 DeMo.train INFO: CMC curve, Rank-5  :80.7%
2025-12-10 04:47:08,978 DeMo.train INFO: CMC curve, Rank-10 :86.2%
2025-12-10 04:47:08,978 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:10,228 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:10,228 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 04:47:10,228 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:47:16,248 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 04:47:16,249 DeMo.train INFO: mAP: 66.8%
2025-12-10 04:47:16,249 DeMo.train INFO: CMC curve, Rank-1  :67.1%
2025-12-10 04:47:16,249 DeMo.train INFO: CMC curve, Rank-5  :80.7%
2025-12-10 04:47:16,249 DeMo.train INFO: CMC curve, Rank-10 :86.2%
2025-12-10 04:47:16,249 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:17,249 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:17,249 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:47:17,249 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:47:23,254 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 04:47:23,254 DeMo.train INFO: mAP: 66.8%
2025-12-10 04:47:23,254 DeMo.train INFO: CMC curve, Rank-1  :67.1%
2025-12-10 04:47:23,254 DeMo.train INFO: CMC curve, Rank-5  :80.7%
2025-12-10 04:47:23,255 DeMo.train INFO: CMC curve, Rank-10 :86.2%
2025-12-10 04:47:23,255 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:24,219 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:24,219 DeMo.train INFO: Best mAP: 70.6%
2025-12-10 04:47:24,219 DeMo.train INFO: Best Rank-1: 71.2%
2025-12-10 04:47:24,220 DeMo.train INFO: Best Rank-5: 82.7%
2025-12-10 04:47:24,220 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:47:24,220 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:29,467 DeMo.train INFO: Epoch[14] Iteration[10/54] Loss: 3.491, Acc: 0.883, Base Lr: 5.00e-06
2025-12-10 04:47:32,029 DeMo.train INFO: Epoch[14] Iteration[20/54] Loss: 3.526, Acc: 0.913, Base Lr: 5.00e-06

2025-12-10 04:39:48,012 DeMo INFO: Saving model in the path :..
2025-12-10 04:39:48,012 DeMo INFO: Namespace(config_file='configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml', exp_name=None, fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'False', 'MODEL.USE_DGAF', 'False', 'MODEL.GLOBAL_LOCAL', 'False'])
2025-12-10 04:39:48,012 DeMo INFO: Loaded configuration file configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml
2025-12-10 04:39:48,013 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention（推荐）
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用（原 MLP predictor 权重）
  SDTPS_AGGR_RATIO: 0.5    # 已不使用（原 TokenAggregation）
  SDTPS_LOSS_WEIGHT: 2.0   # SDTPS 分支的损失权重
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 8
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# SDTPS + DGAF Ablation Config
# ============================================================================
# - SACR: disabled
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10
# - TF32: enabled in train_net.py
# ============================================================================

2025-12-10 04:39:48,013 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 8
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT201
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ADAPTER: False
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: False
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: False
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGBNT201 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   171 |     3951 |         4
  query    |    30 |      836 |         2
  gallery  |    30 |      836 |         2
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:16 width: 8
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 4
===========Building DeMo===========
2025-12-10 04:39:59,717 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (classifier): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-10 04:39:59,718 DeMo INFO: number of parameters:87.988224
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, classifier, nir_reduce, nir_reduce.0, nir_reduce.1, nir_reduce.2, pool, rgb_reduce, rgb_reduce.0, rgb_reduce.1, rgb_reduce.2, tir_reduce, tir_reduce.0, tir_reduce.1, tir_reduce.2
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The out_proj here is called by the nn.MultiheadAttention, which has been calculated in th .forward(), so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For the bottleneck or classifier, it is not calculated during inference, so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:02,634 DeMo INFO: number of GFLOPs: 34.275378708000005
using soft triplet loss for training
label smooth on, numclasses: 171
2025-12-10 04:40:02,644 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 04:40:07,818 DeMo.train INFO: Epoch[1] Iteration[10/54] Loss: 3.452, Acc: 0.005, Base Lr: 5.00e-06
2025-12-10 04:40:10,163 DeMo.train INFO: Epoch[1] Iteration[20/54] Loss: 2.859, Acc: 0.005, Base Lr: 5.00e-06
2025-12-10 04:40:12,504 DeMo.train INFO: Epoch[1] Iteration[30/54] Loss: 2.616, Acc: 0.008, Base Lr: 5.00e-06
2025-12-10 04:40:14,857 DeMo.train INFO: Epoch[1] Iteration[40/54] Loss: 2.465, Acc: 0.010, Base Lr: 5.00e-06
2025-12-10 04:40:17,190 DeMo.train INFO: Epoch[1] Iteration[50/54] Loss: 2.371, Acc: 0.009, Base Lr: 5.00e-06
2025-12-10 04:40:18,000 DeMo.train INFO: Epoch 1 done. Time per batch: 0.290[s] Speed: 221.0[samples/s]
2025-12-10 04:40:18,001 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:18,001 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:40:18,001 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:22,898 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 04:40:22,899 DeMo.train INFO: mAP: 12.5%
2025-12-10 04:40:22,899 DeMo.train INFO: CMC curve, Rank-1  :10.2%
2025-12-10 04:40:22,899 DeMo.train INFO: CMC curve, Rank-5  :19.9%
2025-12-10 04:40:22,899 DeMo.train INFO: CMC curve, Rank-10 :27.4%
2025-12-10 04:40:22,899 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:23,344 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:23,345 DeMo.train INFO: Best mAP: 12.5%
2025-12-10 04:40:23,345 DeMo.train INFO: Best Rank-1: 10.2%
2025-12-10 04:40:23,345 DeMo.train INFO: Best Rank-5: 19.9%
2025-12-10 04:40:23,345 DeMo.train INFO: Best Rank-10: 27.4%
2025-12-10 04:40:23,345 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:26,696 DeMo.train INFO: Epoch[2] Iteration[10/54] Loss: 1.904, Acc: 0.066, Base Lr: 5.00e-06
2025-12-10 04:40:29,870 DeMo.train INFO: Epoch[2] Iteration[20/54] Loss: 1.877, Acc: 0.066, Base Lr: 5.00e-06
2025-12-10 04:40:32,219 DeMo.train INFO: Epoch[2] Iteration[30/54] Loss: 1.868, Acc: 0.062, Base Lr: 5.00e-06
2025-12-10 04:40:34,615 DeMo.train INFO: Epoch[2] Iteration[40/54] Loss: 1.851, Acc: 0.070, Base Lr: 5.00e-06
2025-12-10 04:40:36,995 DeMo.train INFO: Epoch[2] Iteration[50/54] Loss: 1.827, Acc: 0.073, Base Lr: 5.00e-06
2025-12-10 04:40:37,824 DeMo.train INFO: Epoch 2 done. Time per batch: 0.273[s] Speed: 234.3[samples/s]
2025-12-10 04:40:37,825 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:37,825 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:40:37,826 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:40:42,586 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 04:40:42,586 DeMo.train INFO: mAP: 40.2%
2025-12-10 04:40:42,586 DeMo.train INFO: CMC curve, Rank-1  :40.0%
2025-12-10 04:40:42,586 DeMo.train INFO: CMC curve, Rank-5  :56.9%
2025-12-10 04:40:42,586 DeMo.train INFO: CMC curve, Rank-10 :63.9%
2025-12-10 04:40:42,586 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:44,210 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:44,211 DeMo.train INFO: Best mAP: 40.2%
2025-12-10 04:40:44,211 DeMo.train INFO: Best Rank-1: 40.0%
2025-12-10 04:40:44,211 DeMo.train INFO: Best Rank-5: 56.9%
2025-12-10 04:40:44,211 DeMo.train INFO: Best Rank-10: 63.9%
2025-12-10 04:40:44,211 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:48,424 DeMo.train INFO: Epoch[3] Iteration[10/54] Loss: 1.646, Acc: 0.213, Base Lr: 5.00e-06
2025-12-10 04:40:50,801 DeMo.train INFO: Epoch[3] Iteration[20/54] Loss: 1.660, Acc: 0.232, Base Lr: 5.00e-06
2025-12-10 04:40:53,427 DeMo.train INFO: Epoch[3] Iteration[30/54] Loss: 1.634, Acc: 0.223, Base Lr: 5.00e-06
2025-12-10 04:40:55,966 DeMo.train INFO: Epoch[3] Iteration[40/54] Loss: 1.622, Acc: 0.213, Base Lr: 5.00e-06
2025-12-10 04:40:58,387 DeMo.train INFO: Epoch[3] Iteration[50/54] Loss: 1.634, Acc: 0.210, Base Lr: 5.00e-06
2025-12-10 04:40:59,226 DeMo.train INFO: Epoch 3 done. Time per batch: 0.283[s] Speed: 225.9[samples/s]
2025-12-10 04:40:59,227 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:40:59,227 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:40:59,227 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:04,340 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 04:41:04,340 DeMo.train INFO: mAP: 48.7%
2025-12-10 04:41:04,340 DeMo.train INFO: CMC curve, Rank-1  :48.2%
2025-12-10 04:41:04,340 DeMo.train INFO: CMC curve, Rank-5  :63.5%
2025-12-10 04:41:04,340 DeMo.train INFO: CMC curve, Rank-10 :71.7%
2025-12-10 04:41:04,340 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:06,055 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:06,055 DeMo.train INFO: Best mAP: 48.7%
2025-12-10 04:41:06,055 DeMo.train INFO: Best Rank-1: 48.2%
2025-12-10 04:41:06,055 DeMo.train INFO: Best Rank-5: 63.5%
2025-12-10 04:41:06,055 DeMo.train INFO: Best Rank-10: 71.7%
2025-12-10 04:41:06,055 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:10,206 DeMo.train INFO: Epoch[4] Iteration[10/54] Loss: 1.520, Acc: 0.347, Base Lr: 5.00e-06
2025-12-10 04:41:13,106 DeMo.train INFO: Epoch[4] Iteration[20/54] Loss: 1.486, Acc: 0.391, Base Lr: 5.00e-06
2025-12-10 04:41:15,492 DeMo.train INFO: Epoch[4] Iteration[30/54] Loss: 1.495, Acc: 0.385, Base Lr: 5.00e-06
2025-12-10 04:41:17,889 DeMo.train INFO: Epoch[4] Iteration[40/54] Loss: 1.485, Acc: 0.388, Base Lr: 5.00e-06
2025-12-10 04:41:20,261 DeMo.train INFO: Epoch[4] Iteration[50/54] Loss: 1.477, Acc: 0.419, Base Lr: 5.00e-06
2025-12-10 04:41:21,084 DeMo.train INFO: Epoch 4 done. Time per batch: 0.284[s] Speed: 225.7[samples/s]
2025-12-10 04:41:21,085 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:21,085 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:21,085 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:26,089 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 04:41:26,089 DeMo.train INFO: mAP: 57.7%
2025-12-10 04:41:26,089 DeMo.train INFO: CMC curve, Rank-1  :58.0%
2025-12-10 04:41:26,089 DeMo.train INFO: CMC curve, Rank-5  :72.6%
2025-12-10 04:41:26,090 DeMo.train INFO: CMC curve, Rank-10 :79.7%
2025-12-10 04:41:26,090 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:26,625 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:26,625 DeMo.train INFO: Best mAP: 57.7%
2025-12-10 04:41:26,625 DeMo.train INFO: Best Rank-1: 58.0%
2025-12-10 04:41:26,625 DeMo.train INFO: Best Rank-5: 72.6%
2025-12-10 04:41:26,625 DeMo.train INFO: Best Rank-10: 79.7%
2025-12-10 04:41:26,625 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:29,968 DeMo.train INFO: Epoch[5] Iteration[10/54] Loss: 1.362, Acc: 0.633, Base Lr: 5.00e-06
2025-12-10 04:41:32,474 DeMo.train INFO: Epoch[5] Iteration[20/54] Loss: 1.379, Acc: 0.615, Base Lr: 5.00e-06
2025-12-10 04:41:34,874 DeMo.train INFO: Epoch[5] Iteration[30/54] Loss: 1.362, Acc: 0.608, Base Lr: 5.00e-06
2025-12-10 04:41:37,278 DeMo.train INFO: Epoch[5] Iteration[40/54] Loss: 1.353, Acc: 0.620, Base Lr: 5.00e-06
2025-12-10 04:41:39,644 DeMo.train INFO: Epoch[5] Iteration[50/54] Loss: 1.362, Acc: 0.605, Base Lr: 5.00e-06
2025-12-10 04:41:40,481 DeMo.train INFO: Epoch 5 done. Time per batch: 0.261[s] Speed: 244.8[samples/s]
2025-12-10 04:41:40,482 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:40,482 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:40,482 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:41:45,386 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 04:41:45,386 DeMo.train INFO: mAP: 62.0%
2025-12-10 04:41:45,386 DeMo.train INFO: CMC curve, Rank-1  :63.3%
2025-12-10 04:41:45,386 DeMo.train INFO: CMC curve, Rank-5  :76.2%
2025-12-10 04:41:45,387 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-10 04:41:45,387 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:45,995 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:45,996 DeMo.train INFO: Best mAP: 62.0%
2025-12-10 04:41:45,996 DeMo.train INFO: Best Rank-1: 63.3%
2025-12-10 04:41:45,996 DeMo.train INFO: Best Rank-5: 76.2%
2025-12-10 04:41:45,996 DeMo.train INFO: Best Rank-10: 84.2%
2025-12-10 04:41:45,996 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:49,486 DeMo.train INFO: Epoch[6] Iteration[10/54] Loss: 1.340, Acc: 0.705, Base Lr: 5.00e-06
2025-12-10 04:41:51,845 DeMo.train INFO: Epoch[6] Iteration[20/54] Loss: 1.359, Acc: 0.696, Base Lr: 5.00e-06
2025-12-10 04:41:54,229 DeMo.train INFO: Epoch[6] Iteration[30/54] Loss: 1.354, Acc: 0.717, Base Lr: 5.00e-06
2025-12-10 04:41:56,600 DeMo.train INFO: Epoch[6] Iteration[40/54] Loss: 1.348, Acc: 0.712, Base Lr: 5.00e-06
2025-12-10 04:41:59,000 DeMo.train INFO: Epoch[6] Iteration[50/54] Loss: 1.346, Acc: 0.727, Base Lr: 5.00e-06
2025-12-10 04:41:59,865 DeMo.train INFO: Epoch 6 done. Time per batch: 0.262[s] Speed: 244.6[samples/s]
2025-12-10 04:41:59,867 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:41:59,867 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:41:59,867 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:05,191 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 04:42:05,191 DeMo.train INFO: mAP: 59.6%
2025-12-10 04:42:05,191 DeMo.train INFO: CMC curve, Rank-1  :62.3%
2025-12-10 04:42:05,191 DeMo.train INFO: CMC curve, Rank-5  :72.7%
2025-12-10 04:42:05,191 DeMo.train INFO: CMC curve, Rank-10 :78.2%
2025-12-10 04:42:05,191 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:05,239 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:05,240 DeMo.train INFO: Best mAP: 62.0%
2025-12-10 04:42:05,240 DeMo.train INFO: Best Rank-1: 63.3%
2025-12-10 04:42:05,240 DeMo.train INFO: Best Rank-5: 76.2%
2025-12-10 04:42:05,240 DeMo.train INFO: Best Rank-10: 84.2%
2025-12-10 04:42:05,240 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:08,974 DeMo.train INFO: Epoch[7] Iteration[10/54] Loss: 1.303, Acc: 0.831, Base Lr: 5.00e-06
2025-12-10 04:42:11,370 DeMo.train INFO: Epoch[7] Iteration[20/54] Loss: 1.291, Acc: 0.810, Base Lr: 5.00e-06
2025-12-10 04:42:13,743 DeMo.train INFO: Epoch[7] Iteration[30/54] Loss: 1.292, Acc: 0.801, Base Lr: 5.00e-06
2025-12-10 04:42:16,142 DeMo.train INFO: Epoch[7] Iteration[40/54] Loss: 1.285, Acc: 0.808, Base Lr: 5.00e-06
2025-12-10 04:42:18,542 DeMo.train INFO: Epoch[7] Iteration[50/54] Loss: 1.290, Acc: 0.802, Base Lr: 5.00e-06
2025-12-10 04:42:19,367 DeMo.train INFO: Epoch 7 done. Time per batch: 0.267[s] Speed: 240.1[samples/s]
2025-12-10 04:42:19,368 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:19,368 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:19,368 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:24,388 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 04:42:24,388 DeMo.train INFO: mAP: 62.8%
2025-12-10 04:42:24,388 DeMo.train INFO: CMC curve, Rank-1  :64.7%
2025-12-10 04:42:24,388 DeMo.train INFO: CMC curve, Rank-5  :74.6%
2025-12-10 04:42:24,389 DeMo.train INFO: CMC curve, Rank-10 :79.8%
2025-12-10 04:42:24,389 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:24,903 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:24,903 DeMo.train INFO: Best mAP: 62.8%
2025-12-10 04:42:24,903 DeMo.train INFO: Best Rank-1: 64.7%
2025-12-10 04:42:24,904 DeMo.train INFO: Best Rank-5: 74.6%
2025-12-10 04:42:24,904 DeMo.train INFO: Best Rank-10: 79.8%
2025-12-10 04:42:24,904 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:28,620 DeMo.train INFO: Epoch[8] Iteration[10/54] Loss: 1.277, Acc: 0.781, Base Lr: 5.00e-06
2025-12-10 04:42:31,044 DeMo.train INFO: Epoch[8] Iteration[20/54] Loss: 1.267, Acc: 0.793, Base Lr: 5.00e-06
2025-12-10 04:42:33,736 DeMo.train INFO: Epoch[8] Iteration[30/54] Loss: 1.268, Acc: 0.811, Base Lr: 5.00e-06
2025-12-10 04:42:36,140 DeMo.train INFO: Epoch[8] Iteration[40/54] Loss: 1.267, Acc: 0.825, Base Lr: 5.00e-06
2025-12-10 04:42:38,534 DeMo.train INFO: Epoch[8] Iteration[50/54] Loss: 1.266, Acc: 0.835, Base Lr: 5.00e-06
2025-12-10 04:42:39,371 DeMo.train INFO: Epoch 8 done. Time per batch: 0.273[s] Speed: 234.5[samples/s]
2025-12-10 04:42:39,372 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:39,372 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:39,372 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:42:44,284 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 04:42:44,284 DeMo.train INFO: mAP: 69.1%
2025-12-10 04:42:44,284 DeMo.train INFO: CMC curve, Rank-1  :70.3%
2025-12-10 04:42:44,284 DeMo.train INFO: CMC curve, Rank-5  :80.9%
2025-12-10 04:42:44,284 DeMo.train INFO: CMC curve, Rank-10 :86.1%
2025-12-10 04:42:44,284 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:44,840 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:44,841 DeMo.train INFO: Best mAP: 69.1%
2025-12-10 04:42:44,841 DeMo.train INFO: Best Rank-1: 70.3%
2025-12-10 04:42:44,841 DeMo.train INFO: Best Rank-5: 80.9%
2025-12-10 04:42:44,841 DeMo.train INFO: Best Rank-10: 86.1%
2025-12-10 04:42:44,841 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:48,344 DeMo.train INFO: Epoch[9] Iteration[10/54] Loss: 1.307, Acc: 0.836, Base Lr: 5.00e-06
2025-12-10 04:42:50,809 DeMo.train INFO: Epoch[9] Iteration[20/54] Loss: 1.307, Acc: 0.837, Base Lr: 5.00e-06
2025-12-10 04:42:53,169 DeMo.train INFO: Epoch[9] Iteration[30/54] Loss: 1.288, Acc: 0.854, Base Lr: 5.00e-06
2025-12-10 04:42:55,693 DeMo.train INFO: Epoch[9] Iteration[40/54] Loss: 1.278, Acc: 0.872, Base Lr: 5.00e-06
2025-12-10 04:42:58,075 DeMo.train INFO: Epoch[9] Iteration[50/54] Loss: 1.277, Acc: 0.873, Base Lr: 5.00e-06
2025-12-10 04:42:58,914 DeMo.train INFO: Epoch 9 done. Time per batch: 0.266[s] Speed: 241.0[samples/s]
2025-12-10 04:42:58,915 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:42:58,915 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:42:58,915 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:03,859 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 04:43:03,859 DeMo.train INFO: mAP: 67.7%
2025-12-10 04:43:03,860 DeMo.train INFO: CMC curve, Rank-1  :69.3%
2025-12-10 04:43:03,860 DeMo.train INFO: CMC curve, Rank-5  :80.6%
2025-12-10 04:43:03,860 DeMo.train INFO: CMC curve, Rank-10 :85.2%
2025-12-10 04:43:03,860 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:03,910 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:03,910 DeMo.train INFO: Best mAP: 69.1%
2025-12-10 04:43:03,910 DeMo.train INFO: Best Rank-1: 70.3%
2025-12-10 04:43:03,910 DeMo.train INFO: Best Rank-5: 80.9%
2025-12-10 04:43:03,910 DeMo.train INFO: Best Rank-10: 86.1%
2025-12-10 04:43:03,910 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:08,145 DeMo.train INFO: Epoch[10] Iteration[10/54] Loss: 1.223, Acc: 0.864, Base Lr: 5.00e-06
2025-12-10 04:43:10,522 DeMo.train INFO: Epoch[10] Iteration[20/54] Loss: 1.229, Acc: 0.846, Base Lr: 5.00e-06
2025-12-10 04:43:12,897 DeMo.train INFO: Epoch[10] Iteration[30/54] Loss: 1.235, Acc: 0.860, Base Lr: 5.00e-06
2025-12-10 04:43:15,284 DeMo.train INFO: Epoch[10] Iteration[40/54] Loss: 1.232, Acc: 0.882, Base Lr: 5.00e-06
2025-12-10 04:43:17,692 DeMo.train INFO: Epoch[10] Iteration[50/54] Loss: 1.231, Acc: 0.893, Base Lr: 5.00e-06
2025-12-10 04:43:18,531 DeMo.train INFO: Epoch 10 done. Time per batch: 0.276[s] Speed: 232.0[samples/s]
2025-12-10 04:43:18,532 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:18,533 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:18,533 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:23,425 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 04:43:23,425 DeMo.train INFO: mAP: 68.5%
2025-12-10 04:43:23,425 DeMo.train INFO: CMC curve, Rank-1  :67.6%
2025-12-10 04:43:23,425 DeMo.train INFO: CMC curve, Rank-5  :79.3%
2025-12-10 04:43:23,426 DeMo.train INFO: CMC curve, Rank-10 :86.2%
2025-12-10 04:43:23,426 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:23,474 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:23,475 DeMo.train INFO: Best mAP: 69.1%
2025-12-10 04:43:23,475 DeMo.train INFO: Best Rank-1: 70.3%
2025-12-10 04:43:23,475 DeMo.train INFO: Best Rank-5: 80.9%
2025-12-10 04:43:23,475 DeMo.train INFO: Best Rank-10: 86.1%
2025-12-10 04:43:23,475 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:27,454 DeMo.train INFO: Epoch[11] Iteration[10/54] Loss: 1.227, Acc: 0.850, Base Lr: 5.00e-06
2025-12-10 04:43:29,830 DeMo.train INFO: Epoch[11] Iteration[20/54] Loss: 1.230, Acc: 0.885, Base Lr: 5.00e-06
2025-12-10 04:43:32,208 DeMo.train INFO: Epoch[11] Iteration[30/54] Loss: 1.227, Acc: 0.894, Base Lr: 5.00e-06
2025-12-10 04:43:34,587 DeMo.train INFO: Epoch[11] Iteration[40/54] Loss: 1.229, Acc: 0.891, Base Lr: 5.00e-06
2025-12-10 04:43:36,968 DeMo.train INFO: Epoch[11] Iteration[50/54] Loss: 1.230, Acc: 0.905, Base Lr: 5.00e-06
2025-12-10 04:43:37,797 DeMo.train INFO: Epoch 11 done. Time per batch: 0.270[s] Speed: 236.8[samples/s]
2025-12-10 04:43:37,798 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:37,798 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:37,798 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:43:42,898 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 04:43:42,899 DeMo.train INFO: mAP: 68.2%
2025-12-10 04:43:42,899 DeMo.train INFO: CMC curve, Rank-1  :70.7%
2025-12-10 04:43:42,899 DeMo.train INFO: CMC curve, Rank-5  :81.0%
2025-12-10 04:43:42,899 DeMo.train INFO: CMC curve, Rank-10 :85.4%
2025-12-10 04:43:42,899 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:43,178 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:43,178 DeMo.train INFO: Best mAP: 69.1%
2025-12-10 04:43:43,178 DeMo.train INFO: Best Rank-1: 70.3%
2025-12-10 04:43:43,178 DeMo.train INFO: Best Rank-5: 80.9%
2025-12-10 04:43:43,178 DeMo.train INFO: Best Rank-10: 86.1%
2025-12-10 04:43:43,178 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:47,728 DeMo.train INFO: Epoch[12] Iteration[10/54] Loss: 1.194, Acc: 0.867, Base Lr: 5.00e-06
2025-12-10 04:43:50,262 DeMo.train INFO: Epoch[12] Iteration[20/54] Loss: 1.189, Acc: 0.873, Base Lr: 5.00e-06
2025-12-10 04:43:52,687 DeMo.train INFO: Epoch[12] Iteration[30/54] Loss: 1.195, Acc: 0.893, Base Lr: 5.00e-06
2025-12-10 04:43:55,059 DeMo.train INFO: Epoch[12] Iteration[40/54] Loss: 1.198, Acc: 0.892, Base Lr: 5.00e-06
2025-12-10 04:43:57,426 DeMo.train INFO: Epoch[12] Iteration[50/54] Loss: 1.195, Acc: 0.893, Base Lr: 5.00e-06
2025-12-10 04:43:58,266 DeMo.train INFO: Epoch 12 done. Time per batch: 0.285[s] Speed: 224.8[samples/s]
2025-12-10 04:43:58,267 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:43:58,267 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:43:58,267 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:03,535 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 04:44:03,535 DeMo.train INFO: mAP: 70.0%
2025-12-10 04:44:03,535 DeMo.train INFO: CMC curve, Rank-1  :71.3%
2025-12-10 04:44:03,536 DeMo.train INFO: CMC curve, Rank-5  :82.5%
2025-12-10 04:44:03,536 DeMo.train INFO: CMC curve, Rank-10 :88.5%
2025-12-10 04:44:03,536 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:04,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:04,050 DeMo.train INFO: Best mAP: 70.0%
2025-12-10 04:44:04,050 DeMo.train INFO: Best Rank-1: 71.3%
2025-12-10 04:44:04,050 DeMo.train INFO: Best Rank-5: 82.5%
2025-12-10 04:44:04,050 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:44:04,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:07,361 DeMo.train INFO: Epoch[13] Iteration[10/54] Loss: 1.175, Acc: 0.838, Base Lr: 5.00e-06
2025-12-10 04:44:09,914 DeMo.train INFO: Epoch[13] Iteration[20/54] Loss: 1.184, Acc: 0.876, Base Lr: 5.00e-06
2025-12-10 04:44:12,330 DeMo.train INFO: Epoch[13] Iteration[30/54] Loss: 1.173, Acc: 0.900, Base Lr: 5.00e-06
2025-12-10 04:44:14,702 DeMo.train INFO: Epoch[13] Iteration[40/54] Loss: 1.170, Acc: 0.909, Base Lr: 5.00e-06
2025-12-10 04:44:17,092 DeMo.train INFO: Epoch[13] Iteration[50/54] Loss: 1.171, Acc: 0.924, Base Lr: 5.00e-06
2025-12-10 04:44:17,930 DeMo.train INFO: Epoch 13 done. Time per batch: 0.262[s] Speed: 244.4[samples/s]
2025-12-10 04:44:17,931 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:17,931 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:44:17,931 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:23,351 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 04:44:23,351 DeMo.train INFO: mAP: 68.5%
2025-12-10 04:44:23,351 DeMo.train INFO: CMC curve, Rank-1  :70.0%
2025-12-10 04:44:23,351 DeMo.train INFO: CMC curve, Rank-5  :78.8%
2025-12-10 04:44:23,351 DeMo.train INFO: CMC curve, Rank-10 :84.0%
2025-12-10 04:44:23,351 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:23,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:23,410 DeMo.train INFO: Best mAP: 70.0%
2025-12-10 04:44:23,410 DeMo.train INFO: Best Rank-1: 71.3%
2025-12-10 04:44:23,410 DeMo.train INFO: Best Rank-5: 82.5%
2025-12-10 04:44:23,410 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:44:23,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:27,089 DeMo.train INFO: Epoch[14] Iteration[10/54] Loss: 1.148, Acc: 0.903, Base Lr: 5.00e-06
2025-12-10 04:44:29,479 DeMo.train INFO: Epoch[14] Iteration[20/54] Loss: 1.150, Acc: 0.928, Base Lr: 5.00e-06
2025-12-10 04:44:31,854 DeMo.train INFO: Epoch[14] Iteration[30/54] Loss: 1.153, Acc: 0.930, Base Lr: 5.00e-06
2025-12-10 04:44:34,217 DeMo.train INFO: Epoch[14] Iteration[40/54] Loss: 1.153, Acc: 0.924, Base Lr: 5.00e-06
2025-12-10 04:44:36,594 DeMo.train INFO: Epoch[14] Iteration[50/54] Loss: 1.148, Acc: 0.929, Base Lr: 5.00e-06
2025-12-10 04:44:37,429 DeMo.train INFO: Epoch 14 done. Time per batch: 0.264[s] Speed: 242.0[samples/s]
2025-12-10 04:44:37,430 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:37,430 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:44:37,430 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:44:42,409 DeMo.train INFO: Validation Results - Epoch: 14
2025-12-10 04:44:42,409 DeMo.train INFO: mAP: 65.9%
2025-12-10 04:44:42,409 DeMo.train INFO: CMC curve, Rank-1  :68.3%
2025-12-10 04:44:42,409 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 04:44:42,409 DeMo.train INFO: CMC curve, Rank-10 :82.7%
2025-12-10 04:44:42,409 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:42,459 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:42,459 DeMo.train INFO: Best mAP: 70.0%
2025-12-10 04:44:42,459 DeMo.train INFO: Best Rank-1: 71.3%
2025-12-10 04:44:42,459 DeMo.train INFO: Best Rank-5: 82.5%
2025-12-10 04:44:42,459 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:44:42,459 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:47,078 DeMo.train INFO: Epoch[15] Iteration[10/54] Loss: 1.161, Acc: 0.887, Base Lr: 5.00e-06
2025-12-10 04:44:49,574 DeMo.train INFO: Epoch[15] Iteration[20/54] Loss: 1.150, Acc: 0.903, Base Lr: 5.00e-06
2025-12-10 04:44:51,953 DeMo.train INFO: Epoch[15] Iteration[30/54] Loss: 1.152, Acc: 0.927, Base Lr: 5.00e-06
2025-12-10 04:44:54,328 DeMo.train INFO: Epoch[15] Iteration[40/54] Loss: 1.158, Acc: 0.930, Base Lr: 5.00e-06
2025-12-10 04:44:56,714 DeMo.train INFO: Epoch[15] Iteration[50/54] Loss: 1.151, Acc: 0.932, Base Lr: 5.00e-06
2025-12-10 04:44:57,539 DeMo.train INFO: Epoch 15 done. Time per batch: 0.285[s] Speed: 224.9[samples/s]
2025-12-10 04:44:57,540 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:44:57,540 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:44:57,540 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:02,976 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 04:45:02,977 DeMo.train INFO: mAP: 67.8%
2025-12-10 04:45:02,977 DeMo.train INFO: CMC curve, Rank-1  :69.0%
2025-12-10 04:45:02,977 DeMo.train INFO: CMC curve, Rank-5  :78.1%
2025-12-10 04:45:02,977 DeMo.train INFO: CMC curve, Rank-10 :83.4%
2025-12-10 04:45:02,977 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:03,027 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:03,027 DeMo.train INFO: Best mAP: 70.0%
2025-12-10 04:45:03,027 DeMo.train INFO: Best Rank-1: 71.3%
2025-12-10 04:45:03,027 DeMo.train INFO: Best Rank-5: 82.5%
2025-12-10 04:45:03,027 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:45:03,027 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:06,931 DeMo.train INFO: Epoch[16] Iteration[10/54] Loss: 1.138, Acc: 0.925, Base Lr: 5.00e-06
2025-12-10 04:45:09,299 DeMo.train INFO: Epoch[16] Iteration[20/54] Loss: 1.152, Acc: 0.923, Base Lr: 5.00e-06
2025-12-10 04:45:11,677 DeMo.train INFO: Epoch[16] Iteration[30/54] Loss: 1.148, Acc: 0.912, Base Lr: 5.00e-06
2025-12-10 04:45:14,059 DeMo.train INFO: Epoch[16] Iteration[40/54] Loss: 1.142, Acc: 0.914, Base Lr: 5.00e-06
2025-12-10 04:45:16,453 DeMo.train INFO: Epoch[16] Iteration[50/54] Loss: 1.134, Acc: 0.927, Base Lr: 5.00e-06
2025-12-10 04:45:17,296 DeMo.train INFO: Epoch 16 done. Time per batch: 0.269[s] Speed: 237.7[samples/s]
2025-12-10 04:45:17,297 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:17,297 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:17,297 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:22,574 DeMo.train INFO: Validation Results - Epoch: 16
2025-12-10 04:45:22,574 DeMo.train INFO: mAP: 68.5%
2025-12-10 04:45:22,574 DeMo.train INFO: CMC curve, Rank-1  :67.7%
2025-12-10 04:45:22,574 DeMo.train INFO: CMC curve, Rank-5  :79.8%
2025-12-10 04:45:22,575 DeMo.train INFO: CMC curve, Rank-10 :85.6%
2025-12-10 04:45:22,575 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:22,623 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:22,624 DeMo.train INFO: Best mAP: 70.0%
2025-12-10 04:45:22,624 DeMo.train INFO: Best Rank-1: 71.3%
2025-12-10 04:45:22,624 DeMo.train INFO: Best Rank-5: 82.5%
2025-12-10 04:45:22,624 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:45:22,624 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:26,544 DeMo.train INFO: Epoch[17] Iteration[10/54] Loss: 1.142, Acc: 0.884, Base Lr: 5.00e-06
2025-12-10 04:45:28,907 DeMo.train INFO: Epoch[17] Iteration[20/54] Loss: 1.135, Acc: 0.884, Base Lr: 5.00e-06
2025-12-10 04:45:31,271 DeMo.train INFO: Epoch[17] Iteration[30/54] Loss: 1.130, Acc: 0.911, Base Lr: 5.00e-06
2025-12-10 04:45:33,661 DeMo.train INFO: Epoch[17] Iteration[40/54] Loss: 1.122, Acc: 0.923, Base Lr: 5.00e-06
2025-12-10 04:45:36,048 DeMo.train INFO: Epoch[17] Iteration[50/54] Loss: 1.117, Acc: 0.935, Base Lr: 5.00e-06
2025-12-10 04:45:36,900 DeMo.train INFO: Epoch 17 done. Time per batch: 0.269[s] Speed: 237.6[samples/s]
2025-12-10 04:45:36,901 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:36,901 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:36,901 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:45:42,588 DeMo.train INFO: Validation Results - Epoch: 17
2025-12-10 04:45:42,588 DeMo.train INFO: mAP: 70.7%
2025-12-10 04:45:42,589 DeMo.train INFO: CMC curve, Rank-1  :72.2%
2025-12-10 04:45:42,589 DeMo.train INFO: CMC curve, Rank-5  :82.7%
2025-12-10 04:45:42,589 DeMo.train INFO: CMC curve, Rank-10 :87.0%
2025-12-10 04:45:42,589 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:43,115 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:43,115 DeMo.train INFO: Best mAP: 70.7%
2025-12-10 04:45:43,115 DeMo.train INFO: Best Rank-1: 72.2%
2025-12-10 04:45:43,115 DeMo.train INFO: Best Rank-5: 82.7%
2025-12-10 04:45:43,115 DeMo.train INFO: Best Rank-10: 87.0%
2025-12-10 04:45:43,116 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:46,950 DeMo.train INFO: Epoch[18] Iteration[10/54] Loss: 1.091, Acc: 0.923, Base Lr: 5.00e-06
2025-12-10 04:45:50,237 DeMo.train INFO: Epoch[18] Iteration[20/54] Loss: 1.103, Acc: 0.916, Base Lr: 5.00e-06
2025-12-10 04:45:52,631 DeMo.train INFO: Epoch[18] Iteration[30/54] Loss: 1.101, Acc: 0.923, Base Lr: 5.00e-06
2025-12-10 04:45:55,043 DeMo.train INFO: Epoch[18] Iteration[40/54] Loss: 1.099, Acc: 0.932, Base Lr: 5.00e-06
2025-12-10 04:45:57,446 DeMo.train INFO: Epoch[18] Iteration[50/54] Loss: 1.098, Acc: 0.930, Base Lr: 5.00e-06
2025-12-10 04:45:58,293 DeMo.train INFO: Epoch 18 done. Time per batch: 0.286[s] Speed: 223.5[samples/s]
2025-12-10 04:45:58,295 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:45:58,295 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:45:58,295 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:03,474 DeMo.train INFO: Validation Results - Epoch: 18
2025-12-10 04:46:03,474 DeMo.train INFO: mAP: 66.9%
2025-12-10 04:46:03,474 DeMo.train INFO: CMC curve, Rank-1  :67.5%
2025-12-10 04:46:03,474 DeMo.train INFO: CMC curve, Rank-5  :78.1%
2025-12-10 04:46:03,474 DeMo.train INFO: CMC curve, Rank-10 :83.7%
2025-12-10 04:46:03,474 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:04,040 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:04,040 DeMo.train INFO: Best mAP: 70.7%
2025-12-10 04:46:04,040 DeMo.train INFO: Best Rank-1: 72.2%
2025-12-10 04:46:04,041 DeMo.train INFO: Best Rank-5: 82.7%
2025-12-10 04:46:04,041 DeMo.train INFO: Best Rank-10: 87.0%
2025-12-10 04:46:04,041 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:08,773 DeMo.train INFO: Epoch[19] Iteration[10/54] Loss: 1.093, Acc: 0.891, Base Lr: 5.00e-06
2025-12-10 04:46:11,170 DeMo.train INFO: Epoch[19] Iteration[20/54] Loss: 1.095, Acc: 0.907, Base Lr: 5.00e-06
2025-12-10 04:46:13,538 DeMo.train INFO: Epoch[19] Iteration[30/54] Loss: 1.089, Acc: 0.917, Base Lr: 5.00e-06
2025-12-10 04:46:15,913 DeMo.train INFO: Epoch[19] Iteration[40/54] Loss: 1.087, Acc: 0.923, Base Lr: 5.00e-06
2025-12-10 04:46:18,300 DeMo.train INFO: Epoch[19] Iteration[50/54] Loss: 1.085, Acc: 0.928, Base Lr: 5.00e-06
2025-12-10 04:46:19,111 DeMo.train INFO: Epoch 19 done. Time per batch: 0.284[s] Speed: 225.1[samples/s]
2025-12-10 04:46:19,112 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:19,112 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:19,112 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:24,149 DeMo.train INFO: Validation Results - Epoch: 19
2025-12-10 04:46:24,149 DeMo.train INFO: mAP: 71.0%
2025-12-10 04:46:24,149 DeMo.train INFO: CMC curve, Rank-1  :73.1%
2025-12-10 04:46:24,149 DeMo.train INFO: CMC curve, Rank-5  :82.8%
2025-12-10 04:46:24,150 DeMo.train INFO: CMC curve, Rank-10 :88.5%
2025-12-10 04:46:24,150 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:24,653 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:24,653 DeMo.train INFO: Best mAP: 71.0%
2025-12-10 04:46:24,653 DeMo.train INFO: Best Rank-1: 73.1%
2025-12-10 04:46:24,653 DeMo.train INFO: Best Rank-5: 82.8%
2025-12-10 04:46:24,653 DeMo.train INFO: Best Rank-10: 88.5%
2025-12-10 04:46:24,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:28,263 DeMo.train INFO: Epoch[20] Iteration[10/54] Loss: 1.084, Acc: 0.905, Base Lr: 5.00e-06
2025-12-10 04:46:30,650 DeMo.train INFO: Epoch[20] Iteration[20/54] Loss: 1.082, Acc: 0.918, Base Lr: 5.00e-06
2025-12-10 04:46:33,027 DeMo.train INFO: Epoch[20] Iteration[30/54] Loss: 1.079, Acc: 0.928, Base Lr: 5.00e-06
2025-12-10 04:46:35,405 DeMo.train INFO: Epoch[20] Iteration[40/54] Loss: 1.075, Acc: 0.930, Base Lr: 5.00e-06
2025-12-10 04:46:37,817 DeMo.train INFO: Epoch[20] Iteration[50/54] Loss: 1.077, Acc: 0.934, Base Lr: 5.00e-06
2025-12-10 04:46:38,647 DeMo.train INFO: Epoch 20 done. Time per batch: 0.264[s] Speed: 242.4[samples/s]
2025-12-10 04:46:38,648 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:38,648 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:38,648 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:46:44,031 DeMo.train INFO: Validation Results - Epoch: 20
2025-12-10 04:46:44,031 DeMo.train INFO: mAP: 71.7%
2025-12-10 04:46:44,031 DeMo.train INFO: CMC curve, Rank-1  :74.4%
2025-12-10 04:46:44,031 DeMo.train INFO: CMC curve, Rank-5  :83.4%
2025-12-10 04:46:44,032 DeMo.train INFO: CMC curve, Rank-10 :89.4%
2025-12-10 04:46:44,032 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:44,538 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:44,539 DeMo.train INFO: Best mAP: 71.7%
2025-12-10 04:46:44,539 DeMo.train INFO: Best Rank-1: 74.4%
2025-12-10 04:46:44,539 DeMo.train INFO: Best Rank-5: 83.4%
2025-12-10 04:46:44,539 DeMo.train INFO: Best Rank-10: 89.4%
2025-12-10 04:46:44,539 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:47,978 DeMo.train INFO: Epoch[21] Iteration[10/54] Loss: 1.071, Acc: 0.930, Base Lr: 5.00e-06
2025-12-10 04:46:50,476 DeMo.train INFO: Epoch[21] Iteration[20/54] Loss: 1.067, Acc: 0.924, Base Lr: 5.00e-06
2025-12-10 04:46:52,841 DeMo.train INFO: Epoch[21] Iteration[30/54] Loss: 1.062, Acc: 0.935, Base Lr: 5.00e-06
2025-12-10 04:46:55,219 DeMo.train INFO: Epoch[21] Iteration[40/54] Loss: 1.061, Acc: 0.938, Base Lr: 5.00e-06
2025-12-10 04:46:57,609 DeMo.train INFO: Epoch[21] Iteration[50/54] Loss: 1.059, Acc: 0.935, Base Lr: 5.00e-06
2025-12-10 04:46:58,437 DeMo.train INFO: Epoch 21 done. Time per batch: 0.262[s] Speed: 244.1[samples/s]
2025-12-10 04:46:58,438 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:46:58,438 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 04:46:58,438 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 04:47:03,460 DeMo.train INFO: Validation Results - Epoch: 21
2025-12-10 04:47:03,460 DeMo.train INFO: mAP: 70.0%
2025-12-10 04:47:03,460 DeMo.train INFO: CMC curve, Rank-1  :71.9%
2025-12-10 04:47:03,460 DeMo.train INFO: CMC curve, Rank-5  :81.6%
2025-12-10 04:47:03,460 DeMo.train INFO: CMC curve, Rank-10 :86.4%
2025-12-10 04:47:03,460 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:03,509 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:03,509 DeMo.train INFO: Best mAP: 71.7%
2025-12-10 04:47:03,509 DeMo.train INFO: Best Rank-1: 74.4%
2025-12-10 04:47:03,509 DeMo.train INFO: Best Rank-5: 83.4%
2025-12-10 04:47:03,509 DeMo.train INFO: Best Rank-10: 89.4%
2025-12-10 04:47:03,509 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 04:47:07,534 DeMo.train INFO: Epoch[22] Iteration[10/54] Loss: 1.054, Acc: 0.889, Base Lr: 5.00e-06
2025-12-10 04:47:09,907 DeMo.train INFO: Epoch[22] Iteration[20/54] Loss: 1.048, Acc: 0.926, Base Lr: 5.00e-06
2025-12-10 04:47:12,279 DeMo.train INFO: Epoch[22] Iteration[30/54] Loss: 1.046, Acc: 0.929, Base Lr: 5.00e-06
2025-12-10 04:47:14,666 DeMo.train INFO: Epoch[22] Iteration[40/54] Loss: 1.043, Acc: 0.935, Base Lr: 5.00e-06
2025-12-10 04:47:17,042 DeMo.train INFO: Epoch[22] Iteration[50/54] Loss: 1.041, Acc: 0.946, Base Lr: 5.00e-06

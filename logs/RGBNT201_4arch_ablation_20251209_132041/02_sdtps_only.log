2025-12-09 13:20:45,041 DeMo INFO: Saving model in the path :..
2025-12-09 13:20:45,042 DeMo INFO: Namespace(config_file='configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml', exp_name=None, fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'True', 'MODEL.USE_DGAF', 'False', 'MODEL.GLOBAL_LOCAL', 'False', 'MODEL.SDTPS_CROSS_ATTN_TYPE', 'attention', 'MODEL.SDTPS_CROSS_ATTN_HEADS', '4'])
2025-12-09 13:20:45,042 DeMo INFO: Loaded configuration file configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml
2025-12-09 13:20:45,046 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention（推荐）
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用（原 MLP predictor 权重）
  SDTPS_AGGR_RATIO: 0.5    # 已不使用（原 TokenAggregation）
  SDTPS_LOSS_WEIGHT: 2.0   # SDTPS 分支的损失权重
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 8
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# SDTPS + DGAF Ablation Config
# ============================================================================
# - SACR: disabled
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10
# - TF32: enabled in train_net.py
# ============================================================================

2025-12-09 13:20:45,046 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 8
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT201
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ADAPTER: False
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: False
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: True
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGBNT201 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   171 |     3951 |         4
  query    |    30 |      836 |         2
  gallery  |    30 |      836 |         2
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:16 width: 8
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 4
===========Building DeMo===========
2025-12-09 13:20:56,468 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (sdtps): MultiModalSDTPS(
    (rgb_sparse): TokenSparse()
    (nir_sparse): TokenSparse()
    (tir_sparse): TokenSparse()
    (rgb_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (rgb_cross_nir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (rgb_cross_tir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_cross_rgb): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_cross_tir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_cross_rgb): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_cross_nir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
  )
  (classifier_sdtps): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck_sdtps): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-09 13:20:56,469 DeMo INFO: number of parameters:92.980305
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, bottleneck_sdtps, classifier, classifier_sdtps
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The out_proj here is called by the nn.MultiheadAttention, which has been calculated in th .forward(), so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For the bottleneck or classifier, it is not calculated during inference, so just ignore it.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:20:59,527 DeMo INFO: number of GFLOPs: 34.58413796399999
using soft triplet loss for training
label smooth on, numclasses: 171
2025-12-09 13:20:59,542 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-09 13:21:04,658 DeMo.train INFO: Epoch[1] Iteration[10/54] Loss: 5.813, Acc: 0.008, Base Lr: 5.00e-06
2025-12-09 13:21:07,109 DeMo.train INFO: Epoch[1] Iteration[20/54] Loss: 5.063, Acc: 0.012, Base Lr: 5.00e-06
2025-12-09 13:21:09,549 DeMo.train INFO: Epoch[1] Iteration[30/54] Loss: 4.755, Acc: 0.014, Base Lr: 5.00e-06
2025-12-09 13:21:11,987 DeMo.train INFO: Epoch[1] Iteration[40/54] Loss: 4.566, Acc: 0.011, Base Lr: 5.00e-06
2025-12-09 13:21:14,404 DeMo.train INFO: Epoch[1] Iteration[50/54] Loss: 4.439, Acc: 0.012, Base Lr: 5.00e-06
2025-12-09 13:21:15,257 DeMo.train INFO: Epoch 1 done. Time per batch: 0.296[s] Speed: 216.1[samples/s]
2025-12-09 13:21:15,258 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:21:15,259 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:21:15,259 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:21:22,131 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-09 13:21:22,132 DeMo.train INFO: mAP: 20.6%
2025-12-09 13:21:22,134 DeMo.train INFO: CMC curve, Rank-1  :18.8%
2025-12-09 13:21:22,135 DeMo.train INFO: CMC curve, Rank-5  :33.5%
2025-12-09 13:21:22,135 DeMo.train INFO: CMC curve, Rank-10 :41.7%
2025-12-09 13:21:22,136 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:21:22,138 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:21:22,138 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:21:22,140 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:21:31,229 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-09 13:21:31,230 DeMo.train INFO: mAP: 20.6%
2025-12-09 13:21:31,231 DeMo.train INFO: CMC curve, Rank-1  :18.8%
2025-12-09 13:21:31,232 DeMo.train INFO: CMC curve, Rank-5  :33.5%
2025-12-09 13:21:31,233 DeMo.train INFO: CMC curve, Rank-10 :41.7%
2025-12-09 13:21:31,235 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:21:31,238 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:21:31,239 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-09 13:21:31,240 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:21:40,628 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-09 13:21:40,629 DeMo.train INFO: mAP: 20.6%
2025-12-09 13:21:40,630 DeMo.train INFO: CMC curve, Rank-1  :18.8%
2025-12-09 13:21:40,630 DeMo.train INFO: CMC curve, Rank-5  :33.5%
2025-12-09 13:21:40,632 DeMo.train INFO: CMC curve, Rank-10 :41.7%
2025-12-09 13:21:40,632 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:22:28,672 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:22:28,673 DeMo.train INFO: Best mAP: 20.6%
2025-12-09 13:22:28,674 DeMo.train INFO: Best Rank-1: 18.8%
2025-12-09 13:22:28,675 DeMo.train INFO: Best Rank-5: 33.5%
2025-12-09 13:22:28,675 DeMo.train INFO: Best Rank-10: 41.7%
2025-12-09 13:22:28,676 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:22:34,243 DeMo.train INFO: Epoch[2] Iteration[10/54] Loss: 3.744, Acc: 0.052, Base Lr: 5.00e-06
2025-12-09 13:22:36,717 DeMo.train INFO: Epoch[2] Iteration[20/54] Loss: 3.702, Acc: 0.050, Base Lr: 5.00e-06
2025-12-09 13:22:39,156 DeMo.train INFO: Epoch[2] Iteration[30/54] Loss: 3.645, Acc: 0.045, Base Lr: 5.00e-06
2025-12-09 13:22:41,590 DeMo.train INFO: Epoch[2] Iteration[40/54] Loss: 3.615, Acc: 0.047, Base Lr: 5.00e-06
2025-12-09 13:22:44,004 DeMo.train INFO: Epoch[2] Iteration[50/54] Loss: 3.555, Acc: 0.053, Base Lr: 5.00e-06
2025-12-09 13:22:44,829 DeMo.train INFO: Epoch 2 done. Time per batch: 0.305[s] Speed: 210.0[samples/s]
2025-12-09 13:22:44,830 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:22:44,832 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:22:44,832 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:22:54,250 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-09 13:22:54,252 DeMo.train INFO: mAP: 43.0%
2025-12-09 13:22:54,253 DeMo.train INFO: CMC curve, Rank-1  :42.8%
2025-12-09 13:22:54,254 DeMo.train INFO: CMC curve, Rank-5  :59.4%
2025-12-09 13:22:54,255 DeMo.train INFO: CMC curve, Rank-10 :67.9%
2025-12-09 13:22:54,256 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:22:54,309 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:22:54,310 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:22:54,312 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:23:08,611 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-09 13:23:08,614 DeMo.train INFO: mAP: 43.0%
2025-12-09 13:23:08,614 DeMo.train INFO: CMC curve, Rank-1  :42.8%
2025-12-09 13:23:08,615 DeMo.train INFO: CMC curve, Rank-5  :59.4%
2025-12-09 13:23:08,615 DeMo.train INFO: CMC curve, Rank-10 :67.9%
2025-12-09 13:23:08,616 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:23:08,637 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:23:08,638 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-09 13:23:08,639 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:23:18,025 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-09 13:23:18,025 DeMo.train INFO: mAP: 43.0%
2025-12-09 13:23:18,026 DeMo.train INFO: CMC curve, Rank-1  :42.8%
2025-12-09 13:23:18,026 DeMo.train INFO: CMC curve, Rank-5  :59.4%
2025-12-09 13:23:18,026 DeMo.train INFO: CMC curve, Rank-10 :67.9%
2025-12-09 13:23:18,026 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:02,018 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:02,019 DeMo.train INFO: Best mAP: 43.0%
2025-12-09 13:24:02,021 DeMo.train INFO: Best Rank-1: 42.8%
2025-12-09 13:24:02,022 DeMo.train INFO: Best Rank-5: 59.4%
2025-12-09 13:24:02,022 DeMo.train INFO: Best Rank-10: 67.9%
2025-12-09 13:24:02,023 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:11,953 DeMo.train INFO: Epoch[3] Iteration[10/54] Loss: 3.133, Acc: 0.130, Base Lr: 5.00e-06
2025-12-09 13:24:17,496 DeMo.train INFO: Epoch[3] Iteration[20/54] Loss: 3.129, Acc: 0.125, Base Lr: 5.00e-06
2025-12-09 13:24:23,250 DeMo.train INFO: Epoch[3] Iteration[30/54] Loss: 3.063, Acc: 0.142, Base Lr: 5.00e-06
2025-12-09 13:24:25,721 DeMo.train INFO: Epoch[3] Iteration[40/54] Loss: 3.035, Acc: 0.159, Base Lr: 5.00e-06
2025-12-09 13:24:28,839 DeMo.train INFO: Epoch[3] Iteration[50/54] Loss: 3.007, Acc: 0.166, Base Lr: 5.00e-06
2025-12-09 13:24:29,672 DeMo.train INFO: Epoch 3 done. Time per batch: 0.522[s] Speed: 122.7[samples/s]
2025-12-09 13:24:29,674 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:29,674 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:24:29,674 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:24:34,819 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-09 13:24:34,819 DeMo.train INFO: mAP: 53.9%
2025-12-09 13:24:34,819 DeMo.train INFO: CMC curve, Rank-1  :52.9%
2025-12-09 13:24:34,819 DeMo.train INFO: CMC curve, Rank-5  :67.9%
2025-12-09 13:24:34,820 DeMo.train INFO: CMC curve, Rank-10 :75.1%
2025-12-09 13:24:34,820 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:34,888 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:34,888 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:24:34,888 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:24:40,050 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-09 13:24:40,050 DeMo.train INFO: mAP: 53.9%
2025-12-09 13:24:40,050 DeMo.train INFO: CMC curve, Rank-1  :52.9%
2025-12-09 13:24:40,050 DeMo.train INFO: CMC curve, Rank-5  :67.9%
2025-12-09 13:24:40,051 DeMo.train INFO: CMC curve, Rank-10 :75.1%
2025-12-09 13:24:40,051 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:41,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:24:41,110 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-09 13:24:41,110 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:24:47,060 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-09 13:24:47,060 DeMo.train INFO: mAP: 53.9%
2025-12-09 13:24:47,061 DeMo.train INFO: CMC curve, Rank-1  :52.9%
2025-12-09 13:24:47,062 DeMo.train INFO: CMC curve, Rank-5  :67.9%
2025-12-09 13:24:47,062 DeMo.train INFO: CMC curve, Rank-10 :75.1%
2025-12-09 13:24:47,062 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:25:48,277 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:25:48,279 DeMo.train INFO: Best mAP: 53.9%
2025-12-09 13:25:48,279 DeMo.train INFO: Best Rank-1: 52.9%
2025-12-09 13:25:48,280 DeMo.train INFO: Best Rank-5: 67.9%
2025-12-09 13:25:48,282 DeMo.train INFO: Best Rank-10: 75.1%
2025-12-09 13:25:48,283 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:25:56,734 DeMo.train INFO: Epoch[4] Iteration[10/54] Loss: 2.868, Acc: 0.369, Base Lr: 5.00e-06
2025-12-09 13:25:59,196 DeMo.train INFO: Epoch[4] Iteration[20/54] Loss: 2.783, Acc: 0.403, Base Lr: 5.00e-06
2025-12-09 13:26:01,658 DeMo.train INFO: Epoch[4] Iteration[30/54] Loss: 2.771, Acc: 0.382, Base Lr: 5.00e-06
2025-12-09 13:26:04,102 DeMo.train INFO: Epoch[4] Iteration[40/54] Loss: 2.770, Acc: 0.369, Base Lr: 5.00e-06
2025-12-09 13:26:06,551 DeMo.train INFO: Epoch[4] Iteration[50/54] Loss: 2.754, Acc: 0.378, Base Lr: 5.00e-06
2025-12-09 13:26:07,417 DeMo.train INFO: Epoch 4 done. Time per batch: 0.361[s] Speed: 177.3[samples/s]
2025-12-09 13:26:07,418 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:26:07,419 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:26:07,420 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:26:16,942 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-09 13:26:16,943 DeMo.train INFO: mAP: 60.5%
2025-12-09 13:26:16,944 DeMo.train INFO: CMC curve, Rank-1  :62.7%
2025-12-09 13:26:16,945 DeMo.train INFO: CMC curve, Rank-5  :75.1%
2025-12-09 13:26:16,946 DeMo.train INFO: CMC curve, Rank-10 :81.2%
2025-12-09 13:26:16,946 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:26:16,999 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:26:17,000 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:26:17,000 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:26:30,789 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-09 13:26:30,789 DeMo.train INFO: mAP: 60.5%
2025-12-09 13:26:30,789 DeMo.train INFO: CMC curve, Rank-1  :62.7%
2025-12-09 13:26:30,790 DeMo.train INFO: CMC curve, Rank-5  :75.1%
2025-12-09 13:26:30,791 DeMo.train INFO: CMC curve, Rank-10 :81.2%
2025-12-09 13:26:30,792 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:26:30,796 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:26:30,796 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-09 13:26:30,798 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:26:42,857 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-09 13:26:42,857 DeMo.train INFO: mAP: 60.5%
2025-12-09 13:26:42,857 DeMo.train INFO: CMC curve, Rank-1  :62.7%
2025-12-09 13:26:42,857 DeMo.train INFO: CMC curve, Rank-5  :75.1%
2025-12-09 13:26:42,857 DeMo.train INFO: CMC curve, Rank-10 :81.2%
2025-12-09 13:26:42,857 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:27:34,690 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:27:34,691 DeMo.train INFO: Best mAP: 60.5%
2025-12-09 13:27:34,693 DeMo.train INFO: Best Rank-1: 62.7%
2025-12-09 13:27:34,694 DeMo.train INFO: Best Rank-5: 75.1%
2025-12-09 13:27:34,694 DeMo.train INFO: Best Rank-10: 81.2%
2025-12-09 13:27:34,694 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:27:45,979 DeMo.train INFO: Epoch[5] Iteration[10/54] Loss: 2.731, Acc: 0.498, Base Lr: 5.00e-06
2025-12-09 13:27:50,363 DeMo.train INFO: Epoch[5] Iteration[20/54] Loss: 2.754, Acc: 0.509, Base Lr: 5.00e-06
2025-12-09 13:27:52,903 DeMo.train INFO: Epoch[5] Iteration[30/54] Loss: 2.736, Acc: 0.548, Base Lr: 5.00e-06
2025-12-09 13:27:55,357 DeMo.train INFO: Epoch[5] Iteration[40/54] Loss: 2.728, Acc: 0.563, Base Lr: 5.00e-06
2025-12-09 13:27:57,783 DeMo.train INFO: Epoch[5] Iteration[50/54] Loss: 2.706, Acc: 0.583, Base Lr: 5.00e-06
2025-12-09 13:27:58,635 DeMo.train INFO: Epoch 5 done. Time per batch: 0.452[s] Speed: 141.7[samples/s]
2025-12-09 13:27:58,636 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:27:58,636 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:27:58,636 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:28:04,252 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-09 13:28:04,252 DeMo.train INFO: mAP: 64.2%
2025-12-09 13:28:04,252 DeMo.train INFO: CMC curve, Rank-1  :65.6%
2025-12-09 13:28:04,252 DeMo.train INFO: CMC curve, Rank-5  :80.5%
2025-12-09 13:28:04,252 DeMo.train INFO: CMC curve, Rank-10 :87.8%
2025-12-09 13:28:04,252 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:28:04,305 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:28:04,306 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:28:04,306 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:28:09,147 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-09 13:28:09,147 DeMo.train INFO: mAP: 64.2%
2025-12-09 13:28:09,147 DeMo.train INFO: CMC curve, Rank-1  :65.6%
2025-12-09 13:28:09,147 DeMo.train INFO: CMC curve, Rank-5  :80.5%
2025-12-09 13:28:09,148 DeMo.train INFO: CMC curve, Rank-10 :87.8%
2025-12-09 13:28:09,148 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:28:09,151 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:28:09,151 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-09 13:28:09,151 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:28:18,365 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-09 13:28:18,365 DeMo.train INFO: mAP: 64.2%
2025-12-09 13:28:18,366 DeMo.train INFO: CMC curve, Rank-1  :65.6%
2025-12-09 13:28:18,367 DeMo.train INFO: CMC curve, Rank-5  :80.5%
2025-12-09 13:28:18,367 DeMo.train INFO: CMC curve, Rank-10 :87.8%
2025-12-09 13:28:18,369 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:14,047 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:14,048 DeMo.train INFO: Best mAP: 64.2%
2025-12-09 13:29:14,049 DeMo.train INFO: Best Rank-1: 65.6%
2025-12-09 13:29:14,051 DeMo.train INFO: Best Rank-5: 80.5%
2025-12-09 13:29:14,052 DeMo.train INFO: Best Rank-10: 87.8%
2025-12-09 13:29:14,052 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:21,507 DeMo.train INFO: Epoch[6] Iteration[10/54] Loss: 2.591, Acc: 0.689, Base Lr: 5.00e-06
2025-12-09 13:29:23,959 DeMo.train INFO: Epoch[6] Iteration[20/54] Loss: 2.597, Acc: 0.684, Base Lr: 5.00e-06
2025-12-09 13:29:26,402 DeMo.train INFO: Epoch[6] Iteration[30/54] Loss: 2.601, Acc: 0.698, Base Lr: 5.00e-06
2025-12-09 13:29:28,861 DeMo.train INFO: Epoch[6] Iteration[40/54] Loss: 2.596, Acc: 0.693, Base Lr: 5.00e-06
2025-12-09 13:29:31,316 DeMo.train INFO: Epoch[6] Iteration[50/54] Loss: 2.588, Acc: 0.712, Base Lr: 5.00e-06
2025-12-09 13:29:32,181 DeMo.train INFO: Epoch 6 done. Time per batch: 0.342[s] Speed: 187.1[samples/s]
2025-12-09 13:29:32,183 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:32,183 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:29:32,184 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:29:41,224 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-09 13:29:41,224 DeMo.train INFO: mAP: 63.9%
2025-12-09 13:29:41,224 DeMo.train INFO: CMC curve, Rank-1  :63.6%
2025-12-09 13:29:41,224 DeMo.train INFO: CMC curve, Rank-5  :77.3%
2025-12-09 13:29:41,224 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-09 13:29:41,224 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:41,298 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:41,298 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:29:41,298 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:29:46,409 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-09 13:29:46,410 DeMo.train INFO: mAP: 63.9%
2025-12-09 13:29:46,410 DeMo.train INFO: CMC curve, Rank-1  :63.6%
2025-12-09 13:29:46,410 DeMo.train INFO: CMC curve, Rank-5  :77.3%
2025-12-09 13:29:46,410 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-09 13:29:46,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:46,429 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:46,429 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-09 13:29:46,429 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:29:51,221 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-09 13:29:51,221 DeMo.train INFO: mAP: 63.9%
2025-12-09 13:29:51,221 DeMo.train INFO: CMC curve, Rank-1  :63.6%
2025-12-09 13:29:51,222 DeMo.train INFO: CMC curve, Rank-5  :77.3%
2025-12-09 13:29:51,222 DeMo.train INFO: CMC curve, Rank-10 :84.2%
2025-12-09 13:29:51,222 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:51,224 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:51,224 DeMo.train INFO: Best mAP: 64.2%
2025-12-09 13:29:51,224 DeMo.train INFO: Best Rank-1: 65.6%
2025-12-09 13:29:51,225 DeMo.train INFO: Best Rank-5: 80.5%
2025-12-09 13:29:51,225 DeMo.train INFO: Best Rank-10: 87.8%
2025-12-09 13:29:51,225 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:29:55,443 DeMo.train INFO: Epoch[7] Iteration[10/54] Loss: 2.550, Acc: 0.775, Base Lr: 5.00e-06
2025-12-09 13:29:57,917 DeMo.train INFO: Epoch[7] Iteration[20/54] Loss: 2.557, Acc: 0.785, Base Lr: 5.00e-06
2025-12-09 13:30:00,367 DeMo.train INFO: Epoch[7] Iteration[30/54] Loss: 2.577, Acc: 0.794, Base Lr: 5.00e-06
2025-12-09 13:30:02,834 DeMo.train INFO: Epoch[7] Iteration[40/54] Loss: 2.596, Acc: 0.801, Base Lr: 5.00e-06
2025-12-09 13:30:05,509 DeMo.train INFO: Epoch[7] Iteration[50/54] Loss: 2.590, Acc: 0.802, Base Lr: 5.00e-06
2025-12-09 13:30:06,390 DeMo.train INFO: Epoch 7 done. Time per batch: 0.286[s] Speed: 223.7[samples/s]
2025-12-09 13:30:06,392 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:30:06,393 DeMo.train INFO: Current is the ori feature testing!
2025-12-09 13:30:06,394 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-09 13:30:15,589 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-09 13:30:15,590 DeMo.train INFO: mAP: 65.2%
2025-12-09 13:30:15,591 DeMo.train INFO: CMC curve, Rank-1  :66.6%
2025-12-09 13:30:15,592 DeMo.train INFO: CMC curve, Rank-5  :78.6%
2025-12-09 13:30:15,592 DeMo.train INFO: CMC curve, Rank-10 :83.7%
2025-12-09 13:30:15,594 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:30:16,953 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-09 13:30:16,954 DeMo.train INFO: Current is the moe feature testing!
2025-12-09 13:30:16,955 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

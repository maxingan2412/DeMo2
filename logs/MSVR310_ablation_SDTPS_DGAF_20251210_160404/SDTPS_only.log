2025-12-10 16:04:08,528 DeMo INFO: Saving model in the path :..
2025-12-10 16:04:08,528 DeMo INFO: Namespace(config_file='configs/MSVR310/DeMo_SDTPS_DGAF_ablation.yml', exp_name='ablation_SDTPS_only', fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'True', 'MODEL.USE_DGAF', 'False'])
2025-12-10 16:04:08,528 DeMo INFO: Loaded configuration file configs/MSVR310/DeMo_SDTPS_DGAF_ablation.yml
2025-12-10 16:04:08,528 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用
  SDTPS_AGGR_RATIO: 0.5    # 已不使用
  SDTPS_LOSS_WEIGHT: 2.0
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 128, 256 ]
  SIZE_TEST: [ 128, 256 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('MSVR310')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 64
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# MSVR310 SDTPS + DGAF Ablation Config
# ============================================================================
# - Based on original DeMo.yml for MSVR310
# - SACR: disabled
# - HDM/ATM: disabled, DIRECT: 1
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10 (same as original)
# ============================================================================

2025-12-10 16:04:08,529 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: MSVR310
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ADAPTER: False
  ARCH: DeMo
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_LOSS_WEIGHT: 1.0
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  FUSED_LOSS_WEIGHT: 0.5
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SHARE_CROSS_ATTN: False
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: False
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: True
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 64
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGB_IR loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   155 |     1032 |         8
  query    |    52 |      591 |         8
  gallery  |   155 |     1055 |         8
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:8 width: 16
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 8
===========Building DeMo===========
2025-12-10 16:04:19,842 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (sdtps): MultiModalSDTPS(
    (rgb_sparse): TokenSparse(
      (modal_weight_mlp): Sequential(
        (0): Linear(in_features=1536, out_features=256, bias=True)
        (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (2): GELU(approximate='none')
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=256, out_features=64, bias=True)
        (5): GELU(approximate='none')
        (6): Linear(in_features=64, out_features=3, bias=True)
      )
    )
    (nir_sparse): TokenSparse(
      (modal_weight_mlp): Sequential(
        (0): Linear(in_features=1536, out_features=256, bias=True)
        (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (2): GELU(approximate='none')
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=256, out_features=64, bias=True)
        (5): GELU(approximate='none')
        (6): Linear(in_features=64, out_features=3, bias=True)
      )
    )
    (tir_sparse): TokenSparse(
      (modal_weight_mlp): Sequential(
        (0): Linear(in_features=1536, out_features=256, bias=True)
        (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (2): GELU(approximate='none')
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=256, out_features=64, bias=True)
        (5): GELU(approximate='none')
        (6): Linear(in_features=64, out_features=3, bias=True)
      )
    )
    (rgb_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (rgb_cross_nir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (rgb_cross_tir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_cross_rgb): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (nir_cross_tir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_self_attn): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_cross_rgb): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
    (tir_cross_nir): CrossModalAttention(
      (q_proj): Linear(in_features=512, out_features=512, bias=True)
      (k_proj): Linear(in_features=512, out_features=512, bias=True)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
  )
  (classifier_sdtps): Linear(in_features=1536, out_features=155, bias=False)
  (bottleneck_sdtps): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier): Linear(in_features=1536, out_features=155, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-10 16:04:19,844 DeMo INFO: number of parameters:94.166025
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
Unsupported operator aten::std encountered 9 time(s)
Unsupported operator aten::quantile encountered 3 time(s)
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, bottleneck_sdtps, classifier, classifier_sdtps, nir_reduce, nir_reduce.0, nir_reduce.1, nir_reduce.2, pool, rgb_reduce, rgb_reduce.0, rgb_reduce.1, rgb_reduce.2, tir_reduce, tir_reduce.0, tir_reduce.1, tir_reduce.2
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Note: out_proj is calculated in MultiheadAttention.forward(), ignore it
Note: bottleneck/classifier not used in inference, ignore it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:22,443 DeMo INFO: number of GFLOPs: 34.58373971099999
using soft triplet loss for training
label smooth on, numclasses: 155
2025-12-10 16:04:22,463 DeMo INFO: TensorBoard logging to: logs/tensorboard/ablation_SDTPS_only
2025-12-10 16:04:22,463 DeMo INFO: Start TensorBoard with: tensorboard --logdir logs/tensorboard --port 6006
2025-12-10 16:04:22,463 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 16:04:28,107 DeMo.train INFO: Epoch[1] Iteration[10/16] Loss: 4.242, Acc: 0.008, Base Lr: 5.00e-06
2025-12-10 16:04:29,489 DeMo.train INFO: Epoch 1 done. Time per batch: 0.468[s] Speed: 136.8[samples/s]
2025-12-10 16:04:29,490 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:29,490 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:04:29,491 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:38,099 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 16:04:38,099 DeMo.train INFO: mAP: 18.9%
2025-12-10 16:04:38,099 DeMo.train INFO: CMC curve, Rank-1  :42.0%
2025-12-10 16:04:38,099 DeMo.train INFO: CMC curve, Rank-5  :61.4%
2025-12-10 16:04:38,099 DeMo.train INFO: CMC curve, Rank-10 :69.0%
2025-12-10 16:04:38,100 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:38,102 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:38,102 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:04:38,102 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:45,735 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 16:04:45,735 DeMo.train INFO: mAP: 18.9%
2025-12-10 16:04:45,735 DeMo.train INFO: CMC curve, Rank-1  :42.0%
2025-12-10 16:04:45,735 DeMo.train INFO: CMC curve, Rank-5  :61.4%
2025-12-10 16:04:45,736 DeMo.train INFO: CMC curve, Rank-10 :69.0%
2025-12-10 16:04:45,736 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:45,738 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:45,739 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:45,739 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:53,218 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 16:04:53,218 DeMo.train INFO: mAP: 18.9%
2025-12-10 16:04:53,218 DeMo.train INFO: CMC curve, Rank-1  :42.0%
2025-12-10 16:04:53,218 DeMo.train INFO: CMC curve, Rank-5  :61.4%
2025-12-10 16:04:53,218 DeMo.train INFO: CMC curve, Rank-10 :69.0%
2025-12-10 16:04:53,218 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:54,735 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:54,735 DeMo.train INFO: Best mAP: 18.9%
2025-12-10 16:04:54,735 DeMo.train INFO: Best Rank-1: 42.0%
2025-12-10 16:04:54,735 DeMo.train INFO: Best Rank-5: 61.4%
2025-12-10 16:04:54,736 DeMo.train INFO: Best Rank-10: 69.0%
2025-12-10 16:04:54,736 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:59,427 DeMo.train INFO: Epoch[2] Iteration[10/16] Loss: 4.028, Acc: 0.009, Base Lr: 5.00e-06
2025-12-10 16:05:00,566 DeMo.train INFO: Epoch 2 done. Time per batch: 0.416[s] Speed: 153.7[samples/s]
2025-12-10 16:05:00,568 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:00,568 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:05:00,568 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:07,742 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 16:05:07,742 DeMo.train INFO: mAP: 21.9%
2025-12-10 16:05:07,742 DeMo.train INFO: CMC curve, Rank-1  :42.3%
2025-12-10 16:05:07,743 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-12-10 16:05:07,743 DeMo.train INFO: CMC curve, Rank-10 :72.8%
2025-12-10 16:05:07,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:08,563 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:08,563 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:05:08,563 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:15,958 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 16:05:15,958 DeMo.train INFO: mAP: 21.9%
2025-12-10 16:05:15,959 DeMo.train INFO: CMC curve, Rank-1  :42.3%
2025-12-10 16:05:15,959 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-12-10 16:05:15,959 DeMo.train INFO: CMC curve, Rank-10 :72.8%
2025-12-10 16:05:15,959 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:15,962 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:15,962 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:15,962 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:23,149 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 16:05:23,149 DeMo.train INFO: mAP: 21.9%
2025-12-10 16:05:23,149 DeMo.train INFO: CMC curve, Rank-1  :42.3%
2025-12-10 16:05:23,149 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-12-10 16:05:23,149 DeMo.train INFO: CMC curve, Rank-10 :72.8%
2025-12-10 16:05:23,149 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:23,652 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:23,653 DeMo.train INFO: Best mAP: 21.9%
2025-12-10 16:05:23,653 DeMo.train INFO: Best Rank-1: 42.3%
2025-12-10 16:05:23,653 DeMo.train INFO: Best Rank-5: 65.7%
2025-12-10 16:05:23,653 DeMo.train INFO: Best Rank-10: 72.8%
2025-12-10 16:05:23,653 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:28,092 DeMo.train INFO: Epoch[3] Iteration[10/16] Loss: 3.994, Acc: 0.025, Base Lr: 5.00e-06
2025-12-10 16:05:29,306 DeMo.train INFO: Epoch 3 done. Time per batch: 0.404[s] Speed: 158.5[samples/s]
2025-12-10 16:05:29,309 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:29,309 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:05:29,309 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:36,633 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 16:05:36,634 DeMo.train INFO: mAP: 23.8%
2025-12-10 16:05:36,634 DeMo.train INFO: CMC curve, Rank-1  :43.8%
2025-12-10 16:05:36,634 DeMo.train INFO: CMC curve, Rank-5  :67.7%
2025-12-10 16:05:36,634 DeMo.train INFO: CMC curve, Rank-10 :75.6%
2025-12-10 16:05:36,634 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:37,034 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:37,035 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:05:37,035 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:44,650 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 16:05:44,651 DeMo.train INFO: mAP: 23.8%
2025-12-10 16:05:44,651 DeMo.train INFO: CMC curve, Rank-1  :43.8%
2025-12-10 16:05:44,651 DeMo.train INFO: CMC curve, Rank-5  :67.7%
2025-12-10 16:05:44,651 DeMo.train INFO: CMC curve, Rank-10 :75.6%
2025-12-10 16:05:44,651 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:44,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:44,654 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:44,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:51,552 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 16:05:51,553 DeMo.train INFO: mAP: 23.8%
2025-12-10 16:05:51,553 DeMo.train INFO: CMC curve, Rank-1  :43.8%
2025-12-10 16:05:51,553 DeMo.train INFO: CMC curve, Rank-5  :67.7%
2025-12-10 16:05:51,553 DeMo.train INFO: CMC curve, Rank-10 :75.6%
2025-12-10 16:05:51,553 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:52,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:52,050 DeMo.train INFO: Best mAP: 23.8%
2025-12-10 16:05:52,050 DeMo.train INFO: Best Rank-1: 43.8%
2025-12-10 16:05:52,050 DeMo.train INFO: Best Rank-5: 67.7%
2025-12-10 16:05:52,050 DeMo.train INFO: Best Rank-10: 75.6%
2025-12-10 16:05:52,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:56,284 DeMo.train INFO: Epoch[4] Iteration[10/16] Loss: 3.951, Acc: 0.030, Base Lr: 5.00e-06
2025-12-10 16:05:57,443 DeMo.train INFO: Epoch 4 done. Time per batch: 0.385[s] Speed: 166.2[samples/s]
2025-12-10 16:05:57,445 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:57,445 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:05:57,445 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:04,558 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 16:06:04,559 DeMo.train INFO: mAP: 27.1%
2025-12-10 16:06:04,559 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-12-10 16:06:04,559 DeMo.train INFO: CMC curve, Rank-5  :69.5%
2025-12-10 16:06:04,559 DeMo.train INFO: CMC curve, Rank-10 :77.2%
2025-12-10 16:06:04,559 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:05,485 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:05,485 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:06:05,485 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:13,057 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 16:06:13,057 DeMo.train INFO: mAP: 27.1%
2025-12-10 16:06:13,057 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-12-10 16:06:13,057 DeMo.train INFO: CMC curve, Rank-5  :69.5%
2025-12-10 16:06:13,057 DeMo.train INFO: CMC curve, Rank-10 :77.2%
2025-12-10 16:06:13,058 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:13,060 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:13,060 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:13,061 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:20,153 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 16:06:20,153 DeMo.train INFO: mAP: 27.1%
2025-12-10 16:06:20,153 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-12-10 16:06:20,153 DeMo.train INFO: CMC curve, Rank-5  :69.5%
2025-12-10 16:06:20,154 DeMo.train INFO: CMC curve, Rank-10 :77.2%
2025-12-10 16:06:20,154 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:20,642 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:20,643 DeMo.train INFO: Best mAP: 27.1%
2025-12-10 16:06:20,643 DeMo.train INFO: Best Rank-1: 48.4%
2025-12-10 16:06:20,643 DeMo.train INFO: Best Rank-5: 69.5%
2025-12-10 16:06:20,643 DeMo.train INFO: Best Rank-10: 77.2%
2025-12-10 16:06:20,643 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:24,779 DeMo.train INFO: Epoch[5] Iteration[10/16] Loss: 3.938, Acc: 0.073, Base Lr: 5.00e-06
2025-12-10 16:06:25,936 DeMo.train INFO: Epoch 5 done. Time per batch: 0.378[s] Speed: 169.3[samples/s]
2025-12-10 16:06:25,937 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:25,937 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:06:25,937 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:33,092 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 16:06:33,092 DeMo.train INFO: mAP: 29.1%
2025-12-10 16:06:33,092 DeMo.train INFO: CMC curve, Rank-1  :50.4%
2025-12-10 16:06:33,092 DeMo.train INFO: CMC curve, Rank-5  :71.7%
2025-12-10 16:06:33,092 DeMo.train INFO: CMC curve, Rank-10 :78.0%
2025-12-10 16:06:33,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:33,751 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:33,751 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:06:33,751 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:41,465 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 16:06:41,465 DeMo.train INFO: mAP: 29.1%
2025-12-10 16:06:41,465 DeMo.train INFO: CMC curve, Rank-1  :50.4%
2025-12-10 16:06:41,465 DeMo.train INFO: CMC curve, Rank-5  :71.7%
2025-12-10 16:06:41,465 DeMo.train INFO: CMC curve, Rank-10 :78.0%
2025-12-10 16:06:41,465 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:41,469 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:41,469 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:41,469 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:48,622 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 16:06:48,622 DeMo.train INFO: mAP: 29.1%
2025-12-10 16:06:48,622 DeMo.train INFO: CMC curve, Rank-1  :50.4%
2025-12-10 16:06:48,622 DeMo.train INFO: CMC curve, Rank-5  :71.7%
2025-12-10 16:06:48,622 DeMo.train INFO: CMC curve, Rank-10 :78.0%
2025-12-10 16:06:48,622 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:50,576 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:50,577 DeMo.train INFO: Best mAP: 29.1%
2025-12-10 16:06:50,577 DeMo.train INFO: Best Rank-1: 50.4%
2025-12-10 16:06:50,577 DeMo.train INFO: Best Rank-5: 71.7%
2025-12-10 16:06:50,577 DeMo.train INFO: Best Rank-10: 78.0%
2025-12-10 16:06:50,577 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:54,809 DeMo.train INFO: Epoch[6] Iteration[10/16] Loss: 3.897, Acc: 0.131, Base Lr: 5.00e-06
2025-12-10 16:06:55,982 DeMo.train INFO: Epoch 6 done. Time per batch: 0.386[s] Speed: 165.8[samples/s]
2025-12-10 16:06:55,983 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:55,983 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:06:55,983 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:03,282 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 16:07:03,282 DeMo.train INFO: mAP: 31.0%
2025-12-10 16:07:03,283 DeMo.train INFO: CMC curve, Rank-1  :52.3%
2025-12-10 16:07:03,283 DeMo.train INFO: CMC curve, Rank-5  :72.1%
2025-12-10 16:07:03,283 DeMo.train INFO: CMC curve, Rank-10 :79.9%
2025-12-10 16:07:03,283 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:04,174 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:04,175 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:07:04,176 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:11,584 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 16:07:11,584 DeMo.train INFO: mAP: 31.0%
2025-12-10 16:07:11,585 DeMo.train INFO: CMC curve, Rank-1  :52.3%
2025-12-10 16:07:11,585 DeMo.train INFO: CMC curve, Rank-5  :72.1%
2025-12-10 16:07:11,585 DeMo.train INFO: CMC curve, Rank-10 :79.9%
2025-12-10 16:07:11,585 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:11,588 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:11,588 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:11,589 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:18,544 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 16:07:18,545 DeMo.train INFO: mAP: 31.0%
2025-12-10 16:07:18,545 DeMo.train INFO: CMC curve, Rank-1  :52.3%
2025-12-10 16:07:18,545 DeMo.train INFO: CMC curve, Rank-5  :72.1%
2025-12-10 16:07:18,545 DeMo.train INFO: CMC curve, Rank-10 :79.9%
2025-12-10 16:07:18,545 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:19,072 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:19,073 DeMo.train INFO: Best mAP: 31.0%
2025-12-10 16:07:19,073 DeMo.train INFO: Best Rank-1: 52.3%
2025-12-10 16:07:19,073 DeMo.train INFO: Best Rank-5: 72.1%
2025-12-10 16:07:19,073 DeMo.train INFO: Best Rank-10: 79.9%
2025-12-10 16:07:19,073 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:23,286 DeMo.train INFO: Epoch[7] Iteration[10/16] Loss: 3.897, Acc: 0.158, Base Lr: 5.00e-06
2025-12-10 16:07:24,465 DeMo.train INFO: Epoch 7 done. Time per batch: 0.385[s] Speed: 166.2[samples/s]
2025-12-10 16:07:24,466 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:24,466 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:07:24,466 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:32,003 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 16:07:32,003 DeMo.train INFO: mAP: 34.9%
2025-12-10 16:07:32,003 DeMo.train INFO: CMC curve, Rank-1  :56.7%
2025-12-10 16:07:32,003 DeMo.train INFO: CMC curve, Rank-5  :76.6%
2025-12-10 16:07:32,003 DeMo.train INFO: CMC curve, Rank-10 :84.4%
2025-12-10 16:07:32,003 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:32,058 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:32,058 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:07:32,059 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:39,122 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 16:07:39,122 DeMo.train INFO: mAP: 34.9%
2025-12-10 16:07:39,123 DeMo.train INFO: CMC curve, Rank-1  :56.7%
2025-12-10 16:07:39,123 DeMo.train INFO: CMC curve, Rank-5  :76.6%
2025-12-10 16:07:39,123 DeMo.train INFO: CMC curve, Rank-10 :84.4%
2025-12-10 16:07:39,123 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:39,126 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:39,126 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:39,126 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:46,033 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 16:07:46,033 DeMo.train INFO: mAP: 34.9%
2025-12-10 16:07:46,033 DeMo.train INFO: CMC curve, Rank-1  :56.7%
2025-12-10 16:07:46,034 DeMo.train INFO: CMC curve, Rank-5  :76.6%
2025-12-10 16:07:46,034 DeMo.train INFO: CMC curve, Rank-10 :84.4%
2025-12-10 16:07:46,034 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:46,532 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:46,532 DeMo.train INFO: Best mAP: 34.9%
2025-12-10 16:07:46,532 DeMo.train INFO: Best Rank-1: 56.7%
2025-12-10 16:07:46,532 DeMo.train INFO: Best Rank-5: 76.6%
2025-12-10 16:07:46,533 DeMo.train INFO: Best Rank-10: 84.4%
2025-12-10 16:07:46,533 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:50,711 DeMo.train INFO: Epoch[8] Iteration[10/16] Loss: 3.873, Acc: 0.247, Base Lr: 5.00e-06
2025-12-10 16:07:51,877 DeMo.train INFO: Epoch 8 done. Time per batch: 0.382[s] Speed: 167.6[samples/s]
2025-12-10 16:07:51,879 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:51,879 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:07:51,879 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:59,050 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 16:07:59,050 DeMo.train INFO: mAP: 36.7%
2025-12-10 16:07:59,050 DeMo.train INFO: CMC curve, Rank-1  :58.4%
2025-12-10 16:07:59,050 DeMo.train INFO: CMC curve, Rank-5  :78.2%
2025-12-10 16:07:59,050 DeMo.train INFO: CMC curve, Rank-10 :84.6%
2025-12-10 16:07:59,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:59,841 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:59,841 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:07:59,841 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:08:07,289 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 16:08:07,289 DeMo.train INFO: mAP: 36.7%
2025-12-10 16:08:07,289 DeMo.train INFO: CMC curve, Rank-1  :58.4%
2025-12-10 16:08:07,289 DeMo.train INFO: CMC curve, Rank-5  :78.2%
2025-12-10 16:08:07,289 DeMo.train INFO: CMC curve, Rank-10 :84.6%
2025-12-10 16:08:07,289 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:07,292 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:07,292 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:08:07,292 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:08:14,449 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 16:08:14,449 DeMo.train INFO: mAP: 36.7%
2025-12-10 16:08:14,449 DeMo.train INFO: CMC curve, Rank-1  :58.4%
2025-12-10 16:08:14,449 DeMo.train INFO: CMC curve, Rank-5  :78.2%
2025-12-10 16:08:14,449 DeMo.train INFO: CMC curve, Rank-10 :84.6%
2025-12-10 16:08:14,449 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:14,948 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:14,949 DeMo.train INFO: Best mAP: 36.7%
2025-12-10 16:08:14,949 DeMo.train INFO: Best Rank-1: 58.4%
2025-12-10 16:08:14,949 DeMo.train INFO: Best Rank-5: 78.2%
2025-12-10 16:08:14,949 DeMo.train INFO: Best Rank-10: 84.6%
2025-12-10 16:08:14,949 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:19,276 DeMo.train INFO: Epoch[9] Iteration[10/16] Loss: 3.846, Acc: 0.311, Base Lr: 5.00e-06
2025-12-10 16:08:20,421 DeMo.train INFO: Epoch 9 done. Time per batch: 0.391[s] Speed: 163.8[samples/s]
2025-12-10 16:08:20,422 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:20,422 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:08:20,422 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

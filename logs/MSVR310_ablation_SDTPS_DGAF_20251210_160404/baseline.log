2025-12-10 16:04:08,423 DeMo INFO: Saving model in the path :..
2025-12-10 16:04:08,423 DeMo INFO: Namespace(config_file='configs/MSVR310/DeMo_SDTPS_DGAF_ablation.yml', exp_name='ablation_baseline', fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'False', 'MODEL.USE_DGAF', 'False'])
2025-12-10 16:04:08,423 DeMo INFO: Loaded configuration file configs/MSVR310/DeMo_SDTPS_DGAF_ablation.yml
2025-12-10 16:04:08,424 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用
  SDTPS_AGGR_RATIO: 0.5    # 已不使用
  SDTPS_LOSS_WEIGHT: 2.0
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 128, 256 ]
  SIZE_TEST: [ 128, 256 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('MSVR310')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 64
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# MSVR310 SDTPS + DGAF Ablation Config
# ============================================================================
# - Based on original DeMo.yml for MSVR310
# - SACR: disabled
# - HDM/ATM: disabled, DIRECT: 1
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10 (same as original)
# ============================================================================

2025-12-10 16:04:08,424 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: MSVR310
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ADAPTER: False
  ARCH: DeMo
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_LOSS_WEIGHT: 1.0
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  FUSED_LOSS_WEIGHT: 0.5
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SHARE_CROSS_ATTN: False
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: False
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: False
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 64
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGB_IR loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   155 |     1032 |         8
  query    |    52 |      591 |         8
  gallery  |   155 |     1055 |         8
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:8 width: 16
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 8
===========Building DeMo===========
2025-12-10 16:04:19,905 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (classifier): Linear(in_features=1536, out_features=155, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-10 16:04:19,906 DeMo INFO: number of parameters:87.96672
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, classifier, nir_reduce, nir_reduce.0, nir_reduce.1, nir_reduce.2, pool, rgb_reduce, rgb_reduce.0, rgb_reduce.1, rgb_reduce.2, tir_reduce, tir_reduce.0, tir_reduce.1, tir_reduce.2
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Note: out_proj is calculated in MultiheadAttention.forward(), ignore it
Note: bottleneck/classifier not used in inference, ignore it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:22,620 DeMo INFO: number of GFLOPs: 34.275378708000005
using soft triplet loss for training
label smooth on, numclasses: 155
2025-12-10 16:04:22,634 DeMo INFO: TensorBoard logging to: logs/tensorboard/ablation_baseline
2025-12-10 16:04:22,634 DeMo INFO: Start TensorBoard with: tensorboard --logdir logs/tensorboard --port 6006
2025-12-10 16:04:22,635 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 16:04:27,805 DeMo.train INFO: Epoch[1] Iteration[10/16] Loss: 3.133, Acc: 0.003, Base Lr: 5.00e-06
2025-12-10 16:04:29,108 DeMo.train INFO: Epoch 1 done. Time per batch: 0.431[s] Speed: 148.4[samples/s]
2025-12-10 16:04:29,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:29,109 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:29,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:38,078 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 16:04:38,078 DeMo.train INFO: mAP: 22.0%
2025-12-10 16:04:38,078 DeMo.train INFO: CMC curve, Rank-1  :45.7%
2025-12-10 16:04:38,078 DeMo.train INFO: CMC curve, Rank-5  :65.1%
2025-12-10 16:04:38,078 DeMo.train INFO: CMC curve, Rank-10 :72.1%
2025-12-10 16:04:38,078 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:38,456 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:38,456 DeMo.train INFO: Best mAP: 22.0%
2025-12-10 16:04:38,456 DeMo.train INFO: Best Rank-1: 45.7%
2025-12-10 16:04:38,457 DeMo.train INFO: Best Rank-5: 65.1%
2025-12-10 16:04:38,457 DeMo.train INFO: Best Rank-10: 72.1%
2025-12-10 16:04:38,457 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:42,675 DeMo.train INFO: Epoch[2] Iteration[10/16] Loss: 2.168, Acc: 0.013, Base Lr: 5.00e-06
2025-12-10 16:04:43,736 DeMo.train INFO: Epoch 2 done. Time per batch: 0.377[s] Speed: 169.7[samples/s]
2025-12-10 16:04:43,738 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:43,738 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:43,738 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:50,561 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 16:04:50,561 DeMo.train INFO: mAP: 28.1%
2025-12-10 16:04:50,562 DeMo.train INFO: CMC curve, Rank-1  :51.3%
2025-12-10 16:04:50,562 DeMo.train INFO: CMC curve, Rank-5  :70.6%
2025-12-10 16:04:50,562 DeMo.train INFO: CMC curve, Rank-10 :78.7%
2025-12-10 16:04:50,562 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:51,216 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:51,363 DeMo.train INFO: Best mAP: 28.1%
2025-12-10 16:04:51,364 DeMo.train INFO: Best Rank-1: 51.3%
2025-12-10 16:04:51,364 DeMo.train INFO: Best Rank-5: 70.6%
2025-12-10 16:04:51,364 DeMo.train INFO: Best Rank-10: 78.7%
2025-12-10 16:04:51,364 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:55,328 DeMo.train INFO: Epoch[3] Iteration[10/16] Loss: 2.059, Acc: 0.009, Base Lr: 5.00e-06
2025-12-10 16:04:56,409 DeMo.train INFO: Epoch 3 done. Time per batch: 0.360[s] Speed: 177.6[samples/s]
2025-12-10 16:04:56,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:56,410 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:56,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:03,723 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 16:05:03,723 DeMo.train INFO: mAP: 31.8%
2025-12-10 16:05:03,723 DeMo.train INFO: CMC curve, Rank-1  :52.1%
2025-12-10 16:05:03,723 DeMo.train INFO: CMC curve, Rank-5  :72.3%
2025-12-10 16:05:03,724 DeMo.train INFO: CMC curve, Rank-10 :80.9%
2025-12-10 16:05:03,724 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:04,598 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:04,598 DeMo.train INFO: Best mAP: 31.8%
2025-12-10 16:05:04,598 DeMo.train INFO: Best Rank-1: 52.1%
2025-12-10 16:05:04,598 DeMo.train INFO: Best Rank-5: 72.3%
2025-12-10 16:05:04,598 DeMo.train INFO: Best Rank-10: 80.9%
2025-12-10 16:05:04,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:08,547 DeMo.train INFO: Epoch[4] Iteration[10/16] Loss: 1.999, Acc: 0.045, Base Lr: 5.00e-06
2025-12-10 16:05:09,609 DeMo.train INFO: Epoch 4 done. Time per batch: 0.358[s] Speed: 178.8[samples/s]
2025-12-10 16:05:09,610 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:09,610 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:09,610 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:16,419 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 16:05:16,420 DeMo.train INFO: mAP: 35.9%
2025-12-10 16:05:16,420 DeMo.train INFO: CMC curve, Rank-1  :55.7%
2025-12-10 16:05:16,420 DeMo.train INFO: CMC curve, Rank-5  :75.5%
2025-12-10 16:05:16,420 DeMo.train INFO: CMC curve, Rank-10 :81.9%
2025-12-10 16:05:16,420 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:16,944 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:16,944 DeMo.train INFO: Best mAP: 35.9%
2025-12-10 16:05:16,944 DeMo.train INFO: Best Rank-1: 55.7%
2025-12-10 16:05:16,945 DeMo.train INFO: Best Rank-5: 75.5%
2025-12-10 16:05:16,945 DeMo.train INFO: Best Rank-10: 81.9%
2025-12-10 16:05:16,945 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:20,828 DeMo.train INFO: Epoch[5] Iteration[10/16] Loss: 1.963, Acc: 0.062, Base Lr: 5.00e-06
2025-12-10 16:05:21,904 DeMo.train INFO: Epoch 5 done. Time per batch: 0.354[s] Speed: 180.7[samples/s]
2025-12-10 16:05:21,905 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:21,905 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:21,905 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:28,831 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 16:05:28,831 DeMo.train INFO: mAP: 36.8%
2025-12-10 16:05:28,832 DeMo.train INFO: CMC curve, Rank-1  :54.7%
2025-12-10 16:05:28,832 DeMo.train INFO: CMC curve, Rank-5  :75.5%
2025-12-10 16:05:28,832 DeMo.train INFO: CMC curve, Rank-10 :82.9%
2025-12-10 16:05:28,832 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:30,230 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:30,231 DeMo.train INFO: Best mAP: 36.8%
2025-12-10 16:05:30,231 DeMo.train INFO: Best Rank-1: 54.7%
2025-12-10 16:05:30,231 DeMo.train INFO: Best Rank-5: 75.5%
2025-12-10 16:05:30,231 DeMo.train INFO: Best Rank-10: 82.9%
2025-12-10 16:05:30,231 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:34,658 DeMo.train INFO: Epoch[6] Iteration[10/16] Loss: 1.914, Acc: 0.125, Base Lr: 5.00e-06
2025-12-10 16:05:35,783 DeMo.train INFO: Epoch 6 done. Time per batch: 0.397[s] Speed: 161.4[samples/s]
2025-12-10 16:05:35,785 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:35,785 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:35,785 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:42,701 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 16:05:42,701 DeMo.train INFO: mAP: 40.4%
2025-12-10 16:05:42,702 DeMo.train INFO: CMC curve, Rank-1  :59.1%
2025-12-10 16:05:42,702 DeMo.train INFO: CMC curve, Rank-5  :79.2%
2025-12-10 16:05:42,702 DeMo.train INFO: CMC curve, Rank-10 :84.9%
2025-12-10 16:05:42,702 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:44,221 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:44,222 DeMo.train INFO: Best mAP: 40.4%
2025-12-10 16:05:44,222 DeMo.train INFO: Best Rank-1: 59.1%
2025-12-10 16:05:44,222 DeMo.train INFO: Best Rank-5: 79.2%
2025-12-10 16:05:44,222 DeMo.train INFO: Best Rank-10: 84.9%
2025-12-10 16:05:44,222 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:48,570 DeMo.train INFO: Epoch[7] Iteration[10/16] Loss: 1.898, Acc: 0.206, Base Lr: 5.00e-06
2025-12-10 16:05:49,634 DeMo.train INFO: Epoch 7 done. Time per batch: 0.387[s] Speed: 165.6[samples/s]
2025-12-10 16:05:49,635 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:49,635 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:49,635 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:56,602 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 16:05:56,603 DeMo.train INFO: mAP: 42.7%
2025-12-10 16:05:56,603 DeMo.train INFO: CMC curve, Rank-1  :61.9%
2025-12-10 16:05:56,603 DeMo.train INFO: CMC curve, Rank-5  :80.4%
2025-12-10 16:05:56,603 DeMo.train INFO: CMC curve, Rank-10 :85.8%
2025-12-10 16:05:56,603 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:57,125 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:57,125 DeMo.train INFO: Best mAP: 42.7%
2025-12-10 16:05:57,125 DeMo.train INFO: Best Rank-1: 61.9%
2025-12-10 16:05:57,125 DeMo.train INFO: Best Rank-5: 80.4%
2025-12-10 16:05:57,125 DeMo.train INFO: Best Rank-10: 85.8%
2025-12-10 16:05:57,126 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:01,113 DeMo.train INFO: Epoch[8] Iteration[10/16] Loss: 1.872, Acc: 0.286, Base Lr: 5.00e-06
2025-12-10 16:06:02,185 DeMo.train INFO: Epoch 8 done. Time per batch: 0.361[s] Speed: 177.1[samples/s]
2025-12-10 16:06:02,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:02,186 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:02,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:09,131 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 16:06:09,132 DeMo.train INFO: mAP: 42.7%
2025-12-10 16:06:09,132 DeMo.train INFO: CMC curve, Rank-1  :59.6%
2025-12-10 16:06:09,132 DeMo.train INFO: CMC curve, Rank-5  :79.9%
2025-12-10 16:06:09,132 DeMo.train INFO: CMC curve, Rank-10 :84.6%
2025-12-10 16:06:09,132 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:10,174 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:10,175 DeMo.train INFO: Best mAP: 42.7%
2025-12-10 16:06:10,175 DeMo.train INFO: Best Rank-1: 61.9%
2025-12-10 16:06:10,175 DeMo.train INFO: Best Rank-5: 80.4%
2025-12-10 16:06:10,175 DeMo.train INFO: Best Rank-10: 85.8%
2025-12-10 16:06:10,175 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:14,472 DeMo.train INFO: Epoch[9] Iteration[10/16] Loss: 1.804, Acc: 0.375, Base Lr: 5.00e-06
2025-12-10 16:06:15,560 DeMo.train INFO: Epoch 9 done. Time per batch: 0.385[s] Speed: 166.4[samples/s]
2025-12-10 16:06:15,562 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:15,562 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:15,562 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:22,534 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 16:06:22,534 DeMo.train INFO: mAP: 44.6%
2025-12-10 16:06:22,535 DeMo.train INFO: CMC curve, Rank-1  :60.4%
2025-12-10 16:06:22,535 DeMo.train INFO: CMC curve, Rank-5  :80.2%
2025-12-10 16:06:22,535 DeMo.train INFO: CMC curve, Rank-10 :84.4%
2025-12-10 16:06:22,535 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:23,072 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:23,072 DeMo.train INFO: Best mAP: 44.6%
2025-12-10 16:06:23,072 DeMo.train INFO: Best Rank-1: 60.4%
2025-12-10 16:06:23,072 DeMo.train INFO: Best Rank-5: 80.2%
2025-12-10 16:06:23,072 DeMo.train INFO: Best Rank-10: 84.4%
2025-12-10 16:06:23,072 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:27,040 DeMo.train INFO: Epoch[10] Iteration[10/16] Loss: 1.812, Acc: 0.425, Base Lr: 5.00e-06
2025-12-10 16:06:28,104 DeMo.train INFO: Epoch 10 done. Time per batch: 0.359[s] Speed: 178.1[samples/s]
2025-12-10 16:06:28,105 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:28,105 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:28,105 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:34,920 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 16:06:34,920 DeMo.train INFO: mAP: 46.5%
2025-12-10 16:06:34,920 DeMo.train INFO: CMC curve, Rank-1  :65.1%
2025-12-10 16:06:34,920 DeMo.train INFO: CMC curve, Rank-5  :81.7%
2025-12-10 16:06:34,920 DeMo.train INFO: CMC curve, Rank-10 :85.8%
2025-12-10 16:06:34,920 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:36,488 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:36,489 DeMo.train INFO: Best mAP: 46.5%
2025-12-10 16:06:36,489 DeMo.train INFO: Best Rank-1: 65.1%
2025-12-10 16:06:36,489 DeMo.train INFO: Best Rank-5: 81.7%
2025-12-10 16:06:36,489 DeMo.train INFO: Best Rank-10: 85.8%
2025-12-10 16:06:36,489 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:40,699 DeMo.train INFO: Epoch[11] Iteration[10/16] Loss: 1.756, Acc: 0.492, Base Lr: 5.00e-06
2025-12-10 16:06:41,780 DeMo.train INFO: Epoch 11 done. Time per batch: 0.378[s] Speed: 169.3[samples/s]
2025-12-10 16:06:41,781 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:41,781 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:41,781 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:48,770 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 16:06:48,770 DeMo.train INFO: mAP: 48.9%
2025-12-10 16:06:48,770 DeMo.train INFO: CMC curve, Rank-1  :66.7%
2025-12-10 16:06:48,770 DeMo.train INFO: CMC curve, Rank-5  :83.1%
2025-12-10 16:06:48,770 DeMo.train INFO: CMC curve, Rank-10 :87.0%
2025-12-10 16:06:48,770 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:50,611 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:50,611 DeMo.train INFO: Best mAP: 48.9%
2025-12-10 16:06:50,611 DeMo.train INFO: Best Rank-1: 66.7%
2025-12-10 16:06:50,612 DeMo.train INFO: Best Rank-5: 83.1%
2025-12-10 16:06:50,612 DeMo.train INFO: Best Rank-10: 87.0%
2025-12-10 16:06:50,612 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:54,625 DeMo.train INFO: Epoch[12] Iteration[10/16] Loss: 1.709, Acc: 0.528, Base Lr: 5.00e-06
2025-12-10 16:06:55,706 DeMo.train INFO: Epoch 12 done. Time per batch: 0.364[s] Speed: 175.9[samples/s]
2025-12-10 16:06:55,707 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:55,707 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:55,707 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:02,747 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 16:07:02,748 DeMo.train INFO: mAP: 48.5%
2025-12-10 16:07:02,748 DeMo.train INFO: CMC curve, Rank-1  :67.3%
2025-12-10 16:07:02,748 DeMo.train INFO: CMC curve, Rank-5  :81.7%
2025-12-10 16:07:02,748 DeMo.train INFO: CMC curve, Rank-10 :85.3%
2025-12-10 16:07:02,748 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:04,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:04,168 DeMo.train INFO: Best mAP: 48.9%
2025-12-10 16:07:04,168 DeMo.train INFO: Best Rank-1: 66.7%
2025-12-10 16:07:04,168 DeMo.train INFO: Best Rank-5: 83.1%
2025-12-10 16:07:04,168 DeMo.train INFO: Best Rank-10: 87.0%
2025-12-10 16:07:04,168 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:08,451 DeMo.train INFO: Epoch[13] Iteration[10/16] Loss: 1.666, Acc: 0.591, Base Lr: 5.00e-06
2025-12-10 16:07:09,771 DeMo.train INFO: Epoch 13 done. Time per batch: 0.374[s] Speed: 171.3[samples/s]
2025-12-10 16:07:09,772 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:09,772 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:09,772 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:16,759 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 16:07:16,759 DeMo.train INFO: mAP: 50.3%
2025-12-10 16:07:16,759 DeMo.train INFO: CMC curve, Rank-1  :68.0%
2025-12-10 16:07:16,759 DeMo.train INFO: CMC curve, Rank-5  :84.1%
2025-12-10 16:07:16,759 DeMo.train INFO: CMC curve, Rank-10 :88.2%
2025-12-10 16:07:16,760 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:17,287 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:17,288 DeMo.train INFO: Best mAP: 50.3%
2025-12-10 16:07:17,288 DeMo.train INFO: Best Rank-1: 68.0%
2025-12-10 16:07:17,288 DeMo.train INFO: Best Rank-5: 84.1%
2025-12-10 16:07:17,288 DeMo.train INFO: Best Rank-10: 88.2%
2025-12-10 16:07:17,288 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:21,354 DeMo.train INFO: Epoch[14] Iteration[10/16] Loss: 1.653, Acc: 0.637, Base Lr: 5.00e-06
2025-12-10 16:07:22,411 DeMo.train INFO: Epoch 14 done. Time per batch: 0.366[s] Speed: 174.9[samples/s]
2025-12-10 16:07:22,412 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:22,412 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:22,412 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:29,253 DeMo.train INFO: Validation Results - Epoch: 14
2025-12-10 16:07:29,253 DeMo.train INFO: mAP: 47.9%
2025-12-10 16:07:29,253 DeMo.train INFO: CMC curve, Rank-1  :64.5%
2025-12-10 16:07:29,253 DeMo.train INFO: CMC curve, Rank-5  :80.5%
2025-12-10 16:07:29,253 DeMo.train INFO: CMC curve, Rank-10 :86.5%
2025-12-10 16:07:29,253 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:29,305 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:29,305 DeMo.train INFO: Best mAP: 50.3%
2025-12-10 16:07:29,306 DeMo.train INFO: Best Rank-1: 68.0%
2025-12-10 16:07:29,306 DeMo.train INFO: Best Rank-5: 84.1%
2025-12-10 16:07:29,306 DeMo.train INFO: Best Rank-10: 88.2%
2025-12-10 16:07:29,306 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:33,542 DeMo.train INFO: Epoch[15] Iteration[10/16] Loss: 1.630, Acc: 0.694, Base Lr: 5.00e-06
2025-12-10 16:07:34,598 DeMo.train INFO: Epoch 15 done. Time per batch: 0.378[s] Speed: 169.3[samples/s]
2025-12-10 16:07:34,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:34,599 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:34,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:41,502 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 16:07:41,502 DeMo.train INFO: mAP: 49.1%
2025-12-10 16:07:41,502 DeMo.train INFO: CMC curve, Rank-1  :68.4%
2025-12-10 16:07:41,502 DeMo.train INFO: CMC curve, Rank-5  :83.6%
2025-12-10 16:07:41,502 DeMo.train INFO: CMC curve, Rank-10 :87.8%
2025-12-10 16:07:41,502 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:41,555 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:41,555 DeMo.train INFO: Best mAP: 50.3%
2025-12-10 16:07:41,555 DeMo.train INFO: Best Rank-1: 68.0%
2025-12-10 16:07:41,555 DeMo.train INFO: Best Rank-5: 84.1%
2025-12-10 16:07:41,556 DeMo.train INFO: Best Rank-10: 88.2%
2025-12-10 16:07:41,556 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:45,579 DeMo.train INFO: Epoch[16] Iteration[10/16] Loss: 1.578, Acc: 0.694, Base Lr: 5.00e-06
2025-12-10 16:07:46,650 DeMo.train INFO: Epoch 16 done. Time per batch: 0.364[s] Speed: 175.9[samples/s]
2025-12-10 16:07:46,651 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:46,651 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:46,651 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:53,642 DeMo.train INFO: Validation Results - Epoch: 16
2025-12-10 16:07:53,642 DeMo.train INFO: mAP: 48.8%
2025-12-10 16:07:53,642 DeMo.train INFO: CMC curve, Rank-1  :65.3%
2025-12-10 16:07:53,642 DeMo.train INFO: CMC curve, Rank-5  :83.8%
2025-12-10 16:07:53,643 DeMo.train INFO: CMC curve, Rank-10 :87.3%
2025-12-10 16:07:53,643 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:54,977 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:54,978 DeMo.train INFO: Best mAP: 50.3%
2025-12-10 16:07:54,978 DeMo.train INFO: Best Rank-1: 68.0%
2025-12-10 16:07:54,978 DeMo.train INFO: Best Rank-5: 84.1%
2025-12-10 16:07:54,978 DeMo.train INFO: Best Rank-10: 88.2%
2025-12-10 16:07:54,978 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:59,693 DeMo.train INFO: Epoch[17] Iteration[10/16] Loss: 1.561, Acc: 0.664, Base Lr: 5.00e-06
2025-12-10 16:08:00,763 DeMo.train INFO: Epoch 17 done. Time per batch: 0.413[s] Speed: 154.9[samples/s]
2025-12-10 16:08:00,764 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:00,764 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:08:00,765 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:08:07,854 DeMo.train INFO: Validation Results - Epoch: 17
2025-12-10 16:08:07,854 DeMo.train INFO: mAP: 49.4%
2025-12-10 16:08:07,854 DeMo.train INFO: CMC curve, Rank-1  :66.0%
2025-12-10 16:08:07,855 DeMo.train INFO: CMC curve, Rank-5  :82.2%
2025-12-10 16:08:07,855 DeMo.train INFO: CMC curve, Rank-10 :86.3%
2025-12-10 16:08:07,855 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:09,059 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:09,059 DeMo.train INFO: Best mAP: 50.3%
2025-12-10 16:08:09,059 DeMo.train INFO: Best Rank-1: 68.0%
2025-12-10 16:08:09,059 DeMo.train INFO: Best Rank-5: 84.1%
2025-12-10 16:08:09,059 DeMo.train INFO: Best Rank-10: 88.2%
2025-12-10 16:08:09,060 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:13,812 DeMo.train INFO: Epoch[18] Iteration[10/16] Loss: 1.465, Acc: 0.681, Base Lr: 5.00e-06
2025-12-10 16:08:14,860 DeMo.train INFO: Epoch 18 done. Time per batch: 0.414[s] Speed: 154.5[samples/s]
2025-12-10 16:08:14,861 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:14,862 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:08:14,862 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:08:21,671 DeMo.train INFO: Validation Results - Epoch: 18
2025-12-10 16:08:21,671 DeMo.train INFO: mAP: 50.2%
2025-12-10 16:08:21,671 DeMo.train INFO: CMC curve, Rank-1  :67.2%
2025-12-10 16:08:21,671 DeMo.train INFO: CMC curve, Rank-5  :81.4%
2025-12-10 16:08:21,671 DeMo.train INFO: CMC curve, Rank-10 :87.1%
2025-12-10 16:08:21,672 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:21,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:21,743 DeMo.train INFO: Best mAP: 50.3%
2025-12-10 16:08:21,743 DeMo.train INFO: Best Rank-1: 68.0%
2025-12-10 16:08:21,743 DeMo.train INFO: Best Rank-5: 84.1%
2025-12-10 16:08:21,743 DeMo.train INFO: Best Rank-10: 88.2%
2025-12-10 16:08:21,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

2025-12-10 16:04:08,444 DeMo INFO: Saving model in the path :..
2025-12-10 16:04:08,444 DeMo INFO: Namespace(config_file='configs/MSVR310/DeMo_SDTPS_DGAF_ablation.yml', exp_name='ablation_DGAFv3_only', fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'False', 'MODEL.USE_DGAF', 'True'])
2025-12-10 16:04:08,444 DeMo INFO: Loaded configuration file configs/MSVR310/DeMo_SDTPS_DGAF_ablation.yml
2025-12-10 16:04:08,445 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用
  SDTPS_AGGR_RATIO: 0.5    # 已不使用
  SDTPS_LOSS_WEIGHT: 2.0
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 128, 256 ]
  SIZE_TEST: [ 128, 256 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('MSVR310')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 64
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# MSVR310 SDTPS + DGAF Ablation Config
# ============================================================================
# - Based on original DeMo.yml for MSVR310
# - SACR: disabled
# - HDM/ATM: disabled, DIRECT: 1
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10 (same as original)
# ============================================================================

2025-12-10 16:04:08,445 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: MSVR310
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ADAPTER: False
  ARCH: DeMo
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_LOSS_WEIGHT: 1.0
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  FUSED_LOSS_WEIGHT: 0.5
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SHARE_CROSS_ATTN: False
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: True
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: False
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 64
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGB_IR loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   155 |     1032 |         8
  query    |    52 |      591 |         8
  gallery  |   155 |     1055 |         8
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:8 width: 16
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 8
===========Building DeMo===========
2025-12-10 16:04:19,966 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (dgaf): DualGatedAdaptiveFusionV3(
    (attn_pool): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (attn_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (entropy_proj): Linear(in_features=512, out_features=512, bias=True)
    (gate_net): Sequential(
      (0): Linear(in_features=1536, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (2): ReLU(inplace=True)
      (3): Linear(in_features=512, out_features=3, bias=True)
      (4): Sigmoid()
    )
    (modal_enhance): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classifier_dgaf): Linear(in_features=1536, out_features=155, bias=False)
  (bottleneck_dgaf): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier): Linear(in_features=1536, out_features=155, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-10 16:04:19,967 DeMo INFO: number of parameters:90.575364
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
Unsupported operator aten::log encountered 3 time(s)
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, bottleneck_dgaf, classifier, classifier_dgaf, dgaf.attn_pool.out_proj, nir_reduce, nir_reduce.0, nir_reduce.1, nir_reduce.2, pool, rgb_reduce, rgb_reduce.0, rgb_reduce.1, rgb_reduce.2, tir_reduce, tir_reduce.0, tir_reduce.1, tir_reduce.2
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Note: out_proj is calculated in MultiheadAttention.forward(), ignore it
Note: bottleneck/classifier not used in inference, ignore it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:22,698 DeMo INFO: number of GFLOPs: 34.48054893099999
using soft triplet loss for training
label smooth on, numclasses: 155
2025-12-10 16:04:22,714 DeMo INFO: TensorBoard logging to: logs/tensorboard/ablation_DGAFv3_only
2025-12-10 16:04:22,714 DeMo INFO: Start TensorBoard with: tensorboard --logdir logs/tensorboard --port 6006
2025-12-10 16:04:22,714 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 16:04:27,867 DeMo.train INFO: Epoch[1] Iteration[10/16] Loss: 4.216, Acc: 0.002, Base Lr: 5.00e-06
2025-12-10 16:04:29,185 DeMo.train INFO: Epoch 1 done. Time per batch: 0.431[s] Speed: 148.6[samples/s]
2025-12-10 16:04:29,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:29,186 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:29,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:38,122 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-10 16:04:38,122 DeMo.train INFO: mAP: 17.8%
2025-12-10 16:04:38,122 DeMo.train INFO: CMC curve, Rank-1  :39.8%
2025-12-10 16:04:38,122 DeMo.train INFO: CMC curve, Rank-5  :60.1%
2025-12-10 16:04:38,122 DeMo.train INFO: CMC curve, Rank-10 :69.9%
2025-12-10 16:04:38,122 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:38,498 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:38,499 DeMo.train INFO: Best mAP: 17.8%
2025-12-10 16:04:38,499 DeMo.train INFO: Best Rank-1: 39.8%
2025-12-10 16:04:38,499 DeMo.train INFO: Best Rank-5: 60.1%
2025-12-10 16:04:38,499 DeMo.train INFO: Best Rank-10: 69.9%
2025-12-10 16:04:38,499 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:42,749 DeMo.train INFO: Epoch[2] Iteration[10/16] Loss: 2.349, Acc: 0.011, Base Lr: 5.00e-06
2025-12-10 16:04:43,832 DeMo.train INFO: Epoch 2 done. Time per batch: 0.381[s] Speed: 168.0[samples/s]
2025-12-10 16:04:43,833 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:43,833 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:43,833 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:04:50,560 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-10 16:04:50,560 DeMo.train INFO: mAP: 18.9%
2025-12-10 16:04:50,560 DeMo.train INFO: CMC curve, Rank-1  :40.8%
2025-12-10 16:04:50,560 DeMo.train INFO: CMC curve, Rank-5  :60.9%
2025-12-10 16:04:50,560 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-12-10 16:04:50,560 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:51,166 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:51,167 DeMo.train INFO: Best mAP: 18.9%
2025-12-10 16:04:51,167 DeMo.train INFO: Best Rank-1: 40.8%
2025-12-10 16:04:51,167 DeMo.train INFO: Best Rank-5: 60.9%
2025-12-10 16:04:51,167 DeMo.train INFO: Best Rank-10: 71.4%
2025-12-10 16:04:51,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:55,086 DeMo.train INFO: Epoch[3] Iteration[10/16] Loss: 2.183, Acc: 0.033, Base Lr: 5.00e-06
2025-12-10 16:04:56,250 DeMo.train INFO: Epoch 3 done. Time per batch: 0.363[s] Speed: 176.3[samples/s]
2025-12-10 16:04:56,252 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:04:56,252 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:04:56,252 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:03,571 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-10 16:05:03,571 DeMo.train INFO: mAP: 22.6%
2025-12-10 16:05:03,571 DeMo.train INFO: CMC curve, Rank-1  :44.0%
2025-12-10 16:05:03,571 DeMo.train INFO: CMC curve, Rank-5  :64.8%
2025-12-10 16:05:03,571 DeMo.train INFO: CMC curve, Rank-10 :75.3%
2025-12-10 16:05:03,571 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:04,573 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:04,574 DeMo.train INFO: Best mAP: 22.6%
2025-12-10 16:05:04,574 DeMo.train INFO: Best Rank-1: 44.0%
2025-12-10 16:05:04,574 DeMo.train INFO: Best Rank-5: 64.8%
2025-12-10 16:05:04,574 DeMo.train INFO: Best Rank-10: 75.3%
2025-12-10 16:05:04,574 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:08,590 DeMo.train INFO: Epoch[4] Iteration[10/16] Loss: 2.118, Acc: 0.053, Base Lr: 5.00e-06
2025-12-10 16:05:09,701 DeMo.train INFO: Epoch 4 done. Time per batch: 0.366[s] Speed: 174.8[samples/s]
2025-12-10 16:05:09,703 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:09,703 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:09,703 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:16,547 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-10 16:05:16,547 DeMo.train INFO: mAP: 25.3%
2025-12-10 16:05:16,547 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-12-10 16:05:16,547 DeMo.train INFO: CMC curve, Rank-5  :68.5%
2025-12-10 16:05:16,547 DeMo.train INFO: CMC curve, Rank-10 :76.8%
2025-12-10 16:05:16,547 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:18,096 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:18,096 DeMo.train INFO: Best mAP: 25.3%
2025-12-10 16:05:18,096 DeMo.train INFO: Best Rank-1: 47.5%
2025-12-10 16:05:18,096 DeMo.train INFO: Best Rank-5: 68.5%
2025-12-10 16:05:18,096 DeMo.train INFO: Best Rank-10: 76.8%
2025-12-10 16:05:18,097 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:22,536 DeMo.train INFO: Epoch[5] Iteration[10/16] Loss: 2.073, Acc: 0.064, Base Lr: 5.00e-06
2025-12-10 16:05:23,617 DeMo.train INFO: Epoch 5 done. Time per batch: 0.394[s] Speed: 162.3[samples/s]
2025-12-10 16:05:23,618 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:23,618 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:23,618 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:31,072 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-10 16:05:31,072 DeMo.train INFO: mAP: 28.7%
2025-12-10 16:05:31,072 DeMo.train INFO: CMC curve, Rank-1  :50.8%
2025-12-10 16:05:31,072 DeMo.train INFO: CMC curve, Rank-5  :72.9%
2025-12-10 16:05:31,072 DeMo.train INFO: CMC curve, Rank-10 :78.7%
2025-12-10 16:05:31,072 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:32,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:32,728 DeMo.train INFO: Best mAP: 28.7%
2025-12-10 16:05:32,729 DeMo.train INFO: Best Rank-1: 50.8%
2025-12-10 16:05:32,729 DeMo.train INFO: Best Rank-5: 72.9%
2025-12-10 16:05:32,729 DeMo.train INFO: Best Rank-10: 78.7%
2025-12-10 16:05:32,729 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:37,077 DeMo.train INFO: Epoch[6] Iteration[10/16] Loss: 1.986, Acc: 0.117, Base Lr: 5.00e-06
2025-12-10 16:05:38,187 DeMo.train INFO: Epoch 6 done. Time per batch: 0.390[s] Speed: 164.1[samples/s]
2025-12-10 16:05:38,189 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:38,189 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:38,189 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:45,044 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-10 16:05:45,044 DeMo.train INFO: mAP: 32.3%
2025-12-10 16:05:45,044 DeMo.train INFO: CMC curve, Rank-1  :54.1%
2025-12-10 16:05:45,044 DeMo.train INFO: CMC curve, Rank-5  :74.8%
2025-12-10 16:05:45,044 DeMo.train INFO: CMC curve, Rank-10 :81.7%
2025-12-10 16:05:45,044 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:46,667 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:46,667 DeMo.train INFO: Best mAP: 32.3%
2025-12-10 16:05:46,667 DeMo.train INFO: Best Rank-1: 54.1%
2025-12-10 16:05:46,667 DeMo.train INFO: Best Rank-5: 74.8%
2025-12-10 16:05:46,667 DeMo.train INFO: Best Rank-10: 81.7%
2025-12-10 16:05:46,667 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:51,141 DeMo.train INFO: Epoch[7] Iteration[10/16] Loss: 1.996, Acc: 0.202, Base Lr: 5.00e-06
2025-12-10 16:05:52,246 DeMo.train INFO: Epoch 7 done. Time per batch: 0.398[s] Speed: 160.6[samples/s]
2025-12-10 16:05:52,247 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:05:52,247 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:05:52,248 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:05:59,561 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-10 16:05:59,561 DeMo.train INFO: mAP: 33.7%
2025-12-10 16:05:59,561 DeMo.train INFO: CMC curve, Rank-1  :55.0%
2025-12-10 16:05:59,561 DeMo.train INFO: CMC curve, Rank-5  :74.8%
2025-12-10 16:05:59,562 DeMo.train INFO: CMC curve, Rank-10 :81.9%
2025-12-10 16:05:59,562 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:00,995 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:00,996 DeMo.train INFO: Best mAP: 33.7%
2025-12-10 16:06:00,996 DeMo.train INFO: Best Rank-1: 55.0%
2025-12-10 16:06:00,996 DeMo.train INFO: Best Rank-5: 74.8%
2025-12-10 16:06:00,996 DeMo.train INFO: Best Rank-10: 81.9%
2025-12-10 16:06:00,996 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:05,292 DeMo.train INFO: Epoch[8] Iteration[10/16] Loss: 1.936, Acc: 0.259, Base Lr: 5.00e-06
2025-12-10 16:06:06,409 DeMo.train INFO: Epoch 8 done. Time per batch: 0.387[s] Speed: 165.6[samples/s]
2025-12-10 16:06:06,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:06,410 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:06,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:13,214 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-10 16:06:13,214 DeMo.train INFO: mAP: 37.1%
2025-12-10 16:06:13,214 DeMo.train INFO: CMC curve, Rank-1  :58.7%
2025-12-10 16:06:13,214 DeMo.train INFO: CMC curve, Rank-5  :76.3%
2025-12-10 16:06:13,214 DeMo.train INFO: CMC curve, Rank-10 :82.2%
2025-12-10 16:06:13,214 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:15,076 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:15,076 DeMo.train INFO: Best mAP: 37.1%
2025-12-10 16:06:15,076 DeMo.train INFO: Best Rank-1: 58.7%
2025-12-10 16:06:15,076 DeMo.train INFO: Best Rank-5: 76.3%
2025-12-10 16:06:15,077 DeMo.train INFO: Best Rank-10: 82.2%
2025-12-10 16:06:15,077 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:19,314 DeMo.train INFO: Epoch[9] Iteration[10/16] Loss: 1.887, Acc: 0.303, Base Lr: 5.00e-06
2025-12-10 16:06:20,411 DeMo.train INFO: Epoch 9 done. Time per batch: 0.381[s] Speed: 168.0[samples/s]
2025-12-10 16:06:20,412 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:20,412 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:20,413 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:27,242 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-10 16:06:27,242 DeMo.train INFO: mAP: 39.2%
2025-12-10 16:06:27,243 DeMo.train INFO: CMC curve, Rank-1  :61.1%
2025-12-10 16:06:27,243 DeMo.train INFO: CMC curve, Rank-5  :76.8%
2025-12-10 16:06:27,243 DeMo.train INFO: CMC curve, Rank-10 :82.4%
2025-12-10 16:06:27,243 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:27,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:27,774 DeMo.train INFO: Best mAP: 39.2%
2025-12-10 16:06:27,774 DeMo.train INFO: Best Rank-1: 61.1%
2025-12-10 16:06:27,774 DeMo.train INFO: Best Rank-5: 76.8%
2025-12-10 16:06:27,774 DeMo.train INFO: Best Rank-10: 82.4%
2025-12-10 16:06:27,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:31,765 DeMo.train INFO: Epoch[10] Iteration[10/16] Loss: 1.858, Acc: 0.355, Base Lr: 5.00e-06
2025-12-10 16:06:32,899 DeMo.train INFO: Epoch 10 done. Time per batch: 0.366[s] Speed: 174.8[samples/s]
2025-12-10 16:06:32,901 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:32,901 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:32,901 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:39,714 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-10 16:06:39,714 DeMo.train INFO: mAP: 38.9%
2025-12-10 16:06:39,714 DeMo.train INFO: CMC curve, Rank-1  :60.4%
2025-12-10 16:06:39,714 DeMo.train INFO: CMC curve, Rank-5  :77.7%
2025-12-10 16:06:39,714 DeMo.train INFO: CMC curve, Rank-10 :82.1%
2025-12-10 16:06:39,714 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:40,595 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:40,596 DeMo.train INFO: Best mAP: 39.2%
2025-12-10 16:06:40,596 DeMo.train INFO: Best Rank-1: 61.1%
2025-12-10 16:06:40,596 DeMo.train INFO: Best Rank-5: 76.8%
2025-12-10 16:06:40,596 DeMo.train INFO: Best Rank-10: 82.4%
2025-12-10 16:06:40,596 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:45,352 DeMo.train INFO: Epoch[11] Iteration[10/16] Loss: 1.789, Acc: 0.439, Base Lr: 5.00e-06
2025-12-10 16:06:46,458 DeMo.train INFO: Epoch 11 done. Time per batch: 0.419[s] Speed: 152.9[samples/s]
2025-12-10 16:06:46,460 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:46,460 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:06:46,460 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:06:53,545 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-10 16:06:53,546 DeMo.train INFO: mAP: 40.3%
2025-12-10 16:06:53,546 DeMo.train INFO: CMC curve, Rank-1  :60.7%
2025-12-10 16:06:53,546 DeMo.train INFO: CMC curve, Rank-5  :77.8%
2025-12-10 16:06:53,546 DeMo.train INFO: CMC curve, Rank-10 :82.1%
2025-12-10 16:06:53,546 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:55,248 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:55,249 DeMo.train INFO: Best mAP: 40.3%
2025-12-10 16:06:55,249 DeMo.train INFO: Best Rank-1: 60.7%
2025-12-10 16:06:55,249 DeMo.train INFO: Best Rank-5: 77.8%
2025-12-10 16:06:55,249 DeMo.train INFO: Best Rank-10: 82.1%
2025-12-10 16:06:55,249 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:06:59,389 DeMo.train INFO: Epoch[12] Iteration[10/16] Loss: 1.747, Acc: 0.458, Base Lr: 5.00e-06
2025-12-10 16:07:00,488 DeMo.train INFO: Epoch 12 done. Time per batch: 0.374[s] Speed: 171.0[samples/s]
2025-12-10 16:07:00,489 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:00,490 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:00,490 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:07,402 DeMo.train INFO: Validation Results - Epoch: 12
2025-12-10 16:07:07,402 DeMo.train INFO: mAP: 42.1%
2025-12-10 16:07:07,402 DeMo.train INFO: CMC curve, Rank-1  :63.5%
2025-12-10 16:07:07,403 DeMo.train INFO: CMC curve, Rank-5  :78.2%
2025-12-10 16:07:07,403 DeMo.train INFO: CMC curve, Rank-10 :82.6%
2025-12-10 16:07:07,403 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:09,204 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:09,205 DeMo.train INFO: Best mAP: 42.1%
2025-12-10 16:07:09,205 DeMo.train INFO: Best Rank-1: 63.5%
2025-12-10 16:07:09,205 DeMo.train INFO: Best Rank-5: 78.2%
2025-12-10 16:07:09,205 DeMo.train INFO: Best Rank-10: 82.6%
2025-12-10 16:07:09,205 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:13,459 DeMo.train INFO: Epoch[13] Iteration[10/16] Loss: 1.683, Acc: 0.516, Base Lr: 5.00e-06
2025-12-10 16:07:14,819 DeMo.train INFO: Epoch 13 done. Time per batch: 0.374[s] Speed: 171.0[samples/s]
2025-12-10 16:07:14,820 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:14,820 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:14,820 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:21,567 DeMo.train INFO: Validation Results - Epoch: 13
2025-12-10 16:07:21,567 DeMo.train INFO: mAP: 43.0%
2025-12-10 16:07:21,567 DeMo.train INFO: CMC curve, Rank-1  :64.1%
2025-12-10 16:07:21,567 DeMo.train INFO: CMC curve, Rank-5  :79.5%
2025-12-10 16:07:21,567 DeMo.train INFO: CMC curve, Rank-10 :82.9%
2025-12-10 16:07:21,567 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:22,091 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:22,091 DeMo.train INFO: Best mAP: 43.0%
2025-12-10 16:07:22,091 DeMo.train INFO: Best Rank-1: 64.1%
2025-12-10 16:07:22,092 DeMo.train INFO: Best Rank-5: 79.5%
2025-12-10 16:07:22,092 DeMo.train INFO: Best Rank-10: 82.9%
2025-12-10 16:07:22,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:26,225 DeMo.train INFO: Epoch[14] Iteration[10/16] Loss: 1.658, Acc: 0.547, Base Lr: 5.00e-06
2025-12-10 16:07:27,331 DeMo.train INFO: Epoch 14 done. Time per batch: 0.374[s] Speed: 171.0[samples/s]
2025-12-10 16:07:27,332 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:27,332 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:27,332 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:34,118 DeMo.train INFO: Validation Results - Epoch: 14
2025-12-10 16:07:34,118 DeMo.train INFO: mAP: 43.5%
2025-12-10 16:07:34,119 DeMo.train INFO: CMC curve, Rank-1  :64.0%
2025-12-10 16:07:34,119 DeMo.train INFO: CMC curve, Rank-5  :80.0%
2025-12-10 16:07:34,119 DeMo.train INFO: CMC curve, Rank-10 :83.4%
2025-12-10 16:07:34,119 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:34,622 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:34,623 DeMo.train INFO: Best mAP: 43.5%
2025-12-10 16:07:34,623 DeMo.train INFO: Best Rank-1: 64.0%
2025-12-10 16:07:34,623 DeMo.train INFO: Best Rank-5: 80.0%
2025-12-10 16:07:34,623 DeMo.train INFO: Best Rank-10: 83.4%
2025-12-10 16:07:34,623 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:38,762 DeMo.train INFO: Epoch[15] Iteration[10/16] Loss: 1.690, Acc: 0.562, Base Lr: 5.00e-06
2025-12-10 16:07:39,850 DeMo.train INFO: Epoch 15 done. Time per batch: 0.373[s] Speed: 171.4[samples/s]
2025-12-10 16:07:39,851 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:39,851 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:39,851 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:07:46,610 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 16:07:46,611 DeMo.train INFO: mAP: 42.9%
2025-12-10 16:07:46,611 DeMo.train INFO: CMC curve, Rank-1  :63.8%
2025-12-10 16:07:46,611 DeMo.train INFO: CMC curve, Rank-5  :78.3%
2025-12-10 16:07:46,611 DeMo.train INFO: CMC curve, Rank-10 :82.7%
2025-12-10 16:07:46,611 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:47,829 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:47,830 DeMo.train INFO: Best mAP: 43.5%
2025-12-10 16:07:47,830 DeMo.train INFO: Best Rank-1: 64.0%
2025-12-10 16:07:47,830 DeMo.train INFO: Best Rank-5: 80.0%
2025-12-10 16:07:47,830 DeMo.train INFO: Best Rank-10: 83.4%
2025-12-10 16:07:47,830 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:52,728 DeMo.train INFO: Epoch[16] Iteration[10/16] Loss: 1.594, Acc: 0.552, Base Lr: 5.00e-06
2025-12-10 16:07:53,910 DeMo.train INFO: Epoch 16 done. Time per batch: 0.434[s] Speed: 147.4[samples/s]
2025-12-10 16:07:53,912 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:07:53,912 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:07:53,912 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:08:00,695 DeMo.train INFO: Validation Results - Epoch: 16
2025-12-10 16:08:00,696 DeMo.train INFO: mAP: 45.2%
2025-12-10 16:08:00,696 DeMo.train INFO: CMC curve, Rank-1  :65.5%
2025-12-10 16:08:00,696 DeMo.train INFO: CMC curve, Rank-5  :80.5%
2025-12-10 16:08:00,696 DeMo.train INFO: CMC curve, Rank-10 :84.9%
2025-12-10 16:08:00,696 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:01,219 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:01,219 DeMo.train INFO: Best mAP: 45.2%
2025-12-10 16:08:01,219 DeMo.train INFO: Best Rank-1: 65.5%
2025-12-10 16:08:01,219 DeMo.train INFO: Best Rank-5: 80.5%
2025-12-10 16:08:01,219 DeMo.train INFO: Best Rank-10: 84.9%
2025-12-10 16:08:01,220 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:06,947 DeMo.train INFO: Epoch[17] Iteration[10/16] Loss: 1.574, Acc: 0.573, Base Lr: 5.00e-06
2025-12-10 16:08:08,042 DeMo.train INFO: Epoch 17 done. Time per batch: 0.487[s] Speed: 131.3[samples/s]
2025-12-10 16:08:08,044 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:08,044 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:08:08,044 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
2025-12-10 16:08:15,012 DeMo.train INFO: Validation Results - Epoch: 17
2025-12-10 16:08:15,012 DeMo.train INFO: mAP: 44.6%
2025-12-10 16:08:15,012 DeMo.train INFO: CMC curve, Rank-1  :65.0%
2025-12-10 16:08:15,012 DeMo.train INFO: CMC curve, Rank-5  :80.9%
2025-12-10 16:08:15,012 DeMo.train INFO: CMC curve, Rank-10 :85.6%
2025-12-10 16:08:15,012 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:16,115 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:16,115 DeMo.train INFO: Best mAP: 45.2%
2025-12-10 16:08:16,115 DeMo.train INFO: Best Rank-1: 65.5%
2025-12-10 16:08:16,115 DeMo.train INFO: Best Rank-5: 80.5%
2025-12-10 16:08:16,116 DeMo.train INFO: Best Rank-10: 84.9%
2025-12-10 16:08:16,116 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:21,125 DeMo.train INFO: Epoch[18] Iteration[10/16] Loss: 1.467, Acc: 0.541, Base Lr: 5.00e-06
2025-12-10 16:08:22,351 DeMo.train INFO: Epoch 18 done. Time per batch: 0.445[s] Speed: 143.7[samples/s]
2025-12-10 16:08:22,352 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:08:22,353 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:08:22,353 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

2025-12-10 16:09:33,151 DeMo INFO: Saving model in the path :..
2025-12-10 16:09:33,152 DeMo INFO: Namespace(config_file='configs/RGBNT201/DeMo_Parallel.yml', exp_name=None, fea_cft=0, local_rank=0, opts=['MODEL.SDTPS_LOSS_WEIGHT', '0.0', 'MODEL.DGAF_LOSS_WEIGHT', '1.0', 'MODEL.FUSED_LOSS_WEIGHT', '0.0'])
2025-12-10 16:09:33,152 DeMo INFO: Loaded configuration file configs/RGBNT201/DeMo_Parallel.yml
2025-12-10 16:09:33,152 DeMo INFO: 
MODEL:
  ARCH: 'DeMo_Parallel'  # 使用并行架构（9个分类头）
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0

  # Global-Local Fusion: 启用（提升特征表达能力）
  GLOBAL_LOCAL: True

  # 禁用旧模块（HDM/ATM）
  HDM: False
  ATM: False
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  USE_LIF: False

  # ========== 并行架构核心参数 ==========
  # SDTPS 配置（分支1）
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.6  # token 保留比例（60%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # Cross-Attention
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_BETA: 0.25         # 保留兼容性
  SDTPS_AGGR_RATIO: 0.5    # 保留兼容性
  SDTPS_LOSS_WEIGHT: 1.0   # SDTPS 分支权重（建议1.0）

  # DGAF 配置（分支2）
  USE_DGAF: True
  DGAF_VERSION: 'v4'  # V4: 返回3个独立特征
  DGAF_TAU: 1.0  # 信息熵门控温度
  DGAF_INIT_ALPHA: 0.5  # IEG 和 MIG 的平衡系数
  DGAF_LOSS_WEIGHT: 1.0  # DGAF 分支权重（建议1.0）

  # Fused 配置（分支3，辅助监督）
  FUSED_LOSS_WEIGHT: 0.5  # Fused 分支权重（建议0.5，辅助作用）

  # ========== 过拟合缓解 ==========
  DROP_OUT: 0.0  # 使用defaults.py中已有的参数
  IF_LABELSMOOTH: 'on'  # Label Smoothing (注意: 必须是字符串 'on' 或 'off')

  HEAD: 4  # 保留兼容性

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5  # random horizontal flip
  RE_PROB: 0.5  # random erasing（数据增强）
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4  # 减小以节省显存（原8）
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.0003  # 初始学习率（可根据需要调整）
  WARMUP_ITERS: 5  # Warmup epochs
  MAX_EPOCHS: 60  # 增加训练轮数（9个分类头需要更多时间）
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 48  # 减小 batch size（9个分类头占用更多显存）
  EVAL_PERIOD: 15
  WEIGHT_DECAY: 0.0005  # 增大正则化

  # ========== 分支权重（在 processor.py 中使用）==========
  # 根据分支索引应用不同权重：
  # - SDTPS (i=0,2,4): SDTPS_LOSS_WEIGHT
  # - DGAF (i=6,8,10): DGAF_LOSS_WEIGHT
  # - Fused (i=12,14,16): FUSED_LOSS_WEIGHT

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"  # 缺失模态测试：'r', 'n', 't', 'rn', 'rt', 'nt', 'nothing'

OUTPUT_DIR: '..'

2025-12-10 16:09:33,153 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT201
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ADAPTER: False
  ARCH: DeMo_Parallel
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_LOSS_WEIGHT: 1.0
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v4
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  FUSED_LOSS_WEIGHT: 0.0
  GLOBAL_LOCAL: True
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 0.0
  SDTPS_SHARE_CROSS_ATTN: False
  SDTPS_SPARSE_RATIO: 0.6
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: True
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: True
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 0.0003
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 15
  GAMMA: 0.1
  IMS_PER_BATCH: 48
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: cosine
  MARGIN: 0.3
  MAX_EPOCHS: 60
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 70)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 5
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGBNT201 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   171 |     3951 |         4
  query    |    30 |      836 |         2
  gallery  |    30 |      836 |         2
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:16 width: 8
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 4
===========Building DeMo_Parallel (9 heads)===========
model has no flops
using soft triplet loss for training
label smooth on, numclasses: 171
2025-12-10 16:09:42,728 DeMo INFO: TensorBoard logging to: logs/tensorboard/DeMo_Parallel_20251210_160942
2025-12-10 16:09:42,729 DeMo INFO: Start TensorBoard with: tensorboard --logdir logs/tensorboard --port 6006
2025-12-10 16:09:42,730 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-10 16:09:49,383 DeMo.train INFO: Epoch[1] Iteration[10/78] Loss: 22.839, Acc: 0.000, Base Lr: 6.24e-05
2025-12-10 16:09:51,723 DeMo.train INFO: Epoch[1] Iteration[20/78] Loss: 19.975, Acc: 0.001, Base Lr: 6.24e-05
2025-12-10 16:09:54,064 DeMo.train INFO: Epoch[1] Iteration[30/78] Loss: 18.772, Acc: 0.003, Base Lr: 6.24e-05
2025-12-10 16:09:56,444 DeMo.train INFO: Epoch[1] Iteration[40/78] Loss: 18.043, Acc: 0.003, Base Lr: 6.24e-05
2025-12-10 16:09:58,830 DeMo.train INFO: Epoch[1] Iteration[50/78] Loss: 17.591, Acc: 0.003, Base Lr: 6.24e-05
2025-12-10 16:10:01,187 DeMo.train INFO: Epoch[1] Iteration[60/78] Loss: 17.222, Acc: 0.004, Base Lr: 6.24e-05
2025-12-10 16:10:03,543 DeMo.train INFO: Epoch[1] Iteration[70/78] Loss: 16.916, Acc: 0.004, Base Lr: 6.24e-05
2025-12-10 16:10:05,283 DeMo.train INFO: Epoch 1 done. Time per batch: 0.293[s] Speed: 164.0[samples/s]
2025-12-10 16:10:08,778 DeMo.train INFO: Epoch[2] Iteration[10/78] Loss: 15.251, Acc: 0.008, Base Lr: 1.22e-04
2025-12-10 16:10:11,143 DeMo.train INFO: Epoch[2] Iteration[20/78] Loss: 14.997, Acc: 0.005, Base Lr: 1.22e-04
2025-12-10 16:10:13,487 DeMo.train INFO: Epoch[2] Iteration[30/78] Loss: 15.063, Acc: 0.005, Base Lr: 1.22e-04
2025-12-10 16:10:15,840 DeMo.train INFO: Epoch[2] Iteration[40/78] Loss: 14.992, Acc: 0.004, Base Lr: 1.22e-04
2025-12-10 16:10:18,205 DeMo.train INFO: Epoch[2] Iteration[50/78] Loss: 14.923, Acc: 0.003, Base Lr: 1.22e-04
2025-12-10 16:10:20,544 DeMo.train INFO: Epoch[2] Iteration[60/78] Loss: 14.831, Acc: 0.003, Base Lr: 1.22e-04
2025-12-10 16:10:22,878 DeMo.train INFO: Epoch[2] Iteration[70/78] Loss: 14.734, Acc: 0.004, Base Lr: 1.22e-04
2025-12-10 16:10:24,614 DeMo.train INFO: Epoch 2 done. Time per batch: 0.251[s] Speed: 191.2[samples/s]
2025-12-10 16:10:28,129 DeMo.train INFO: Epoch[3] Iteration[10/78] Loss: 13.885, Acc: 0.006, Base Lr: 1.81e-04
2025-12-10 16:10:30,538 DeMo.train INFO: Epoch[3] Iteration[20/78] Loss: 13.755, Acc: 0.004, Base Lr: 1.81e-04
2025-12-10 16:10:32,890 DeMo.train INFO: Epoch[3] Iteration[30/78] Loss: 13.880, Acc: 0.005, Base Lr: 1.81e-04
2025-12-10 16:10:35,259 DeMo.train INFO: Epoch[3] Iteration[40/78] Loss: 13.953, Acc: 0.006, Base Lr: 1.81e-04
2025-12-10 16:10:37,625 DeMo.train INFO: Epoch[3] Iteration[50/78] Loss: 13.900, Acc: 0.008, Base Lr: 1.81e-04
2025-12-10 16:10:39,977 DeMo.train INFO: Epoch[3] Iteration[60/78] Loss: 13.814, Acc: 0.007, Base Lr: 1.81e-04
2025-12-10 16:10:42,314 DeMo.train INFO: Epoch[3] Iteration[70/78] Loss: 13.741, Acc: 0.009, Base Lr: 1.81e-04
2025-12-10 16:10:43,973 DeMo.train INFO: Epoch 3 done. Time per batch: 0.255[s] Speed: 188.4[samples/s]
2025-12-10 16:10:47,832 DeMo.train INFO: Epoch[4] Iteration[10/78] Loss: 12.346, Acc: 0.010, Base Lr: 2.41e-04
2025-12-10 16:10:50,216 DeMo.train INFO: Epoch[4] Iteration[20/78] Loss: 12.560, Acc: 0.005, Base Lr: 2.41e-04
2025-12-10 16:10:52,587 DeMo.train INFO: Epoch[4] Iteration[30/78] Loss: 12.704, Acc: 0.005, Base Lr: 2.41e-04
2025-12-10 16:10:54,957 DeMo.train INFO: Epoch[4] Iteration[40/78] Loss: 12.655, Acc: 0.005, Base Lr: 2.41e-04
2025-12-10 16:10:57,320 DeMo.train INFO: Epoch[4] Iteration[50/78] Loss: 12.549, Acc: 0.006, Base Lr: 2.41e-04
2025-12-10 16:10:59,669 DeMo.train INFO: Epoch[4] Iteration[60/78] Loss: 12.495, Acc: 0.006, Base Lr: 2.41e-04
2025-12-10 16:11:02,007 DeMo.train INFO: Epoch[4] Iteration[70/78] Loss: 12.401, Acc: 0.005, Base Lr: 2.41e-04
2025-12-10 16:11:03,517 DeMo.train INFO: Epoch 4 done. Time per batch: 0.257[s] Speed: 186.7[samples/s]
2025-12-10 16:11:06,906 DeMo.train INFO: Epoch[5] Iteration[10/78] Loss: 12.355, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:11:09,280 DeMo.train INFO: Epoch[5] Iteration[20/78] Loss: 12.075, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:11:11,654 DeMo.train INFO: Epoch[5] Iteration[30/78] Loss: 12.098, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:11:14,003 DeMo.train INFO: Epoch[5] Iteration[40/78] Loss: 12.060, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:11:16,387 DeMo.train INFO: Epoch[5] Iteration[50/78] Loss: 11.984, Acc: 0.005, Base Lr: 3.00e-04
2025-12-10 16:11:18,741 DeMo.train INFO: Epoch[5] Iteration[60/78] Loss: 11.862, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:11:21,100 DeMo.train INFO: Epoch[5] Iteration[70/78] Loss: 11.875, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:11:22,865 DeMo.train INFO: Epoch 5 done. Time per batch: 0.251[s] Speed: 191.0[samples/s]
2025-12-10 16:11:26,329 DeMo.train INFO: Epoch[6] Iteration[10/78] Loss: 10.317, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:11:29,528 DeMo.train INFO: Epoch[6] Iteration[20/78] Loss: 10.579, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:11:31,893 DeMo.train INFO: Epoch[6] Iteration[30/78] Loss: 10.578, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:11:34,253 DeMo.train INFO: Epoch[6] Iteration[40/78] Loss: 10.522, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:11:36,640 DeMo.train INFO: Epoch[6] Iteration[50/78] Loss: 10.461, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:11:38,992 DeMo.train INFO: Epoch[6] Iteration[60/78] Loss: 10.388, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:11:41,341 DeMo.train INFO: Epoch[6] Iteration[70/78] Loss: 10.321, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:11:43,091 DeMo.train INFO: Epoch 6 done. Time per batch: 0.263[s] Speed: 182.7[samples/s]
2025-12-10 16:11:46,447 DeMo.train INFO: Epoch[7] Iteration[10/78] Loss: 9.616, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:11:48,840 DeMo.train INFO: Epoch[7] Iteration[20/78] Loss: 9.534, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:11:51,209 DeMo.train INFO: Epoch[7] Iteration[30/78] Loss: 9.381, Acc: 0.011, Base Lr: 3.00e-04
2025-12-10 16:11:53,561 DeMo.train INFO: Epoch[7] Iteration[40/78] Loss: 9.361, Acc: 0.010, Base Lr: 3.00e-04
2025-12-10 16:11:55,944 DeMo.train INFO: Epoch[7] Iteration[50/78] Loss: 9.242, Acc: 0.010, Base Lr: 3.00e-04
2025-12-10 16:11:58,287 DeMo.train INFO: Epoch[7] Iteration[60/78] Loss: 9.264, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:12:00,646 DeMo.train INFO: Epoch[7] Iteration[70/78] Loss: 9.248, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:12:02,430 DeMo.train INFO: Epoch 7 done. Time per batch: 0.251[s] Speed: 191.1[samples/s]
2025-12-10 16:12:05,815 DeMo.train INFO: Epoch[8] Iteration[10/78] Loss: 9.046, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:12:08,501 DeMo.train INFO: Epoch[8] Iteration[20/78] Loss: 8.525, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:12:11,011 DeMo.train INFO: Epoch[8] Iteration[30/78] Loss: 8.341, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:12:13,383 DeMo.train INFO: Epoch[8] Iteration[40/78] Loss: 8.222, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:12:15,740 DeMo.train INFO: Epoch[8] Iteration[50/78] Loss: 8.138, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:12:18,082 DeMo.train INFO: Epoch[8] Iteration[60/78] Loss: 8.158, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:12:20,407 DeMo.train INFO: Epoch[8] Iteration[70/78] Loss: 8.147, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:12:22,167 DeMo.train INFO: Epoch 8 done. Time per batch: 0.256[s] Speed: 187.3[samples/s]
2025-12-10 16:12:25,533 DeMo.train INFO: Epoch[9] Iteration[10/78] Loss: 8.023, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:12:27,890 DeMo.train INFO: Epoch[9] Iteration[20/78] Loss: 8.069, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:12:30,258 DeMo.train INFO: Epoch[9] Iteration[30/78] Loss: 7.893, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:12:32,623 DeMo.train INFO: Epoch[9] Iteration[40/78] Loss: 7.751, Acc: 0.002, Base Lr: 3.00e-04
2025-12-10 16:12:34,984 DeMo.train INFO: Epoch[9] Iteration[50/78] Loss: 7.737, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:12:37,352 DeMo.train INFO: Epoch[9] Iteration[60/78] Loss: 7.683, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:12:39,705 DeMo.train INFO: Epoch[9] Iteration[70/78] Loss: 7.646, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:12:41,241 DeMo.train INFO: Epoch 9 done. Time per batch: 0.251[s] Speed: 191.3[samples/s]
2025-12-10 16:12:44,627 DeMo.train INFO: Epoch[10] Iteration[10/78] Loss: 6.386, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:12:46,998 DeMo.train INFO: Epoch[10] Iteration[20/78] Loss: 6.532, Acc: 0.013, Base Lr: 3.00e-04
2025-12-10 16:12:49,399 DeMo.train INFO: Epoch[10] Iteration[30/78] Loss: 6.917, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:12:51,770 DeMo.train INFO: Epoch[10] Iteration[40/78] Loss: 6.984, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:12:54,130 DeMo.train INFO: Epoch[10] Iteration[50/78] Loss: 6.975, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:12:56,493 DeMo.train INFO: Epoch[10] Iteration[60/78] Loss: 6.986, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:12:58,842 DeMo.train INFO: Epoch[10] Iteration[70/78] Loss: 6.949, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:13:00,595 DeMo.train INFO: Epoch 10 done. Time per batch: 0.251[s] Speed: 191.0[samples/s]
2025-12-10 16:13:03,894 DeMo.train INFO: Epoch[11] Iteration[10/78] Loss: 6.707, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:13:06,449 DeMo.train INFO: Epoch[11] Iteration[20/78] Loss: 6.377, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:13:08,805 DeMo.train INFO: Epoch[11] Iteration[30/78] Loss: 6.552, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:13:11,180 DeMo.train INFO: Epoch[11] Iteration[40/78] Loss: 6.577, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:13:13,547 DeMo.train INFO: Epoch[11] Iteration[50/78] Loss: 6.469, Acc: 0.010, Base Lr: 3.00e-04
2025-12-10 16:13:15,922 DeMo.train INFO: Epoch[11] Iteration[60/78] Loss: 6.431, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:13:18,265 DeMo.train INFO: Epoch[11] Iteration[70/78] Loss: 6.413, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:13:20,021 DeMo.train INFO: Epoch 11 done. Time per batch: 0.252[s] Speed: 190.3[samples/s]
2025-12-10 16:13:23,461 DeMo.train INFO: Epoch[12] Iteration[10/78] Loss: 6.289, Acc: 0.017, Base Lr: 3.00e-04
2025-12-10 16:13:25,837 DeMo.train INFO: Epoch[12] Iteration[20/78] Loss: 6.374, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:13:28,186 DeMo.train INFO: Epoch[12] Iteration[30/78] Loss: 6.285, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:13:30,579 DeMo.train INFO: Epoch[12] Iteration[40/78] Loss: 6.396, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:13:32,950 DeMo.train INFO: Epoch[12] Iteration[50/78] Loss: 6.357, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:13:35,297 DeMo.train INFO: Epoch[12] Iteration[60/78] Loss: 6.210, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:13:37,639 DeMo.train INFO: Epoch[12] Iteration[70/78] Loss: 6.168, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:13:39,403 DeMo.train INFO: Epoch 12 done. Time per batch: 0.252[s] Speed: 190.7[samples/s]
2025-12-10 16:13:42,716 DeMo.train INFO: Epoch[13] Iteration[10/78] Loss: 5.295, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:13:45,099 DeMo.train INFO: Epoch[13] Iteration[20/78] Loss: 5.368, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:13:47,482 DeMo.train INFO: Epoch[13] Iteration[30/78] Loss: 5.219, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:13:49,879 DeMo.train INFO: Epoch[13] Iteration[40/78] Loss: 5.322, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:13:52,244 DeMo.train INFO: Epoch[13] Iteration[50/78] Loss: 5.444, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:13:54,600 DeMo.train INFO: Epoch[13] Iteration[60/78] Loss: 5.475, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:13:56,954 DeMo.train INFO: Epoch[13] Iteration[70/78] Loss: 5.563, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:13:58,806 DeMo.train INFO: Epoch 13 done. Time per batch: 0.252[s] Speed: 190.5[samples/s]
2025-12-10 16:14:02,628 DeMo.train INFO: Epoch[14] Iteration[10/78] Loss: 5.304, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:14:04,988 DeMo.train INFO: Epoch[14] Iteration[20/78] Loss: 5.119, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:14:07,341 DeMo.train INFO: Epoch[14] Iteration[30/78] Loss: 5.193, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:14:09,707 DeMo.train INFO: Epoch[14] Iteration[40/78] Loss: 5.224, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:14:12,067 DeMo.train INFO: Epoch[14] Iteration[50/78] Loss: 5.249, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:14:14,423 DeMo.train INFO: Epoch[14] Iteration[60/78] Loss: 5.218, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:14:16,772 DeMo.train INFO: Epoch[14] Iteration[70/78] Loss: 5.248, Acc: 0.005, Base Lr: 3.00e-04
2025-12-10 16:14:18,308 DeMo.train INFO: Epoch 14 done. Time per batch: 0.257[s] Speed: 187.1[samples/s]
2025-12-10 16:14:22,299 DeMo.train INFO: Epoch[15] Iteration[10/78] Loss: 5.248, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:14:24,692 DeMo.train INFO: Epoch[15] Iteration[20/78] Loss: 5.482, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:14:27,039 DeMo.train INFO: Epoch[15] Iteration[30/78] Loss: 5.538, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:14:29,417 DeMo.train INFO: Epoch[15] Iteration[40/78] Loss: 5.540, Acc: 0.002, Base Lr: 3.00e-04
2025-12-10 16:14:31,789 DeMo.train INFO: Epoch[15] Iteration[50/78] Loss: 5.419, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:14:34,141 DeMo.train INFO: Epoch[15] Iteration[60/78] Loss: 5.458, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:14:36,484 DeMo.train INFO: Epoch[15] Iteration[70/78] Loss: 5.446, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:14:38,235 DeMo.train INFO: Epoch 15 done. Time per batch: 0.259[s] Speed: 185.5[samples/s]
2025-12-10 16:14:38,237 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:14:38,237 DeMo.train INFO: Current is the ori feature testing!
2025-12-10 16:14:38,237 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 16:14:44,276 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 16:14:44,277 DeMo.train INFO: mAP: 40.7%
2025-12-10 16:14:44,277 DeMo.train INFO: CMC curve, Rank-1  :41.3%
2025-12-10 16:14:44,277 DeMo.train INFO: CMC curve, Rank-5  :57.7%
2025-12-10 16:14:44,277 DeMo.train INFO: CMC curve, Rank-10 :67.1%
2025-12-10 16:14:44,277 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:14:45,340 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:14:45,340 DeMo.train INFO: Current is the moe feature testing!
2025-12-10 16:14:45,340 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 16:14:51,527 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 16:14:51,527 DeMo.train INFO: mAP: 40.7%
2025-12-10 16:14:51,527 DeMo.train INFO: CMC curve, Rank-1  :41.3%
2025-12-10 16:14:51,527 DeMo.train INFO: CMC curve, Rank-5  :57.7%
2025-12-10 16:14:51,527 DeMo.train INFO: CMC curve, Rank-10 :67.1%
2025-12-10 16:14:51,527 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:14:52,541 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:14:52,541 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-10 16:14:52,541 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-10 16:14:58,699 DeMo.train INFO: Validation Results - Epoch: 15
2025-12-10 16:14:58,699 DeMo.train INFO: mAP: 40.7%
2025-12-10 16:14:58,699 DeMo.train INFO: CMC curve, Rank-1  :41.3%
2025-12-10 16:14:58,700 DeMo.train INFO: CMC curve, Rank-5  :57.7%
2025-12-10 16:14:58,700 DeMo.train INFO: CMC curve, Rank-10 :67.1%
2025-12-10 16:14:58,700 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:15:00,057 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:15:00,057 DeMo.train INFO: Best mAP: 40.7%
2025-12-10 16:15:00,057 DeMo.train INFO: Best Rank-1: 41.3%
2025-12-10 16:15:00,057 DeMo.train INFO: Best Rank-5: 57.7%
2025-12-10 16:15:00,058 DeMo.train INFO: Best Rank-10: 67.1%
2025-12-10 16:15:00,058 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-10 16:15:04,331 DeMo.train INFO: Epoch[16] Iteration[10/78] Loss: 4.983, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:15:06,702 DeMo.train INFO: Epoch[16] Iteration[20/78] Loss: 4.762, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:15:09,059 DeMo.train INFO: Epoch[16] Iteration[30/78] Loss: 4.699, Acc: 0.017, Base Lr: 3.00e-04
2025-12-10 16:15:11,427 DeMo.train INFO: Epoch[16] Iteration[40/78] Loss: 4.764, Acc: 0.013, Base Lr: 3.00e-04
2025-12-10 16:15:13,778 DeMo.train INFO: Epoch[16] Iteration[50/78] Loss: 4.755, Acc: 0.010, Base Lr: 3.00e-04
2025-12-10 16:15:16,132 DeMo.train INFO: Epoch[16] Iteration[60/78] Loss: 4.766, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:15:18,485 DeMo.train INFO: Epoch[16] Iteration[70/78] Loss: 4.816, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:15:20,015 DeMo.train INFO: Epoch 16 done. Time per batch: 0.263[s] Speed: 182.8[samples/s]
2025-12-10 16:15:23,930 DeMo.train INFO: Epoch[17] Iteration[10/78] Loss: 5.111, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:15:26,309 DeMo.train INFO: Epoch[17] Iteration[20/78] Loss: 4.922, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:15:28,688 DeMo.train INFO: Epoch[17] Iteration[30/78] Loss: 4.743, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:15:31,068 DeMo.train INFO: Epoch[17] Iteration[40/78] Loss: 4.845, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:15:33,431 DeMo.train INFO: Epoch[17] Iteration[50/78] Loss: 4.835, Acc: 0.005, Base Lr: 3.00e-04
2025-12-10 16:15:35,816 DeMo.train INFO: Epoch[17] Iteration[60/78] Loss: 4.746, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:15:38,192 DeMo.train INFO: Epoch[17] Iteration[70/78] Loss: 4.737, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:15:39,960 DeMo.train INFO: Epoch 17 done. Time per batch: 0.259[s] Speed: 185.3[samples/s]
2025-12-10 16:15:43,423 DeMo.train INFO: Epoch[18] Iteration[10/78] Loss: 4.239, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:15:45,802 DeMo.train INFO: Epoch[18] Iteration[20/78] Loss: 4.137, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:15:48,179 DeMo.train INFO: Epoch[18] Iteration[30/78] Loss: 4.255, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:15:50,563 DeMo.train INFO: Epoch[18] Iteration[40/78] Loss: 4.265, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:15:52,924 DeMo.train INFO: Epoch[18] Iteration[50/78] Loss: 4.367, Acc: 0.005, Base Lr: 3.00e-04
2025-12-10 16:15:55,303 DeMo.train INFO: Epoch[18] Iteration[60/78] Loss: 4.421, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:15:57,696 DeMo.train INFO: Epoch[18] Iteration[70/78] Loss: 4.470, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:15:59,455 DeMo.train INFO: Epoch 18 done. Time per batch: 0.253[s] Speed: 189.6[samples/s]
2025-12-10 16:16:02,857 DeMo.train INFO: Epoch[19] Iteration[10/78] Loss: 4.732, Acc: 0.000, Base Lr: 3.00e-04
2025-12-10 16:16:05,231 DeMo.train INFO: Epoch[19] Iteration[20/78] Loss: 4.633, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:16:07,588 DeMo.train INFO: Epoch[19] Iteration[30/78] Loss: 4.642, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:16:09,948 DeMo.train INFO: Epoch[19] Iteration[40/78] Loss: 4.598, Acc: 0.002, Base Lr: 3.00e-04
2025-12-10 16:16:12,313 DeMo.train INFO: Epoch[19] Iteration[50/78] Loss: 4.555, Acc: 0.002, Base Lr: 3.00e-04
2025-12-10 16:16:14,671 DeMo.train INFO: Epoch[19] Iteration[60/78] Loss: 4.552, Acc: 0.003, Base Lr: 3.00e-04
2025-12-10 16:16:17,055 DeMo.train INFO: Epoch[19] Iteration[70/78] Loss: 4.575, Acc: 0.004, Base Lr: 3.00e-04
2025-12-10 16:16:18,820 DeMo.train INFO: Epoch 19 done. Time per batch: 0.251[s] Speed: 190.9[samples/s]
2025-12-10 16:16:22,198 DeMo.train INFO: Epoch[20] Iteration[10/78] Loss: 4.356, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:16:24,555 DeMo.train INFO: Epoch[20] Iteration[20/78] Loss: 4.437, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:16:26,900 DeMo.train INFO: Epoch[20] Iteration[30/78] Loss: 4.397, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:16:29,280 DeMo.train INFO: Epoch[20] Iteration[40/78] Loss: 4.397, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:16:31,650 DeMo.train INFO: Epoch[20] Iteration[50/78] Loss: 4.338, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:16:34,005 DeMo.train INFO: Epoch[20] Iteration[60/78] Loss: 4.315, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:16:36,387 DeMo.train INFO: Epoch[20] Iteration[70/78] Loss: 4.291, Acc: 0.007, Base Lr: 3.00e-04
2025-12-10 16:16:38,144 DeMo.train INFO: Epoch 20 done. Time per batch: 0.251[s] Speed: 191.3[samples/s]
2025-12-10 16:16:41,596 DeMo.train INFO: Epoch[21] Iteration[10/78] Loss: 4.178, Acc: 0.017, Base Lr: 3.00e-04
2025-12-10 16:16:43,962 DeMo.train INFO: Epoch[21] Iteration[20/78] Loss: 4.209, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:16:46,333 DeMo.train INFO: Epoch[21] Iteration[30/78] Loss: 4.071, Acc: 0.006, Base Lr: 3.00e-04
2025-12-10 16:16:48,726 DeMo.train INFO: Epoch[21] Iteration[40/78] Loss: 4.030, Acc: 0.010, Base Lr: 3.00e-04
2025-12-10 16:16:51,092 DeMo.train INFO: Epoch[21] Iteration[50/78] Loss: 4.014, Acc: 0.010, Base Lr: 3.00e-04
2025-12-10 16:16:53,456 DeMo.train INFO: Epoch[21] Iteration[60/78] Loss: 3.996, Acc: 0.008, Base Lr: 3.00e-04
2025-12-10 16:16:55,824 DeMo.train INFO: Epoch[21] Iteration[70/78] Loss: 4.060, Acc: 0.007, Base Lr: 3.00e-04

2025-12-11 09:53:21,544 DeMo INFO: Saving model in the path :..
2025-12-11 09:53:21,544 DeMo INFO: Namespace(config_file='configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml', exp_name=None, fea_cft=0, local_rank=0, opts=['MODEL.USE_SDTPS', 'False', 'MODEL.GLOBAL_LOCAL', 'False', 'MODEL.USE_FRCA', 'False', 'MODEL.USE_DGAF', 'True', 'MODEL.DGAF_VERSION', 'v3'])
2025-12-11 09:53:21,545 DeMo INFO: Loaded configuration file configs/RGBNT201/DeMo_SDTPS_DGAF_ablation.yml
2025-12-11 09:53:21,545 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: False  # DGAF V3 直接用 tokens，不需要 GLOBAL_LOCAL
  # Disable HDM and ATM
  HDM: False
  ATM: False
  # SACR disabled for ablation
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  # LIF disabled
  USE_LIF: False
  # SDTPS configuration
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.7  # token 保留比例（70%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # 使用 Cross-Attention（推荐）
  SDTPS_CROSS_ATTN_HEADS: 4  # Cross-Attention 头数
  # 已废弃参数（保留兼容性）
  SDTPS_BETA: 0.25         # 已不使用（原 MLP predictor 权重）
  SDTPS_AGGR_RATIO: 0.5    # 已不使用（原 TokenAggregation）
  SDTPS_LOSS_WEIGHT: 2.0   # SDTPS 分支的损失权重
  # DGAF: Dual-Gated Adaptive Fusion
  USE_DGAF: True
  DGAF_VERSION: 'v3'  # V3 接受 (B,N,C) tokens
  DGAF_TAU: 1.0
  DGAF_INIT_ALPHA: 0.5
  DGAF_NUM_HEADS: 8
  HEAD: 4

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 8
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.000005
  LR_SCHEDULER: 'linear'
  MAX_EPOCHS: 50
  STEPS: [30, 40]
  GAMMA: 0.1
  WARMUP_ITERS: 0
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: 'linear'
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  CHECKPOINT_PERIOD: 10

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'

# ============================================================================
# SDTPS + DGAF Ablation Config
# ============================================================================
# - SACR: disabled
# - SDTPS: configurable via command line
# - DGAF V3: configurable via command line
# - Training: lr=0.00035, epochs=50, warmup=10
# - TF32: enabled in train_net.py
# ============================================================================

2025-12-11 09:53:21,545 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 8
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT201
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ADAPTER: False
  ARCH: DeMo
  ATM: False
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DGAF_INIT_ALPHA: 0.5
  DGAF_LOSS_WEIGHT: 1.0
  DGAF_NUM_HEADS: 8
  DGAF_TAU: 1.0
  DGAF_VERSION: v3
  DIRECT: 1
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FRCA_NEGATIVE_SLOPE: 0.1
  FROZEN: False
  FUSED_LOSS_WEIGHT: 0.5
  GLOBAL_LOCAL: False
  HDM: False
  HEAD: 4
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LIF_BETA: 0.4
  LIF_LAYER: 3
  LIF_LOSS_WEIGHT: 0.1
  METRIC_LOSS_TYPE: triplet
  MULTIMODAL_SACR_VERSION: v1
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SACR_DILATION_RATES: [2, 3, 4]
  SDTPS_AGGR_RATIO: 0.5
  SDTPS_BETA: 0.25
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_CROSS_ATTN_TYPE: attention
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_LOSS_WEIGHT: 2.0
  SDTPS_SHARE_CROSS_ATTN: False
  SDTPS_SPARSE_RATIO: 0.7
  SDTPS_USE_GUMBEL: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
  USE_DGAF: True
  USE_FRCA: False
  USE_LIF: False
  USE_MULTIMODAL_SACR: False
  USE_SACR: False
  USE_SDTPS: False
OUTPUT_DIR: ..
SOLVER:
  BASE_LR: 5e-06
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  LR_SCHEDULER: linear
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (30, 40)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 0
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGBNT201 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   171 |     3951 |         4
  query    |    30 |      836 |         2
  gallery  |    30 |      836 |         2
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:16 width: 8
Successfully load ckpt!
<All keys matched successfully>
Loading pretrained model from CLIP
camera number is : 4
===========Building DeMo===========
2025-12-11 09:53:30,986 DeMo INFO: DeMo(
  (BACKBONE): build_transformer(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (dgaf): DualGatedAdaptiveFusionV3(
    (attn_pool): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (attn_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (entropy_proj): Linear(in_features=512, out_features=512, bias=True)
    (gate_net): Sequential(
      (0): Linear(in_features=1536, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (2): ReLU(inplace=True)
      (3): Linear(in_features=512, out_features=3, bias=True)
      (4): Sigmoid()
    )
    (modal_enhance): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classifier_dgaf): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck_dgaf): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier): Linear(in_features=1536, out_features=171, bias=False)
  (bottleneck): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-12-11 09:53:30,987 DeMo INFO: number of parameters:90.621444
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/raid/yij/icme/demo2new/DeMo2/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
Unsupported operator aten::log encountered 3 time(s)
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
BACKBONE.base.transformer.resblocks.0.attn.out_proj, BACKBONE.base.transformer.resblocks.1.attn.out_proj, BACKBONE.base.transformer.resblocks.10.attn.out_proj, BACKBONE.base.transformer.resblocks.11.attn.out_proj, BACKBONE.base.transformer.resblocks.2.attn.out_proj, BACKBONE.base.transformer.resblocks.3.attn.out_proj, BACKBONE.base.transformer.resblocks.4.attn.out_proj, BACKBONE.base.transformer.resblocks.5.attn.out_proj, BACKBONE.base.transformer.resblocks.6.attn.out_proj, BACKBONE.base.transformer.resblocks.7.attn.out_proj, BACKBONE.base.transformer.resblocks.8.attn.out_proj, BACKBONE.base.transformer.resblocks.9.attn.out_proj, bottleneck, bottleneck_dgaf, classifier, classifier_dgaf, dgaf.attn_pool.out_proj, nir_reduce, nir_reduce.0, nir_reduce.1, nir_reduce.2, pool, rgb_reduce, rgb_reduce.0, rgb_reduce.1, rgb_reduce.2, tir_reduce, tir_reduce.0, tir_reduce.1, tir_reduce.2
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Note: out_proj is calculated in MultiheadAttention.forward(), ignore it
Note: bottleneck/classifier not used in inference, ignore it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:53:32,643 DeMo INFO: number of GFLOPs: 34.48054893099999
using soft triplet loss for training
label smooth on, numclasses: 171
2025-12-11 09:53:32,669 DeMo INFO: TensorBoard logging to: logs/tensorboard/DeMo_SDTPS_DGAF_ablation_20251211_095332
2025-12-11 09:53:32,669 DeMo INFO: Start TensorBoard with: tensorboard --logdir logs/tensorboard --port 6006
2025-12-11 09:53:32,670 DeMo.train INFO: start training
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/yij/miniconda3/envs/DeMo/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-12-11 09:53:36,819 DeMo.train INFO: Epoch[1] Iteration[10/54] Loss: 5.009, Acc: 0.006, Base Lr: 5.00e-06
2025-12-11 09:53:39,244 DeMo.train INFO: Epoch[1] Iteration[20/54] Loss: 3.738, Acc: 0.003, Base Lr: 5.00e-06
2025-12-11 09:53:41,662 DeMo.train INFO: Epoch[1] Iteration[30/54] Loss: 3.242, Acc: 0.004, Base Lr: 5.00e-06
2025-12-11 09:53:44,111 DeMo.train INFO: Epoch[1] Iteration[40/54] Loss: 2.927, Acc: 0.007, Base Lr: 5.00e-06
2025-12-11 09:53:46,545 DeMo.train INFO: Epoch[1] Iteration[50/54] Loss: 2.746, Acc: 0.006, Base Lr: 5.00e-06
2025-12-11 09:53:47,408 DeMo.train INFO: Epoch 1 done. Time per batch: 0.278[s] Speed: 230.3[samples/s]
2025-12-11 09:53:47,409 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:53:47,409 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:53:47,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:53:52,431 DeMo.train INFO: Validation Results - Epoch: 1
2025-12-11 09:53:52,431 DeMo.train INFO: mAP: 26.3%
2025-12-11 09:53:52,431 DeMo.train INFO: CMC curve, Rank-1  :27.0%
2025-12-11 09:53:52,431 DeMo.train INFO: CMC curve, Rank-5  :46.7%
2025-12-11 09:53:52,432 DeMo.train INFO: CMC curve, Rank-10 :58.0%
2025-12-11 09:53:52,432 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:53:52,925 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:53:52,925 DeMo.train INFO: Best mAP: 26.3%
2025-12-11 09:53:52,926 DeMo.train INFO: Best Rank-1: 27.0%
2025-12-11 09:53:52,926 DeMo.train INFO: Best Rank-5: 46.7%
2025-12-11 09:53:52,926 DeMo.train INFO: Best Rank-10: 58.0%
2025-12-11 09:53:52,926 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:53:56,696 DeMo.train INFO: Epoch[2] Iteration[10/54] Loss: 1.827, Acc: 0.028, Base Lr: 5.00e-06
2025-12-11 09:53:59,127 DeMo.train INFO: Epoch[2] Iteration[20/54] Loss: 1.799, Acc: 0.031, Base Lr: 5.00e-06
2025-12-11 09:54:01,542 DeMo.train INFO: Epoch[2] Iteration[30/54] Loss: 1.786, Acc: 0.043, Base Lr: 5.00e-06
2025-12-11 09:54:03,974 DeMo.train INFO: Epoch[2] Iteration[40/54] Loss: 1.762, Acc: 0.054, Base Lr: 5.00e-06
2025-12-11 09:54:06,410 DeMo.train INFO: Epoch[2] Iteration[50/54] Loss: 1.739, Acc: 0.065, Base Lr: 5.00e-06
2025-12-11 09:54:07,331 DeMo.train INFO: Epoch 2 done. Time per batch: 0.272[s] Speed: 235.5[samples/s]
2025-12-11 09:54:07,333 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:07,333 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:54:07,333 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:54:11,892 DeMo.train INFO: Validation Results - Epoch: 2
2025-12-11 09:54:11,893 DeMo.train INFO: mAP: 49.1%
2025-12-11 09:54:11,893 DeMo.train INFO: CMC curve, Rank-1  :51.6%
2025-12-11 09:54:11,893 DeMo.train INFO: CMC curve, Rank-5  :66.4%
2025-12-11 09:54:11,893 DeMo.train INFO: CMC curve, Rank-10 :74.0%
2025-12-11 09:54:11,893 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:12,440 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:12,440 DeMo.train INFO: Best mAP: 49.1%
2025-12-11 09:54:12,440 DeMo.train INFO: Best Rank-1: 51.6%
2025-12-11 09:54:12,440 DeMo.train INFO: Best Rank-5: 66.4%
2025-12-11 09:54:12,440 DeMo.train INFO: Best Rank-10: 74.0%
2025-12-11 09:54:12,441 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:15,957 DeMo.train INFO: Epoch[3] Iteration[10/54] Loss: 1.591, Acc: 0.195, Base Lr: 5.00e-06
2025-12-11 09:54:18,396 DeMo.train INFO: Epoch[3] Iteration[20/54] Loss: 1.584, Acc: 0.225, Base Lr: 5.00e-06
2025-12-11 09:54:20,812 DeMo.train INFO: Epoch[3] Iteration[30/54] Loss: 1.568, Acc: 0.235, Base Lr: 5.00e-06
2025-12-11 09:54:23,246 DeMo.train INFO: Epoch[3] Iteration[40/54] Loss: 1.558, Acc: 0.231, Base Lr: 5.00e-06
2025-12-11 09:54:25,687 DeMo.train INFO: Epoch[3] Iteration[50/54] Loss: 1.566, Acc: 0.241, Base Lr: 5.00e-06
2025-12-11 09:54:26,554 DeMo.train INFO: Epoch 3 done. Time per batch: 0.266[s] Speed: 240.3[samples/s]
2025-12-11 09:54:26,556 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:26,556 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:54:26,556 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:54:31,225 DeMo.train INFO: Validation Results - Epoch: 3
2025-12-11 09:54:31,225 DeMo.train INFO: mAP: 58.9%
2025-12-11 09:54:31,226 DeMo.train INFO: CMC curve, Rank-1  :62.0%
2025-12-11 09:54:31,226 DeMo.train INFO: CMC curve, Rank-5  :76.6%
2025-12-11 09:54:31,226 DeMo.train INFO: CMC curve, Rank-10 :83.6%
2025-12-11 09:54:31,226 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:31,811 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:31,811 DeMo.train INFO: Best mAP: 58.9%
2025-12-11 09:54:31,811 DeMo.train INFO: Best Rank-1: 62.0%
2025-12-11 09:54:31,811 DeMo.train INFO: Best Rank-5: 76.6%
2025-12-11 09:54:31,811 DeMo.train INFO: Best Rank-10: 83.6%
2025-12-11 09:54:31,811 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:36,809 DeMo.train INFO: Epoch[4] Iteration[10/54] Loss: 1.417, Acc: 0.398, Base Lr: 5.00e-06
2025-12-11 09:54:39,257 DeMo.train INFO: Epoch[4] Iteration[20/54] Loss: 1.391, Acc: 0.380, Base Lr: 5.00e-06
2025-12-11 09:54:41,674 DeMo.train INFO: Epoch[4] Iteration[30/54] Loss: 1.416, Acc: 0.394, Base Lr: 5.00e-06
2025-12-11 09:54:44,111 DeMo.train INFO: Epoch[4] Iteration[40/54] Loss: 1.407, Acc: 0.426, Base Lr: 5.00e-06
2025-12-11 09:54:46,549 DeMo.train INFO: Epoch[4] Iteration[50/54] Loss: 1.409, Acc: 0.446, Base Lr: 5.00e-06
2025-12-11 09:54:47,393 DeMo.train INFO: Epoch 4 done. Time per batch: 0.294[s] Speed: 217.7[samples/s]
2025-12-11 09:54:47,395 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:47,395 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:54:47,395 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:54:52,968 DeMo.train INFO: Validation Results - Epoch: 4
2025-12-11 09:54:52,968 DeMo.train INFO: mAP: 59.9%
2025-12-11 09:54:52,969 DeMo.train INFO: CMC curve, Rank-1  :61.8%
2025-12-11 09:54:52,969 DeMo.train INFO: CMC curve, Rank-5  :77.0%
2025-12-11 09:54:52,969 DeMo.train INFO: CMC curve, Rank-10 :84.1%
2025-12-11 09:54:52,969 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:53,502 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:53,502 DeMo.train INFO: Best mAP: 59.9%
2025-12-11 09:54:53,502 DeMo.train INFO: Best Rank-1: 61.8%
2025-12-11 09:54:53,502 DeMo.train INFO: Best Rank-5: 77.0%
2025-12-11 09:54:53,502 DeMo.train INFO: Best Rank-10: 84.1%
2025-12-11 09:54:53,502 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:54:57,103 DeMo.train INFO: Epoch[5] Iteration[10/54] Loss: 1.339, Acc: 0.591, Base Lr: 5.00e-06
2025-12-11 09:54:59,580 DeMo.train INFO: Epoch[5] Iteration[20/54] Loss: 1.335, Acc: 0.562, Base Lr: 5.00e-06
2025-12-11 09:55:02,014 DeMo.train INFO: Epoch[5] Iteration[30/54] Loss: 1.334, Acc: 0.571, Base Lr: 5.00e-06
2025-12-11 09:55:04,500 DeMo.train INFO: Epoch[5] Iteration[40/54] Loss: 1.328, Acc: 0.593, Base Lr: 5.00e-06
2025-12-11 09:55:06,958 DeMo.train INFO: Epoch[5] Iteration[50/54] Loss: 1.340, Acc: 0.594, Base Lr: 5.00e-06
2025-12-11 09:55:07,826 DeMo.train INFO: Epoch 5 done. Time per batch: 0.270[s] Speed: 236.8[samples/s]
2025-12-11 09:55:07,827 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:07,827 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:55:07,827 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:55:13,066 DeMo.train INFO: Validation Results - Epoch: 5
2025-12-11 09:55:13,066 DeMo.train INFO: mAP: 62.0%
2025-12-11 09:55:13,067 DeMo.train INFO: CMC curve, Rank-1  :63.6%
2025-12-11 09:55:13,067 DeMo.train INFO: CMC curve, Rank-5  :76.3%
2025-12-11 09:55:13,067 DeMo.train INFO: CMC curve, Rank-10 :82.8%
2025-12-11 09:55:13,067 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:13,603 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:13,603 DeMo.train INFO: Best mAP: 62.0%
2025-12-11 09:55:13,604 DeMo.train INFO: Best Rank-1: 63.6%
2025-12-11 09:55:13,604 DeMo.train INFO: Best Rank-5: 76.3%
2025-12-11 09:55:13,604 DeMo.train INFO: Best Rank-10: 82.8%
2025-12-11 09:55:13,604 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:17,175 DeMo.train INFO: Epoch[6] Iteration[10/54] Loss: 1.303, Acc: 0.703, Base Lr: 5.00e-06
2025-12-11 09:55:19,630 DeMo.train INFO: Epoch[6] Iteration[20/54] Loss: 1.319, Acc: 0.672, Base Lr: 5.00e-06
2025-12-11 09:55:22,053 DeMo.train INFO: Epoch[6] Iteration[30/54] Loss: 1.312, Acc: 0.696, Base Lr: 5.00e-06
2025-12-11 09:55:24,491 DeMo.train INFO: Epoch[6] Iteration[40/54] Loss: 1.313, Acc: 0.696, Base Lr: 5.00e-06
2025-12-11 09:55:26,929 DeMo.train INFO: Epoch[6] Iteration[50/54] Loss: 1.313, Acc: 0.700, Base Lr: 5.00e-06
2025-12-11 09:55:27,803 DeMo.train INFO: Epoch 6 done. Time per batch: 0.268[s] Speed: 238.9[samples/s]
2025-12-11 09:55:27,804 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:27,804 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:55:27,804 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:55:33,159 DeMo.train INFO: Validation Results - Epoch: 6
2025-12-11 09:55:33,160 DeMo.train INFO: mAP: 62.6%
2025-12-11 09:55:33,160 DeMo.train INFO: CMC curve, Rank-1  :64.0%
2025-12-11 09:55:33,160 DeMo.train INFO: CMC curve, Rank-5  :76.9%
2025-12-11 09:55:33,160 DeMo.train INFO: CMC curve, Rank-10 :84.3%
2025-12-11 09:55:33,160 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:33,690 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:33,691 DeMo.train INFO: Best mAP: 62.6%
2025-12-11 09:55:33,691 DeMo.train INFO: Best Rank-1: 64.0%
2025-12-11 09:55:33,691 DeMo.train INFO: Best Rank-5: 76.9%
2025-12-11 09:55:33,691 DeMo.train INFO: Best Rank-10: 84.3%
2025-12-11 09:55:33,691 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:37,376 DeMo.train INFO: Epoch[7] Iteration[10/54] Loss: 1.268, Acc: 0.817, Base Lr: 5.00e-06
2025-12-11 09:55:39,843 DeMo.train INFO: Epoch[7] Iteration[20/54] Loss: 1.260, Acc: 0.788, Base Lr: 5.00e-06
2025-12-11 09:55:42,273 DeMo.train INFO: Epoch[7] Iteration[30/54] Loss: 1.260, Acc: 0.771, Base Lr: 5.00e-06
2025-12-11 09:55:44,773 DeMo.train INFO: Epoch[7] Iteration[40/54] Loss: 1.266, Acc: 0.769, Base Lr: 5.00e-06
2025-12-11 09:55:47,231 DeMo.train INFO: Epoch[7] Iteration[50/54] Loss: 1.269, Acc: 0.767, Base Lr: 5.00e-06
2025-12-11 09:55:48,099 DeMo.train INFO: Epoch 7 done. Time per batch: 0.272[s] Speed: 235.4[samples/s]
2025-12-11 09:55:48,101 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:48,101 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:55:48,101 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:55:53,391 DeMo.train INFO: Validation Results - Epoch: 7
2025-12-11 09:55:53,392 DeMo.train INFO: mAP: 64.0%
2025-12-11 09:55:53,392 DeMo.train INFO: CMC curve, Rank-1  :64.6%
2025-12-11 09:55:53,392 DeMo.train INFO: CMC curve, Rank-5  :76.1%
2025-12-11 09:55:53,392 DeMo.train INFO: CMC curve, Rank-10 :83.3%
2025-12-11 09:55:53,392 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:53,938 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:53,938 DeMo.train INFO: Best mAP: 64.0%
2025-12-11 09:55:53,938 DeMo.train INFO: Best Rank-1: 64.6%
2025-12-11 09:55:53,939 DeMo.train INFO: Best Rank-5: 76.1%
2025-12-11 09:55:53,939 DeMo.train INFO: Best Rank-10: 83.3%
2025-12-11 09:55:53,939 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:55:57,824 DeMo.train INFO: Epoch[8] Iteration[10/54] Loss: 1.253, Acc: 0.773, Base Lr: 5.00e-06
2025-12-11 09:56:00,271 DeMo.train INFO: Epoch[8] Iteration[20/54] Loss: 1.254, Acc: 0.769, Base Lr: 5.00e-06
2025-12-11 09:56:02,696 DeMo.train INFO: Epoch[8] Iteration[30/54] Loss: 1.247, Acc: 0.785, Base Lr: 5.00e-06
2025-12-11 09:56:05,133 DeMo.train INFO: Epoch[8] Iteration[40/54] Loss: 1.254, Acc: 0.791, Base Lr: 5.00e-06
2025-12-11 09:56:07,556 DeMo.train INFO: Epoch[8] Iteration[50/54] Loss: 1.251, Acc: 0.804, Base Lr: 5.00e-06
2025-12-11 09:56:08,411 DeMo.train INFO: Epoch 8 done. Time per batch: 0.273[s] Speed: 234.4[samples/s]
2025-12-11 09:56:08,412 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:08,412 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:56:08,412 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:56:13,806 DeMo.train INFO: Validation Results - Epoch: 8
2025-12-11 09:56:13,807 DeMo.train INFO: mAP: 63.9%
2025-12-11 09:56:13,807 DeMo.train INFO: CMC curve, Rank-1  :65.7%
2025-12-11 09:56:13,807 DeMo.train INFO: CMC curve, Rank-5  :78.1%
2025-12-11 09:56:13,807 DeMo.train INFO: CMC curve, Rank-10 :84.4%
2025-12-11 09:56:13,807 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:13,858 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:13,858 DeMo.train INFO: Best mAP: 64.0%
2025-12-11 09:56:13,858 DeMo.train INFO: Best Rank-1: 64.6%
2025-12-11 09:56:13,859 DeMo.train INFO: Best Rank-5: 76.1%
2025-12-11 09:56:13,859 DeMo.train INFO: Best Rank-10: 83.3%
2025-12-11 09:56:13,859 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:17,983 DeMo.train INFO: Epoch[9] Iteration[10/54] Loss: 1.232, Acc: 0.819, Base Lr: 5.00e-06
2025-12-11 09:56:20,426 DeMo.train INFO: Epoch[9] Iteration[20/54] Loss: 1.258, Acc: 0.822, Base Lr: 5.00e-06
2025-12-11 09:56:22,851 DeMo.train INFO: Epoch[9] Iteration[30/54] Loss: 1.258, Acc: 0.829, Base Lr: 5.00e-06
2025-12-11 09:56:25,278 DeMo.train INFO: Epoch[9] Iteration[40/54] Loss: 1.248, Acc: 0.841, Base Lr: 5.00e-06
2025-12-11 09:56:27,719 DeMo.train INFO: Epoch[9] Iteration[50/54] Loss: 1.251, Acc: 0.845, Base Lr: 5.00e-06
2025-12-11 09:56:28,561 DeMo.train INFO: Epoch 9 done. Time per batch: 0.277[s] Speed: 230.7[samples/s]
2025-12-11 09:56:28,562 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:28,562 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:56:28,562 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:56:33,933 DeMo.train INFO: Validation Results - Epoch: 9
2025-12-11 09:56:33,933 DeMo.train INFO: mAP: 66.0%
2025-12-11 09:56:33,933 DeMo.train INFO: CMC curve, Rank-1  :69.7%
2025-12-11 09:56:33,933 DeMo.train INFO: CMC curve, Rank-5  :80.6%
2025-12-11 09:56:33,934 DeMo.train INFO: CMC curve, Rank-10 :86.8%
2025-12-11 09:56:33,934 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:34,484 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:34,485 DeMo.train INFO: Best mAP: 66.0%
2025-12-11 09:56:34,485 DeMo.train INFO: Best Rank-1: 69.7%
2025-12-11 09:56:34,485 DeMo.train INFO: Best Rank-5: 80.6%
2025-12-11 09:56:34,485 DeMo.train INFO: Best Rank-10: 86.8%
2025-12-11 09:56:34,485 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:38,137 DeMo.train INFO: Epoch[10] Iteration[10/54] Loss: 1.236, Acc: 0.844, Base Lr: 5.00e-06
2025-12-11 09:56:40,575 DeMo.train INFO: Epoch[10] Iteration[20/54] Loss: 1.221, Acc: 0.823, Base Lr: 5.00e-06
2025-12-11 09:56:43,004 DeMo.train INFO: Epoch[10] Iteration[30/54] Loss: 1.226, Acc: 0.844, Base Lr: 5.00e-06
2025-12-11 09:56:45,471 DeMo.train INFO: Epoch[10] Iteration[40/54] Loss: 1.217, Acc: 0.864, Base Lr: 5.00e-06
2025-12-11 09:56:47,896 DeMo.train INFO: Epoch[10] Iteration[50/54] Loss: 1.217, Acc: 0.870, Base Lr: 5.00e-06
2025-12-11 09:56:48,748 DeMo.train INFO: Epoch 10 done. Time per batch: 0.269[s] Speed: 237.8[samples/s]
2025-12-11 09:56:48,749 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:48,749 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:56:48,749 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:56:54,238 DeMo.train INFO: Validation Results - Epoch: 10
2025-12-11 09:56:54,238 DeMo.train INFO: mAP: 66.1%
2025-12-11 09:56:54,238 DeMo.train INFO: CMC curve, Rank-1  :67.7%
2025-12-11 09:56:54,238 DeMo.train INFO: CMC curve, Rank-5  :78.8%
2025-12-11 09:56:54,238 DeMo.train INFO: CMC curve, Rank-10 :84.9%
2025-12-11 09:56:54,238 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:54,773 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:54,773 DeMo.train INFO: Best mAP: 66.1%
2025-12-11 09:56:54,773 DeMo.train INFO: Best Rank-1: 67.7%
2025-12-11 09:56:54,773 DeMo.train INFO: Best Rank-5: 78.8%
2025-12-11 09:56:54,774 DeMo.train INFO: Best Rank-10: 84.9%
2025-12-11 09:56:54,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:56:58,491 DeMo.train INFO: Epoch[11] Iteration[10/54] Loss: 1.198, Acc: 0.841, Base Lr: 5.00e-06
2025-12-11 09:57:00,948 DeMo.train INFO: Epoch[11] Iteration[20/54] Loss: 1.208, Acc: 0.865, Base Lr: 5.00e-06
2025-12-11 09:57:03,392 DeMo.train INFO: Epoch[11] Iteration[30/54] Loss: 1.203, Acc: 0.870, Base Lr: 5.00e-06
2025-12-11 09:57:05,839 DeMo.train INFO: Epoch[11] Iteration[40/54] Loss: 1.222, Acc: 0.865, Base Lr: 5.00e-06
2025-12-11 09:57:08,284 DeMo.train INFO: Epoch[11] Iteration[50/54] Loss: 1.220, Acc: 0.879, Base Lr: 5.00e-06
2025-12-11 09:57:09,144 DeMo.train INFO: Epoch 11 done. Time per batch: 0.271[s] Speed: 236.0[samples/s]
2025-12-11 09:57:09,145 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:57:09,145 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:57:09,145 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance
2025-12-11 09:57:13,925 DeMo.train INFO: Validation Results - Epoch: 11
2025-12-11 09:57:13,925 DeMo.train INFO: mAP: 67.3%
2025-12-11 09:57:13,925 DeMo.train INFO: CMC curve, Rank-1  :68.7%
2025-12-11 09:57:13,925 DeMo.train INFO: CMC curve, Rank-5  :82.3%
2025-12-11 09:57:13,926 DeMo.train INFO: CMC curve, Rank-10 :85.5%
2025-12-11 09:57:13,926 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:57:14,468 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:57:14,468 DeMo.train INFO: Best mAP: 67.3%
2025-12-11 09:57:14,468 DeMo.train INFO: Best Rank-1: 68.7%
2025-12-11 09:57:14,468 DeMo.train INFO: Best Rank-5: 82.3%
2025-12-11 09:57:14,468 DeMo.train INFO: Best Rank-10: 85.5%
2025-12-11 09:57:14,468 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:57:17,956 DeMo.train INFO: Epoch[12] Iteration[10/54] Loss: 1.190, Acc: 0.819, Base Lr: 5.00e-06
2025-12-11 09:57:20,417 DeMo.train INFO: Epoch[12] Iteration[20/54] Loss: 1.183, Acc: 0.848, Base Lr: 5.00e-06
2025-12-11 09:57:22,853 DeMo.train INFO: Epoch[12] Iteration[30/54] Loss: 1.186, Acc: 0.879, Base Lr: 5.00e-06
2025-12-11 09:57:25,314 DeMo.train INFO: Epoch[12] Iteration[40/54] Loss: 1.194, Acc: 0.885, Base Lr: 5.00e-06
2025-12-11 09:57:27,754 DeMo.train INFO: Epoch[12] Iteration[50/54] Loss: 1.190, Acc: 0.878, Base Lr: 5.00e-06
2025-12-11 09:57:28,609 DeMo.train INFO: Epoch 12 done. Time per batch: 0.267[s] Speed: 239.9[samples/s]
2025-12-11 09:57:28,610 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-12-11 09:57:28,610 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-12-11 09:57:28,610 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

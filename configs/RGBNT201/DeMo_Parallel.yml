MODEL:
  ARCH: 'DeMo_Parallel'  # 使用并行架构（9个分类头）
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 1
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0

  # Global-Local Fusion: 启用（提升特征表达能力）
  GLOBAL_LOCAL: True

  # 禁用旧模块（HDM/ATM）
  HDM: False
  ATM: False
  USE_SACR: False
  USE_MULTIMODAL_SACR: False
  USE_LIF: False

  # ========== 并行架构核心参数 ==========
  # SDTPS 配置（分支1）
  USE_SDTPS: True
  SDTPS_SPARSE_RATIO: 0.6  # token 保留比例（60%）
  SDTPS_USE_GUMBEL: False  # 禁用 Gumbel（训练稳定性）
  SDTPS_GUMBEL_TAU: 5.0
  SDTPS_CROSS_ATTN_TYPE: 'attention'  # Cross-Attention
  SDTPS_CROSS_ATTN_HEADS: 4
  SDTPS_BETA: 0.25         # 保留兼容性
  SDTPS_AGGR_RATIO: 0.5    # 保留兼容性
  SDTPS_LOSS_WEIGHT: 1.0   # SDTPS 分支权重（建议1.0）

  # DGAF 配置（分支2）
  USE_DGAF: True
  DGAF_VERSION: 'v4'  # V4: 返回3个独立特征
  DGAF_TAU: 1.0  # 信息熵门控温度
  DGAF_INIT_ALPHA: 0.5  # IEG 和 MIG 的平衡系数
  DGAF_LOSS_WEIGHT: 1.0  # DGAF 分支权重（建议1.0）

  # Fused 配置（分支3，辅助监督）
  FUSED_LOSS_WEIGHT: 0.5  # Fused 分支权重（建议0.5，辅助作用）

  # ========== 过拟合缓解 ==========
  # DROPOUT: 0.5  # 移除（defaults.py中无此参数，使用DROP_OUT代替）
  DROP_OUT: 0.0  # 使用defaults.py中已有的参数
  IF_LABELSMOOTH: True  # Label Smoothing

  HEAD: 4  # 保留兼容性

INPUT:
  SIZE_TRAIN: [ 256, 128 ]
  SIZE_TEST: [ 256, 128 ]
  PROB: 0.5  # random horizontal flip
  RE_PROB: 0.5  # random erasing（数据增强）
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4  # 减小以节省显存（原8）
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT201')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.0003  # 初始学习率（可根据需要调整）
  WARMUP_ITERS: 5  # Warmup epochs
  MAX_EPOCHS: 60  # 增加训练轮数（9个分类头需要更多时间）
  OPTIMIZER_NAME: 'Adam'
  IMS_PER_BATCH: 48  # 减小 batch size（9个分类头占用更多显存）
  EVAL_PERIOD: 15
  WEIGHT_DECAY: 0.0005  # 增大正则化

  # ========== 分支权重（在 processor.py 中使用）==========
  # 根据分支索引应用不同权重：
  # - SDTPS (i=0,2,4): SDTPS_LOSS_WEIGHT
  # - DGAF (i=6,8,10): DGAF_LOSS_WEIGHT
  # - Fused (i=12,14,16): FUSED_LOSS_WEIGHT

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"  # 缺失模态测试：'r', 'n', 't', 'rn', 'rt', 'nt', 'nothing'

OUTPUT_DIR: '..'

# å‚æ•°æ¯”ä¾‹åˆ†æï¼šç¡®ä¿å’ŒåŸè®ºæ–‡ä¸€è‡´

## ğŸ“Š åŸè®ºæ–‡çš„å‚æ•°è®¾ç½®

### æ¥æº 1ï¼šarguments.pyï¼ˆå¼€æºä»£ç é»˜è®¤å€¼ï¼‰

```python
sparse_ratio = 0.5   # é€‰æ‹©æ¯”ä¾‹
aggr_ratio = 0.4     # èšåˆæ¯”ä¾‹
```

### æ¥æº 2ï¼šiclr2026_conference.texï¼ˆè®ºæ–‡ Section å®ç°ç»†èŠ‚ï¼‰

> "For sparsification, we adopt fixed ratios by default: on ViT, selection Ï=0.5"

### å®Œæ•´çš„æ•°é‡å˜åŒ–ï¼ˆViT-Base, 224Ã—224ï¼‰

```
åˆå§‹patches: N = 14Ã—14 = 196
  â†“ TokenSparse (sparse_ratio = 0.5)
N_s = ceil(196 Ã— 0.5) = 98 patches
  â†“ TokenAggregation (aggr_ratio = 0.4)
N_c = int(196 Ã— 0.4 Ã— 0.5) = int(196 Ã— 0.2) = 39 patches
  â†“ +extra_token
40 patches
  â†“ +[CLS]
41 patches (æœ€ç»ˆç”¨äºè®¡ç®—ç›¸ä¼¼åº¦)

æœ€ç»ˆæ¯”ä¾‹: 39/196 = 0.199 â‰ˆ 0.2 (20%)
```

---

## ğŸ¯ æˆ‘ä»¬çš„å¤šæ¨¡æ€ ReID åœºæ™¯

### è¾“å…¥è®¾ç½®

```
å›¾åƒå°ºå¯¸: 256Ã—128
Patch size: 16Ã—16
Grid: (256/16) Ã— (128/16) = 16 Ã— 8 = 128 patches
```

### æ–¹æ¡ˆï¼šä¿æŒç›¸åŒçš„æœ€ç»ˆæ¯”ä¾‹ 0.2

```
åˆå§‹patches: N = 128
  â†“ TokenSparse (sparse_ratio = ?)
N_s = ?
  â†“ TokenAggregation (aggr_ratio = ?)
N_c = int(128 Ã— 0.2) = 25-26 patches
  â†“ +extra_token
26-27 patches
```

### å‚æ•°ç»„åˆé€‰é¡¹

ä¸ºäº†è¾¾åˆ°æœ€ç»ˆæ¯”ä¾‹ â‰ˆ 0.2ï¼Œå¯ä»¥æœ‰å¤šç§ç»„åˆï¼š

| sparse_ratio | aggr_ratio | N_s | N_c | æœ€ç»ˆæ¯”ä¾‹ | æ¨è |
|-------------|-----------|-----|-----|---------|-----|
| 0.5 | 0.4 | 64 | 26 | 0.203 | âœ… **å’ŒåŸè®ºæ–‡ä¸€è‡´** |
| 0.6 | 0.333 | 77 | 26 | 0.203 | âš ï¸ å¯é€‰ |
| 0.625 | 0.32 | 80 | 26 | 0.203 | âš ï¸ å¯é€‰ |

**æ¨è**ï¼šä½¿ç”¨ `sparse_ratio=0.5, aggr_ratio=0.4`ï¼Œå’ŒåŸè®ºæ–‡å®Œå…¨ä¸€è‡´ã€‚

---

## ğŸ“ æœ€ç»ˆè¾“å‡ºå½¢çŠ¶

### å¯¹äºæ¯ä¸ªæ¨¡æ€ï¼ˆRGB/NIR/TIRï¼‰

```
è¾“å…¥: (B, 128, 512)
  â†“ TokenSparse
(B, 64, 512)
  â†“ TokenAggregation
(B, 26, 512)
  â†“ +extra_token
(B, 27, 512)  â† æœ€ç»ˆçš„å¢å¼ºç‰¹å¾
```

### ä¸‰ä¸ªæ¨¡æ€æ‹¼æ¥å

```
RGB_enhanced: (B, 27, 512)
NI_enhanced:  (B, 27, 512)
TI_enhanced:  (B, 27, 512)

Mean pooling:
RGB_feat: (B, 512)
NI_feat:  (B, 512)
TI_feat:  (B, 512)

Concatenate:
final_feat: (B, 1536)  # 3 Ã— 512
```

---

## å¯¹æ¯”

| åœºæ™¯ | N | sparse | aggr | N_s | N_c | æœ€ç»ˆæ¯”ä¾‹ |
|------|---|--------|------|-----|-----|---------|
| **åŸè®ºæ–‡ ViT** | 196 | 0.5 | 0.4 | 98 | 39 | 0.199 |
| **æˆ‘ä»¬ RGBNT** | 128 | 0.5 | 0.4 | 64 | 26 | 0.203 |

âœ… **æ¯”ä¾‹å®Œå…¨ä¸€è‡´ï¼**

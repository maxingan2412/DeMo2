<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬å¼7 - L_ratio è¯¦ç»†è§£é‡Š</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        .formula-box {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
        .symbol {
            background-color: #e8f4f8;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #3498db;
        }
        .symbol strong {
            color: #2980b9;
        }
        .note {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .highlight {
            background-color: #d4edda;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>å…¬å¼7ï¼šæ¯”ä¾‹çº¦æŸæŸå¤± \(\mathcal{L}_{\text{ratio}}\) è¯¦ç»†è§£é‡Š</h1>

        <h2>ğŸ“ å®Œæ•´å…¬å¼</h2>
        <div class="formula-box">
            <p style="font-size: 1.2em; text-align: center;">
                \[
                \mathcal{L}_{\text{ratio}} = \left( \rho - \lambda_1 \cdot \frac{1}{N_s} \sum_{i=1}^{N_s} (D_s)_i - \lambda_2 \cdot \frac{1}{N_d} \sum_{i=1}^{N_d} (D_d)_i \right)^2
                \]
            </p>
        </div>

        <h2>ğŸ”¤ å„ç¬¦å·è¯¦ç»†å«ä¹‰</h2>

        <div class="symbol">
            <strong>\(\mathcal{L}_{\text{ratio}}\)</strong> - æ¯”ä¾‹çº¦æŸæŸå¤±ï¼ˆRatio Constraint Lossï¼‰
            <p>ç”¨äºçº¦æŸæ¨¡å‹é€‰æ‹©çš„patchæ•°é‡ï¼Œç¡®ä¿é€‰æ‹©æ¯”ä¾‹æ¥è¿‘ç›®æ ‡å€¼</p>
        </div>

        <div class="symbol">
            <strong>\(\rho\)</strong> (rho) - ç›®æ ‡é€‰æ‹©æ¯”ä¾‹ï¼ˆTarget Selection Ratioï¼‰
            <p>
                è®¾å®šæœŸæœ›ä¿ç•™çš„patchæ¯”ä¾‹ï¼š<br>
                â€¢ ViTæ¶æ„ï¼š\(\rho = 0.5\)ï¼ˆä¿ç•™50%çš„patchesï¼‰<br>
                â€¢ Swinæ¶æ„ï¼š\(\rho = 0.8\)ï¼ˆä¿ç•™80%çš„patchesï¼‰
            </p>
        </div>

        <div class="symbol">
            <strong>\(\lambda_1\)</strong> - ç¨€ç–æ–‡æœ¬æƒé‡ç³»æ•°
            <p>è®ºæ–‡ä¸­è®¾ç½®ä¸º <strong>1</strong>ï¼Œç”¨äºå¹³è¡¡ç¨€ç–æ–‡æœ¬è§†è§’çš„è´¡çŒ®</p>
        </div>

        <div class="symbol">
            <strong>\(\lambda_2\)</strong> - å¯†é›†æ–‡æœ¬æƒé‡ç³»æ•°
            <p>è®ºæ–‡ä¸­è®¾ç½®ä¸º <strong>1</strong>ï¼Œç”¨äºå¹³è¡¡å¯†é›†æ–‡æœ¬è§†è§’çš„è´¡çŒ®</p>
        </div>

        <div class="symbol">
            <strong>\(N_s\)</strong> - ç¨€ç–æ–‡æœ¬é€‰å‡ºçš„patchæ€»æ•°
            <p>åŸºäºsparse textï¼ˆåŸå§‹æ ‡æ³¨ï¼‰é€‰æ‹©å‡ºçš„æ˜¾è‘—è§†è§‰patchesæ•°é‡</p>
        </div>

        <div class="symbol">
            <strong>\(N_d\)</strong> - å¯†é›†æ–‡æœ¬é€‰å‡ºçš„patchæ€»æ•°
            <p>åŸºäºdense textï¼ˆMLLMç”Ÿæˆçš„è¯¦ç»†æè¿°ï¼‰é€‰æ‹©å‡ºçš„æ˜¾è‘—è§†è§‰patchesæ•°é‡</p>
        </div>

        <div class="symbol">
            <strong>\((D_s)_i\)</strong> å’Œ <strong>\((D_d)_i\)</strong> - å†³ç­–çŸ©é˜µå…ƒç´ ï¼ˆDecision Matrix Elementsï¼‰
            <p>
                äºŒå€¼åŒ–çš„é€‰æ‹©ç»“æœï¼š<br>
                â€¢ <strong>1</strong>ï¼šè¯¥patchè¢«é€‰ä¸­ï¼ˆæ˜¾è‘—çš„ã€ç›¸å…³çš„ï¼‰<br>
                â€¢ <strong>0</strong>ï¼šè¯¥patchè¢«ä¸¢å¼ƒï¼ˆå†—ä½™çš„ã€ä¸ç›¸å…³çš„ï¼‰
            </p>
        </div>

        <h2>ğŸ’¡ å…¬å¼çš„ç‰©ç†æ„ä¹‰</h2>

        <div class="formula-box">
            <p><strong>å®é™…é€‰æ‹©æ¯”ä¾‹çš„è®¡ç®—ï¼š</strong></p>
            <p style="text-align: center;">
                \[
                \text{å®é™…æ¯”ä¾‹} = \lambda_1 \cdot \underbrace{\frac{1}{N_s} \sum_{i=1}^{N_s} (D_s)_i}_{\text{ç¨€ç–æ–‡æœ¬é€‰æ‹©æ¯”ä¾‹}} + \lambda_2 \cdot \underbrace{\frac{1}{N_d} \sum_{i=1}^{N_d} (D_d)_i}_{\text{å¯†é›†æ–‡æœ¬é€‰æ‹©æ¯”ä¾‹}}
                \]
            </p>
        </div>

        <p>æ•´ä¸ªæŸå¤±å‡½æ•°å°±æ˜¯ <strong>(ç›®æ ‡æ¯”ä¾‹ - å®é™…æ¯”ä¾‹)Â²</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰æŸå¤±ã€‚</p>

        <h2>ğŸ¯ ä¸ºä»€ä¹ˆ Ï é€‰æ‹© 0.5ï¼Ÿ</h2>

        <div class="highlight">
            <h3>å®éªŒéªŒè¯ç»“æœï¼ˆViT-Base-224ï¼‰ï¼š</h3>
            <table>
                <thead>
                    <tr>
                        <th>\(\rho\) å€¼</th>
                        <th>Text-to-Image R@1</th>
                        <th>Image-to-Text R@1</th>
                        <th>rSum</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>0.3</td>
                        <td>87.5%</td>
                        <td>87.4%</td>
                        <td>561.2</td>
                    </tr>
                    <tr>
                        <td>0.4</td>
                        <td>87.1%</td>
                        <td>87.0%</td>
                        <td>562.8</td>
                    </tr>
                    <tr style="background-color: #d4edda; font-weight: bold;">
                        <td>0.5 â­</td>
                        <td>86.6%</td>
                        <td>86.5%</td>
                        <td><strong>564.3</strong></td>
                    </tr>
                    <tr>
                        <td>0.6</td>
                        <td>86.9%</td>
                        <td>87.0%</td>
                        <td>562.8</td>
                    </tr>
                    <tr>
                        <td>0.7</td>
                        <td>87.3%</td>
                        <td>87.5%</td>
                        <td>561.3</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="note">
            <h3>ğŸ“Š é€‰æ‹© \(\rho = 0.5\) çš„ä¸‰å¤§åŸå› ï¼š</h3>
            <ol>
                <li><strong>æœ€ä¼˜æ€§èƒ½å¹³è¡¡ç‚¹</strong>ï¼šåœ¨ViT-Base-224ä¸Šè¾¾åˆ°æœ€é«˜rSumï¼ˆ564.3ï¼‰</li>
                <li><strong>ä¿¡æ¯å†—ä½™ä¸ä¿ç•™çš„å¹³è¡¡</strong>ï¼š
                    <ul>
                        <li>ViTçš„14Ã—14 patches = 196ä¸ªpatches</li>
                        <li>ä¿ç•™50% â‰ˆ 98ä¸ªpatches</li>
                        <li>æ—¢å»é™¤äº†å†—ä½™ä¿¡æ¯ï¼Œåˆä¿ç•™äº†å…³é”®è¯­ä¹‰</li>
                    </ul>
                </li>
                <li><strong>æ€§èƒ½æ›²çº¿ç‰¹å¾</strong>ï¼šViTå¯¹Ïå€¼æ•æ„Ÿï¼Œåœ¨0.5é™„è¿‘è¾¾åˆ°å³°å€¼</li>
            </ol>
        </div>

        <div class="note">
            <h3>ğŸ”„ ä¸åŒæ¶æ„çš„å·®å¼‚ï¼š</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ¨¡å‹</th>
                        <th>Patchå¤§å°</th>
                        <th>Patchæ€»æ•°</th>
                        <th>æœ€ä¼˜ \(\rho\)</th>
                        <th>ä¿ç•™æ•°é‡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ViT-Base-224</td>
                        <td>16Ã—16</td>
                        <td>14Ã—14 = 196</td>
                        <td>0.5</td>
                        <td>~98ä¸ª</td>
                    </tr>
                    <tr>
                        <td>ViT-Base-384</td>
                        <td>16Ã—16</td>
                        <td>24Ã—24 = 576</td>
                        <td>0.5</td>
                        <td>~288ä¸ª</td>
                    </tr>
                    <tr>
                        <td>Swin-Base-224</td>
                        <td>32Ã—32</td>
                        <td>7Ã—7 = 49</td>
                        <td>0.8</td>
                        <td>~39ä¸ª</td>
                    </tr>
                    <tr>
                        <td>Swin-Base-384</td>
                        <td>32Ã—32</td>
                        <td>12Ã—12 = 144</td>
                        <td>0.8</td>
                        <td>~115ä¸ª</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>è§‚å¯Ÿ</strong>ï¼šSwinçš„patchæ›´å¤§ä½†æ•°é‡æ›´å°‘ï¼Œéœ€è¦ä¿ç•™æ›´é«˜æ¯”ä¾‹ï¼ˆ80%ï¼‰æ¥ç»´æŒè¶³å¤Ÿçš„è§†è§‰ä¿¡æ¯ã€‚</p>
        </div>

        <h2>ğŸ“ æŸå¤±å‡½æ•°çš„ä½œç”¨</h2>
        <ol>
            <li><strong>ç¨³å®šè®­ç»ƒ</strong>ï¼šé˜²æ­¢é€‰æ‹©æ¯”ä¾‹å‰§çƒˆæ³¢åŠ¨</li>
            <li><strong>çº¦æŸä¼˜åŒ–ç›®æ ‡</strong>ï¼šç¡®ä¿æ¨¡å‹ä¸ä¼šé€‰æ‹©è¿‡å¤šï¼ˆå¢åŠ è®¡ç®—é‡ï¼‰æˆ–è¿‡å°‘ï¼ˆä¸¢å¤±ä¿¡æ¯ï¼‰çš„patches</li>
            <li><strong>åŒè§†è§’ç›‘ç£</strong>ï¼šåŒæ—¶è€ƒè™‘ç¨€ç–æ–‡æœ¬å’Œå¯†é›†æ–‡æœ¬çš„é€‰æ‹©ç»“æœ</li>
            <li><strong>å¯å¾®åˆ†ä¼˜åŒ–</strong>ï¼šé€šè¿‡æ¢¯åº¦ä¸‹é™è¿›è¡Œç«¯åˆ°ç«¯è®­ç»ƒ</li>
        </ol>

        <h2>ğŸ“ æ€»ç»“</h2>
        <div class="highlight">
            <p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong></p>
            <p>\(\mathcal{L}_{\text{ratio}}\) é€šè¿‡å‡æ–¹è¯¯å·®æŸå¤±ï¼Œä½¿æ¨¡å‹å­¦ä¼šè‡ªåŠ¨é€‰æ‹©åˆé€‚æ•°é‡çš„è§†è§‰patchesï¼Œ
            æ—¢è¦ä¿ç•™è¶³å¤Ÿçš„è¯­ä¹‰ä¿¡æ¯ï¼ˆä¸èƒ½å¤ªå°‘ï¼‰ï¼Œåˆè¦å»é™¤å†—ä½™ä¿¡æ¯ï¼ˆä¸èƒ½å¤ªå¤šï¼‰ã€‚</p>
            <p>å¯¹äºViTæ¶æ„ï¼Œ<strong>\(\rho = 0.5\)</strong> åœ¨å®éªŒä¸­è¢«è¯æ˜æ˜¯æœ€ä¼˜çš„å¹³è¡¡ç‚¹ã€‚</p>
        </div>
    </div>
</body>
</html>
